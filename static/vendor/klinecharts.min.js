/**
     * @license
     * KLineChart v9.7.0
     * Copyright (c) 2019 lihu.
     * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
     */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).klinecharts={})}(this,(function(t){"use strict";var e,i,n,o,r,a,s,l,u;function c(t,e){if(g(t)||g(e))for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=t[i],o=e[i];g(o)&&g(n)?c(n,o):f(e[i])&&(t[i]=h(e[i]))}}function h(t){if(!g(t))return t;var e;for(var i in e=d(t)?[]:{},t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];g(n)?e[i]=h(n):e[i]=n}return e}function d(t){return"[object Array]"===Object.prototype.toString.call(t)}function p(t){return"function"==typeof t}function g(t){return"object"==typeof t&&f(t)}function v(t){return"number"==typeof t&&!isNaN(t)}function f(t){return null!=t}function m(t){return"boolean"==typeof t}function y(t){return"string"==typeof t}t.LineType=void 0,(e=t.LineType||(t.LineType={})).Dashed="dashed",e.Solid="solid",t.PolygonType=void 0,(i=t.PolygonType||(t.PolygonType={})).Stroke="stroke",i.Fill="fill",i.StrokeFill="stroke_fill",t.TooltipShowRule=void 0,(n=t.TooltipShowRule||(t.TooltipShowRule={})).Always="always",n.FollowCross="follow_cross",n.None="none",t.TooltipShowType=void 0,(o=t.TooltipShowType||(t.TooltipShowType={})).Standard="standard",o.Rect="rect",t.TooltipIconPosition=void 0,(r=t.TooltipIconPosition||(t.TooltipIconPosition={})).Left="left",r.Middle="middle",r.Right="right",function(t){t.Fixed="fixed",t.Pointer="pointer"}(a||(a={})),t.CandleType=void 0,(s=t.CandleType||(t.CandleType={})).CandleSolid="candle_solid",s.CandleStroke="candle_stroke",s.CandleUpStroke="candle_up_stroke",s.CandleDownStroke="candle_down_stroke",s.Ohlc="ohlc",s.Area="area",t.YAxisPosition=void 0,(l=t.YAxisPosition||(t.YAxisPosition={})).Left="left",l.Right="right",t.YAxisType=void 0,(u=t.YAxisType||(t.YAxisType={})).Normal="normal",u.Percentage="percentage",u.Log="log";var _,x,S=/\\(\\)?/g,C=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g");function b(t,e,i){if(f(t)){var n=[];e.replace(C,(function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=t;return f(e[1])?o=e[2].replace(S,"$1"):f(e[0])&&(o=e[0].trim()),n.push(o),""}));for(var o=t,r=0,a=n.length;f(o)&&r<a;)o=null==o?void 0:o[n[r++]];return f(o)?o:null!=i?i:"--"}return null!=i?i:"--"}function w(t,e,i){var n=t.format(new Date(e)).split(", "),o=n[0].split("/"),r=n[1].split(":"),a={YYYY:o[2],MM:o[0],DD:o[1],HH:"24"===r[0]?"00":r[0],mm:r[1],ss:r[2]};return i.replace(/YYYY|MM|DD|HH|mm|ss/g,(function(t){return a[t]}))}function T(t,e){var i=+t;return v(i)?i.toFixed(null!=e?e:2):"".concat(t)}function E(t){var e=+t;if(v(e)){if(e>1e9)return"".concat(+(e/1e9).toFixed(3),"B");if(e>1e6)return"".concat(+(e/1e6).toFixed(3),"M");if(e>1e3)return"".concat(+(e/1e3).toFixed(3),"K")}return"".concat(t)}function I(t,e){var i="".concat(t);if(0===e.length)return i;if(i.includes(".")){var n=i.split(".");return"".concat(n[0].replace(/(\d)(?=(\d{3})+$)/g,(function(t){return"".concat(t).concat(e)})),".").concat(n[1])}return i.replace(/(\d)(?=(\d{3})+$)/g,(function(t){return"".concat(t).concat(e)}))}function P(t){var e,i,n;return Math.ceil(null!==(n=null===(i=null===(e=t.ownerDocument)||void 0===e?void 0:e.defaultView)||void 0===i?void 0:i.devicePixelRatio)&&void 0!==n?n:2)}function D(t,e,i){return"".concat(null!=e?e:"normal"," ").concat(null!=t?t:12,"px ").concat(null!=i?i:"Helvetica Neue")}function M(t,e,i,n){if(!f(_)){var o=document.createElement("canvas"),r=P(o);(_=o.getContext("2d")).scale(r,r)}return _.font=D(e,i,n),Math.round(_.measureText(t).width)}t.ActionType=void 0,(x=t.ActionType||(t.ActionType={})).OnZoom="onZoom",x.OnScroll="onScroll",x.OnVisibleRangeChange="onVisibleRangeChange",x.OnTooltipIconClick="onTooltipIconClick",x.OnCrosshairChange="onCrosshairChange",x.OnCandleBarClick="onCandleBarClick",x.OnPaneDrag="onPaneDrag";var k=function(){function t(){this._callbacks=[]}return t.prototype.subscribe=function(t){var e;(null!==(e=this._callbacks.indexOf(t))&&void 0!==e?e:-1)<0&&this._callbacks.push(t)},t.prototype.unsubscribe=function(t){var e;if(p(t)){var i=null!==(e=this._callbacks.indexOf(t))&&void 0!==e?e:-1;i>-1&&this._callbacks.splice(i,1)}else this._callbacks=[]},t.prototype.execute=function(t){this._callbacks.forEach((function(e){e(t)}))},t.prototype.isEmpty=function(){return 0===this._callbacks.length},t}(),A=function(t,e){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},A(t,e)};function F(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}A(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var L,R=function(){return R=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},R.apply(this,arguments)};function B(t,e,i,n){return new(i||(i=Promise))((function(o,r){function a(t){try{l(n.next(t))}catch(t){r(t)}}function s(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))}function O(t,e){var i,n,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(i=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{i=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function V(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function N(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,r=i.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=r.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return a}function z(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||(n||(n=Array.prototype.slice.call(e,0,o)),n[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))}function W(t,e,i,n,o){var r,a=e.result,s=e.figures,l=e.styles,u=b(l,"circles",n.circles),c=u.length,h=b(l,"bars",n.bars),d=h.length,p=b(l,"lines",n.lines),g=p.length,v=0,m=0,y=0;s.forEach((function(s){var l;switch(s.type){case"circle":var _=u[v%c];r=R(R({},_),{color:_.noChangeColor}),v++;break;case"bar":var x=h[m%d];r=R(R({},x),{color:x.noChangeColor}),m++;break;case"line":r=p[y%g],y++}if(f(r)){var S={prev:{kLineData:t[i-1],indicatorData:a[i-1]},current:{kLineData:t[i],indicatorData:a[i]},next:{kLineData:t[i+1],indicatorData:a[i+1]}},C=null===(l=s.styles)||void 0===l?void 0:l.call(s,S,e,n);o(s,R(R({},r),C))}}))}"function"==typeof SuppressedError&&SuppressedError,t.IndicatorSeries=void 0,(L=t.IndicatorSeries||(t.IndicatorSeries={})).Normal="normal",L.Price="price",L.Volume="volume";var Y,H=function(){function e(e){this.result=[],this._precisionFlag=!1;var i=e.name,n=e.shortName,o=e.series,r=e.calcParams,a=e.figures,s=e.precision,l=e.shouldOhlc,u=e.shouldFormatBigNumber,c=e.visible,d=e.zLevel,p=e.minValue,g=e.maxValue,v=e.styles,f=e.extendData,m=e.regenerateFigures,y=e.createTooltipDataSource,_=e.draw;this.name=i,this.shortName=null!=n?n:i,this.series=null!=o?o:t.IndicatorSeries.Normal,this.precision=null!=s?s:4,this.calcParams=null!=r?r:[],this.figures=null!=a?a:[],this.shouldOhlc=null!=l&&l,this.shouldFormatBigNumber=null!=u&&u,this.visible=null==c||c,this.zLevel=null!=d?d:0,this.minValue=null!=p?p:null,this.maxValue=null!=g?g:null,this.styles=h(null!=v?v:{}),this.extendData=f,this.regenerateFigures=null!=m?m:null,this.createTooltipDataSource=null!=y?y:null,this.draw=null!=_?_:null}return e.prototype.setShortName=function(t){return this.shortName!==t&&(this.shortName=t,!0)},e.prototype.setSeries=function(t){return this.series!==t&&(this.series=t,!0)},e.prototype.setPrecision=function(t,e){var i=null!=e&&e,n=Math.floor(t);return!(!(n!==this.precision&&t>=0)||i&&(!i||this._precisionFlag))&&(this.precision=n,i||(this._precisionFlag=!0),!0)},e.prototype.setCalcParams=function(t){var e,i;return this.calcParams=t,this.figures=null!==(i=null===(e=this.regenerateFigures)||void 0===e?void 0:e.call(this,t))&&void 0!==i?i:this.figures,!0},e.prototype.setShouldOhlc=function(t){return this.shouldOhlc!==t&&(this.shouldOhlc=t,!0)},e.prototype.setShouldFormatBigNumber=function(t){return this.shouldFormatBigNumber!==t&&(this.shouldFormatBigNumber=t,!0)},e.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},e.prototype.setZLevel=function(t){return this.zLevel!==t&&(this.zLevel=t,!0)},e.prototype.setStyles=function(t){return c(this.styles,t),!0},e.prototype.setExtendData=function(t){return this.extendData!==t&&(this.extendData=t,!0)},e.prototype.setFigures=function(t){return this.figures!==t&&(this.figures=t,!0)},e.prototype.setMinValue=function(t){return this.minValue!==t&&(this.minValue=t,!0)},e.prototype.setMaxValue=function(t){return this.maxValue!==t&&(this.maxValue=t,!0)},e.prototype.setRegenerateFigures=function(t){return this.regenerateFigures!==t&&(this.regenerateFigures=t,!0)},e.prototype.setCreateTooltipDataSource=function(t){return this.createTooltipDataSource!==t&&(this.createTooltipDataSource=t,!0)},e.prototype.setDraw=function(t){return this.draw!==t&&(this.draw=t,!0)},e.prototype.calcIndicator=function(t){return B(this,void 0,void 0,(function(){var e;return O(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.calc(t,this)];case 1:return e=i.sent(),this.result=e,[2,!0];case 2:return i.sent(),[2,!1];case 3:return[2]}}))}))},e.extend=function(t){return function(e){function i(){return e.call(this,t)||this}return F(i,e),i.prototype.calc=function(e,i){return t.calc(e,i)},i}(e)},e}();t.OverlayMode=void 0,(Y=t.OverlayMode||(t.OverlayMode={})).Normal="normal",Y.WeakMagnet="weak_magnet",Y.StrongMagnet="strong_magnet";var X,j="overlay_figure_",G=Number.MAX_SAFE_INTEGER,K=function(){function e(e){this.currentStep=1,this.points=[],this._prevPressedPoint=null,this._prevPressedPoints=[];var i=e.mode,n=e.modeSensitivity,o=e.extendData,r=e.styles,a=e.name,s=e.totalStep,l=e.lock,u=e.visible,c=e.zLevel,d=e.needDefaultPointFigure,p=e.needDefaultXAxisFigure,g=e.needDefaultYAxisFigure,f=e.createPointFigures,m=e.createXAxisFigures,y=e.createYAxisFigures,_=e.performEventPressedMove,x=e.performEventMoveForDrawing,S=e.onDrawStart,C=e.onDrawing,b=e.onDrawEnd,w=e.onClick,T=e.onDoubleClick,E=e.onRightClick,I=e.onPressedMoveStart,P=e.onPressedMoving,D=e.onPressedMoveEnd,M=e.onMouseEnter,k=e.onMouseLeave,A=e.onRemoved,F=e.onSelected,L=e.onDeselected;this.name=a,this.totalStep=!v(s)||s<2?1:s,this.lock=null!=l&&l,this.visible=null==u||u,this.zLevel=null!=c?c:0,this.needDefaultPointFigure=null!=d&&d,this.needDefaultXAxisFigure=null!=p&&p,this.needDefaultYAxisFigure=null!=g&&g,this.mode=null!=i?i:t.OverlayMode.Normal,this.modeSensitivity=null!=n?n:8,this.extendData=o,this.styles=h(null!=r?r:{}),this.createPointFigures=null!=f?f:null,this.createXAxisFigures=null!=m?m:null,this.createYAxisFigures=null!=y?y:null,this.performEventPressedMove=null!=_?_:null,this.performEventMoveForDrawing=null!=x?x:null,this.onDrawStart=null!=S?S:null,this.onDrawing=null!=C?C:null,this.onDrawEnd=null!=b?b:null,this.onClick=null!=w?w:null,this.onDoubleClick=null!=T?T:null,this.onRightClick=null!=E?E:null,this.onPressedMoveStart=null!=I?I:null,this.onPressedMoving=null!=P?P:null,this.onPressedMoveEnd=null!=D?D:null,this.onMouseEnter=null!=M?M:null,this.onMouseLeave=null!=k?k:null,this.onRemoved=null!=A?A:null,this.onSelected=null!=F?F:null,this.onDeselected=null!=L?L:null}return e.prototype.setId=function(t){return!y(this.id)&&(this.id=t,!0)},e.prototype.setGroupId=function(t){return!y(this.groupId)&&(this.groupId=t,!0)},e.prototype.setPaneId=function(t){this.paneId=t},e.prototype.setExtendData=function(t){return t!==this.extendData&&(this.extendData=t,!0)},e.prototype.setStyles=function(t){return c(this.styles,t),!0},e.prototype.setPoints=function(t){if(t.length>0){var e=void 0;if(this.points=z([],N(t),!1),t.length>=this.totalStep-1?(this.currentStep=-1,e=this.totalStep-1):(this.currentStep=t.length+1,e=t.length),null!==this.performEventMoveForDrawing)for(var i=0;i<e;i++)this.performEventMoveForDrawing({currentStep:i+2,mode:this.mode,points:this.points,performPointIndex:i,performPoint:this.points[i]});return-1===this.currentStep&&null!==this.performEventPressedMove&&this.performEventPressedMove({currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:this.points.length-1,performPoint:this.points[this.points.length-1]}),!0}return!1},e.prototype.setLock=function(t){return this.lock!==t&&(this.lock=t,!0)},e.prototype.setVisible=function(t){return this.visible!==t&&(this.visible=t,!0)},e.prototype.setZLevel=function(t){return this.zLevel!==t&&(this.zLevel=t,!0)},e.prototype.setMode=function(t){return this.mode!==t&&(this.mode=t,!0)},e.prototype.setModeSensitivity=function(t){return this.modeSensitivity!==t&&(this.modeSensitivity=t,!0)},e.prototype.setOnDrawStartCallback=function(t){return this.onDrawStart!==t&&(this.onDrawStart=t,!0)},e.prototype.setOnDrawingCallback=function(t){return this.onDrawing!==t&&(this.onDrawing=t,!0)},e.prototype.setOnDrawEndCallback=function(t){return this.onDrawEnd!==t&&(this.onDrawEnd=t,!0)},e.prototype.setOnClickCallback=function(t){return this.onClick!==t&&(this.onClick=t,!0)},e.prototype.setOnDoubleClickCallback=function(t){return this.onDoubleClick!==t&&(this.onDoubleClick=t,!0)},e.prototype.setOnRightClickCallback=function(t){return this.onRightClick!==t&&(this.onRightClick=t,!0)},e.prototype.setOnPressedMoveStartCallback=function(t){return this.onPressedMoveStart!==t&&(this.onPressedMoveStart=t,!0)},e.prototype.setOnPressedMovingCallback=function(t){return this.onPressedMoving!==t&&(this.onPressedMoving=t,!0)},e.prototype.setOnPressedMoveEndCallback=function(t){return this.onPressedMoveEnd!==t&&(this.onPressedMoveEnd=t,!0)},e.prototype.setOnMouseEnterCallback=function(t){return this.onMouseEnter!==t&&(this.onMouseEnter=t,!0)},e.prototype.setOnMouseLeaveCallback=function(t){return this.onMouseLeave!==t&&(this.onMouseLeave=t,!0)},e.prototype.setOnRemovedCallback=function(t){return this.onRemoved!==t&&(this.onRemoved=t,!0)},e.prototype.setOnSelectedCallback=function(t){return this.onSelected!==t&&(this.onSelected=t,!0)},e.prototype.setOnDeselectedCallback=function(t){return this.onDeselected!==t&&(this.onDeselected=t,!0)},e.prototype.nextStep=function(){this.currentStep===this.totalStep-1?this.currentStep=-1:this.currentStep++},e.prototype.forceComplete=function(){this.currentStep=-1},e.prototype.isDrawing=function(){return-1!==this.currentStep},e.prototype.isStart=function(){return 1===this.currentStep},e.prototype.eventMoveForDrawing=function(t){var e,i=this.currentStep-1,n={};v(t.timestamp)&&(n.timestamp=t.timestamp),v(t.dataIndex)&&(n.dataIndex=t.dataIndex),v(t.value)&&(n.value=t.value),this.points[i]=n,null===(e=this.performEventMoveForDrawing)||void 0===e||e.call(this,{currentStep:this.currentStep,mode:this.mode,points:this.points,performPointIndex:i,performPoint:n})},e.prototype.eventPressedPointMove=function(t,e){var i;v(t.dataIndex)&&(this.points[e].dataIndex=t.dataIndex,this.points[e].timestamp=t.timestamp),v(t.value)&&(this.points[e].value=t.value),null===(i=this.performEventPressedMove)||void 0===i||i.call(this,{currentStep:this.currentStep,points:this.points,mode:this.mode,performPointIndex:e,performPoint:this.points[e]})},e.prototype.startPressedMove=function(t){this._prevPressedPoint=R({},t),this._prevPressedPoints=h(this.points)},e.prototype.eventPressedOtherMove=function(t,e){var i,n;null!==this._prevPressedPoint&&(v(t.dataIndex)&&v(this._prevPressedPoint.dataIndex)&&(i=t.dataIndex-this._prevPressedPoint.dataIndex),v(t.value)&&v(this._prevPressedPoint.value)&&(n=t.value-this._prevPressedPoint.value),this.points=this._prevPressedPoints.map((function(t){var o;v(t.dataIndex)&&v(t.timestamp)&&(t.dataIndex=e.timestampToDataIndex(t.timestamp));var r=R({},t);return v(i)&&v(t.dataIndex)&&(r.dataIndex=t.dataIndex+i,r.timestamp=null!==(o=e.dataIndexToTimestamp(r.dataIndex))&&void 0!==o?o:void 0),v(n)&&v(t.value)&&(r.value=t.value+n),r})))},e.extend=function(t){return function(e){function i(){return e.call(this,t)||this}return F(i,e),i}(e)},e}();t.FormatDateType=void 0,(X=t.FormatDateType||(t.FormatDateType={}))[X.Tooltip=0]="Tooltip",X[X.Crosshair=1]="Crosshair",X[X.XAxis=2]="XAxis";var Z=1,U=(new Date).getTime();function q(t){var e=(new Date).getTime();return e===U?++Z:Z=1,U=e,"".concat(null!=t?t:"").concat(e,"_").concat(Z)}function $(t,e){var i,n=document.createElement(t),o=null!=e?e:{};for(var r in o)n.style[r]=null!==(i=o[r])&&void 0!==i?i:"";return n}function J(t,e,i){var n=0,o=0;for(o=t.length-1;n!==o;){var r=Math.floor((o+n)/2),a=o-n,s=t[r][e];if(i===t[n][e])return n;if(i===t[o][e])return o;if(i===s)return r;if(i>s?n=r:o=r,a<=2)break}return n}function Q(t,e){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),+(+t).toFixed(e)}function tt(t,e,i){var n=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];return t.forEach((function(t){var o,r;n[0]=Math.max(null!==(o=t[e])&&void 0!==o?o:t,n[0]),n[1]=Math.min(null!==(r=t[i])&&void 0!==r?r:t,n[1])})),n}function et(t){return Math.log(t)/Math.log(10)}function it(t){return Math.pow(10,t)}var nt=1,ot=50,rt=function(){function e(t){this._dateTimeFormat=this._buildDateTimeFormat(),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalBarSpace=0,this._barSpace=6,this._offsetRightDistance=50,this._startScrollOffsetRightBarCount=0,this._scrollLimitRole=0,this._minVisibleBarCount={left:2,right:2},this._maxOffsetDistance={left:50,right:50},this._visibleRange={from:0,to:0,realFrom:0,realTo:0},this._chartStore=t,this._gapBarSpace=this._calcGapBarSpace(),this._offsetRightBarCount=this._offsetRightDistance/this._barSpace}return e.prototype._calcGapBarSpace=function(){var t=Math.floor(.82*this._barSpace),e=Math.floor(this._barSpace),i=Math.min(t,e-1);return Math.max(1,i)},e.prototype.adjustVisibleRange=function(){var e,i,n,o=this._chartStore.getDataList(),r=o.length,a=this._totalBarSpace/this._barSpace;1===this._scrollLimitRole?(i=(this._totalBarSpace-this._maxOffsetDistance.right)/this._barSpace,n=(this._totalBarSpace-this._maxOffsetDistance.left)/this._barSpace):(i=this._minVisibleBarCount.left,n=this._minVisibleBarCount.right),i=Math.max(0,i),n=Math.max(0,n);var s=a-Math.min(i,r);this._offsetRightBarCount>s&&(this._offsetRightBarCount=s);var l=-r+Math.min(n,r);this._offsetRightBarCount<l&&(this._offsetRightBarCount=l);var u=Math.round(this._offsetRightBarCount+r+.5);u>r&&(u=r);var c=Math.round(u-a)-1;c<0&&(c=0);var h=this._offsetRightBarCount>0?Math.round(r+this._offsetRightBarCount-a)-1:c;if(this._visibleRange={from:c,to:u,realFrom:h,realTo:u},this._chartStore.getActionStore().execute(t.ActionType.OnVisibleRangeChange,this._visibleRange),this._chartStore.adjustVisibleDataList(),0===c&&this._more&&!this._loading&&null!==this._loadMoreCallback){this._loading=!0;var d=o[0];this._loadMoreCallback(null!==(e=null==d?void 0:d.timestamp)&&void 0!==e?e:null)}},e.prototype.setMore=function(t){return this._more=t,this},e.prototype.setLoading=function(t){return this._loading=t,this},e.prototype.getDateTimeFormat=function(){return this._dateTimeFormat},e.prototype._buildDateTimeFormat=function(t){var e={hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};y(t)&&(e.timeZone=t);var i=null;try{i=new Intl.DateTimeFormat("en",e)}catch(t){}return i},e.prototype.setTimezone=function(t){var e=this._buildDateTimeFormat(t);null!==e&&(this._dateTimeFormat=e)},e.prototype.getTimezone=function(){return this._dateTimeFormat.resolvedOptions().timeZone},e.prototype.getBarSpace=function(){return{bar:this._barSpace,halfBar:this._barSpace/2,gapBar:this._gapBarSpace,halfGapBar:this._gapBarSpace/2}},e.prototype.setBarSpace=function(t,e){t<nt||t>ot||this._barSpace===t||(this._barSpace=t,this._gapBarSpace=this._calcGapBarSpace(),null==e||e(),this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0))},e.prototype.setTotalBarSpace=function(t){return this._totalBarSpace!==t&&(this._totalBarSpace=t,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0)),this},e.prototype.setOffsetRightDistance=function(t,e){return this._offsetRightDistance=1===this._scrollLimitRole?Math.min(this._maxOffsetDistance.right,t):t,this._offsetRightBarCount=this._offsetRightDistance/this._barSpace,null!=e&&e&&(this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)),this},e.prototype.resetOffsetRightDistance=function(){this.setOffsetRightDistance(this._offsetRightDistance)},e.prototype.getInitialOffsetRightDistance=function(){return this._offsetRightDistance},e.prototype.getOffsetRightDistance=function(){return Math.max(0,this._offsetRightBarCount*this._barSpace)},e.prototype.getOffsetRightBarCount=function(){return this._offsetRightBarCount},e.prototype.setOffsetRightBarCount=function(t){return this._offsetRightBarCount=t,this},e.prototype.setMaxOffsetLeftDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.left=t,this},e.prototype.setMaxOffsetRightDistance=function(t){return this._scrollLimitRole=1,this._maxOffsetDistance.right=t,this},e.prototype.setLeftMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.left=t,this},e.prototype.setRightMinVisibleBarCount=function(t){return this._scrollLimitRole=0,this._minVisibleBarCount.right=t,this},e.prototype.getVisibleRange=function(){return this._visibleRange},e.prototype.startScroll=function(){this._startScrollOffsetRightBarCount=this._offsetRightBarCount},e.prototype.scroll=function(e){if(this._scrollEnabled){var i=e/this._barSpace;this._chartStore.getActionStore().execute(t.ActionType.OnScroll),this._offsetRightBarCount=this._startScrollOffsetRightBarCount-i,this.adjustVisibleRange(),this._chartStore.getTooltipStore().recalculateCrosshair(!0),this._chartStore.getChart().adjustPaneViewport(!1,!0,!0,!0)}},e.prototype.getDataByDataIndex=function(t){var e;return null!==(e=this._chartStore.getDataList()[t])&&void 0!==e?e:null},e.prototype.coordinateToFloatIndex=function(t){var e=this._chartStore.getDataList().length,i=(this._totalBarSpace-t)/this._barSpace,n=e+this._offsetRightBarCount-i;return Math.round(1e6*n)/1e6},e.prototype.dataIndexToTimestamp=function(t){var e,i=this.getDataByDataIndex(t);return null!==(e=null==i?void 0:i.timestamp)&&void 0!==e?e:null},e.prototype.timestampToDataIndex=function(t){var e=this._chartStore.getDataList();return 0===e.length?0:J(e,"timestamp",t)},e.prototype.dataIndexToCoordinate=function(t){var e=this._chartStore.getDataList().length+this._offsetRightBarCount-t;return Math.floor(this._totalBarSpace-(e-.5)*this._barSpace)-.5},e.prototype.coordinateToDataIndex=function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1},e.prototype.zoom=function(e,i){var n,o=this;if(this._zoomEnabled){if(!v(null==i?void 0:i.x)){var r=this._chartStore.getTooltipStore().getCrosshair();i={x:null!==(n=null==r?void 0:r.x)&&void 0!==n?n:this._totalBarSpace/2}}this._chartStore.getActionStore().execute(t.ActionType.OnZoom);var a=this.coordinateToFloatIndex(null==i?void 0:i.x),s=this._barSpace+e*(this._barSpace/10);this.setBarSpace(s,(function(){o._offsetRightBarCount+=a-o.coordinateToFloatIndex(null==i?void 0:i.x)}))}},e.prototype.setZoomEnabled=function(t){return this._zoomEnabled=t,this},e.prototype.getZoomEnabled=function(){return this._zoomEnabled},e.prototype.setScrollEnabled=function(t){return this._scrollEnabled=t,this},e.prototype.getScrollEnabled=function(){return this._scrollEnabled},e.prototype.setLoadMoreCallback=function(t){return this._loadMoreCallback=t,this},e.prototype.clear=function(){this._more=!0,this._loading=!0,this._visibleRange={from:0,to:0,realFrom:0,realTo:0}},e}(),at={name:"AVP",shortName:"AVP",series:t.IndicatorSeries.Price,precision:2,figures:[{key:"avp",title:"AVP: ",type:"line"}],calc:function(t){var e=0,i=0;return t.map((function(t){var n,o,r={},a=null!==(n=null==t?void 0:t.turnover)&&void 0!==n?n:0,s=null!==(o=null==t?void 0:t.volume)&&void 0!==o?o:0;return e+=a,0!==(i+=s)&&(r.avp=e/i),r}))}},st={name:"AO",shortName:"AO",calcParams:[5,34],figures:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,styles:function(e,i,n){var o,r,a,s,l,u=e.prev,c=e.current,h=null!==(r=null===(o=u.indicatorData)||void 0===o?void 0:o.ao)&&void 0!==r?r:Number.MIN_SAFE_INTEGER,d=null!==(s=null===(a=c.indicatorData)||void 0===a?void 0:a.ao)&&void 0!==s?s:Number.MIN_SAFE_INTEGER;return{color:l=d>h?b(i.styles,"bars[0].upColor",n.bars[0].upColor):b(i.styles,"bars[0].downColor",n.bars[0].downColor),style:d>h?t.PolygonType.Stroke:t.PolygonType.Fill,borderColor:l}}}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),o=0,r=0,a=0,s=0;return t.map((function(e,l){var u={},c=(e.low+e.high)/2;if(o+=c,r+=c,l>=i[0]-1){a=o/i[0];var h=t[l-(i[0]-1)];o-=(h.low+h.high)/2}if(l>=i[1]-1){s=r/i[1];h=t[l-(i[1]-1)];r-=(h.low+h.high)/2}return l>=n-1&&(u.ao=a-s),u}))}};var lt={name:"BOLL",shortName:"BOLL",series:t.IndicatorSeries.Price,calcParams:[20,2],precision:2,shouldOhlc:!0,figures:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,o=0;return t.map((function(e,r){var a=e.close,s={};if(o+=a,r>=n){s.mid=o/i[0];var l=function(t,e){var i=t.length,n=0;return t.forEach((function(t){var i=t.close-e;n+=i*i})),n=Math.abs(n),Math.sqrt(n/i)}(t.slice(r-n,r+1),s.mid);s.up=s.mid+i[1]*l,s.dn=s.mid-i[1]*l,o-=t[r-n].close}return s}))}},ut={name:"BBI",shortName:"BBI",series:t.IndicatorSeries.Price,precision:2,calcParams:[3,6,12,24],shouldOhlc:!0,figures:[{key:"bbi",title:"BBI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max.apply(Math,z([],N(i),!1)),o=[],r=[];return t.map((function(e,a){var s={},l=e.close;if(i.forEach((function(e,i){var n;o[i]=(null!==(n=o[i])&&void 0!==n?n:0)+l,a>=e-1&&(r[i]=o[i]/e,o[i]-=t[a-(e-1)].close)})),a>=n-1){var u=0;r.forEach((function(t){u+=t})),s.bbi=u/4}return s}))}},ct={name:"CCI",shortName:"CCI",calcParams:[20],figures:[{key:"cci",title:"CCI: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=i[0]-1,o=0,r=[];return t.map((function(e,a){var s={},l=(e.high+e.low+e.close)/3;if(o+=l,r.push(l),a>=n){var u=o/i[0],c=r.slice(a-n,a+1),h=0;c.forEach((function(t){h+=Math.abs(t-u)}));var d=h/i[0];s.cci=0!==d?(l-u)/d/.015:0;var p=(t[a-n].high+t[a-n].low+t[a-n].close)/3;o-=p}return s}))}},ht={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],figures:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.ceil(i[1]/2.5+1),o=Math.ceil(i[2]/2.5+1),r=Math.ceil(i[3]/2.5+1),a=Math.ceil(i[4]/2.5+1),s=0,l=[],u=0,c=[],h=0,d=[],p=0,g=[],v=[];return t.forEach((function(e,f){var m,y,_,x,S,C={},b=null!==(m=t[f-1])&&void 0!==m?m:e,w=(b.high+b.close+b.low+b.open)/4,T=Math.max(0,e.high-w),E=Math.max(0,w-e.low);f>=i[0]-1&&(C.cr=0!==E?T/E*100:0,s+=C.cr,u+=C.cr,h+=C.cr,p+=C.cr,f>=i[0]+i[1]-2&&(l.push(s/i[1]),f>=i[0]+i[1]+n-3&&(C.ma1=l[l.length-1-n]),s-=null!==(y=v[f-(i[1]-1)].cr)&&void 0!==y?y:0),f>=i[0]+i[2]-2&&(c.push(u/i[2]),f>=i[0]+i[2]+o-3&&(C.ma2=c[c.length-1-o]),u-=null!==(_=v[f-(i[2]-1)].cr)&&void 0!==_?_:0),f>=i[0]+i[3]-2&&(d.push(h/i[3]),f>=i[0]+i[3]+r-3&&(C.ma3=d[d.length-1-r]),h-=null!==(x=v[f-(i[3]-1)].cr)&&void 0!==x?x:0),f>=i[0]+i[4]-2&&(g.push(p/i[4]),f>=i[0]+i[4]+a-3&&(C.ma4=g[g.length-1-a]),p-=null!==(S=v[f-(i[4]-1)].cr)&&void 0!==S?S:0)),v.push(C)})),v}},dt={name:"DMA",shortName:"DMA",calcParams:[10,50,10],figures:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=Math.max(i[0],i[1]),o=0,r=0,a=0,s=[];return t.forEach((function(e,l){var u,c={},h=e.close;o+=h,r+=h;var d=0,p=0;if(l>=i[0]-1&&(d=o/i[0],o-=t[l-(i[0]-1)].close),l>=i[1]-1&&(p=r/i[1],r-=t[l-(i[1]-1)].close),l>=n-1){var g=d-p;c.dma=g,a+=g,l>=n+i[2]-2&&(c.ama=a/i[2],a-=null!==(u=s[l-(i[2]-1)].dma)&&void 0!==u?u:0)}s.push(c)})),s}},pt={name:"DMI",shortName:"DMI",calcParams:[14,6],figures:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0,s=0,l=0,u=0,c=0,h=[];return t.forEach((function(e,d){var p,g,v={},f=null!==(p=t[d-1])&&void 0!==p?p:e,m=f.close,y=e.high,_=e.low,x=y-_,S=Math.abs(y-m),C=Math.abs(m-_),b=y-f.high,w=f.low-_,T=Math.max(Math.max(x,S),C),E=b>0&&b>w?b:0,I=w>0&&w>b?w:0;if(n+=T,o+=E,r+=I,d>=i[0]-1){d>i[0]-1?(a=a-a/i[0]+T,s=s-s/i[0]+E,l=l-l/i[0]+I):(a=n,s=o,l=r);var P=0,D=0;0!==a&&(P=100*s/a,D=100*l/a),v.pdi=P,v.mdi=D;var M=0;D+P!==0&&(M=Math.abs(D-P)/(D+P)*100),u+=M,d>=2*i[0]-2&&(c=d>2*i[0]-2?(c*(i[0]-1)+M)/i[0]:u/i[0],v.adx=c,d>=2*i[0]+i[1]-3&&(v.adxr=((null!==(g=h[d-(i[1]-1)].adx)&&void 0!==g?g:0)+c)/2))}h.push(v)})),h}},gt={name:"EMA",shortName:"EMA",series:t.IndicatorSeries.Price,calcParams:[6,12,20],precision:2,shouldOhlc:!0,figures:[{key:"ema1",title:"EMA6: ",type:"line"},{key:"ema2",title:"EMA12: ",type:"line"},{key:"ema3",title:"EMA20: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ema".concat(e+1),title:"EMA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=0,r=[];return t.map((function(t,e){var a={},s=t.close;return o+=s,i.forEach((function(t,i){e>=t-1&&(r[i]=e>t-1?(2*s+(t-1)*r[i])/(t+1):o/t,a[n[i].key]=r[i])})),a}))}},vt={name:"MA",shortName:"MA",series:t.IndicatorSeries.Price,calcParams:[5,10,30,60],precision:2,shouldOhlc:!0,figures:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a={},s=e.close;return i.forEach((function(e,i){var l;o[i]=(null!==(l=o[i])&&void 0!==l?l:0)+s,r>=e-1&&(a[n[i].key]=o[i]/e,o[i]-=t[r-(e-1)].close)})),a}))}},ft={name:"MACD",shortName:"MACD",calcParams:[12,26,9],figures:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,styles:function(e,i,n){var o,r,a,s,l,u=e.prev,c=e.current,h=null!==(r=null===(o=u.indicatorData)||void 0===o?void 0:o.macd)&&void 0!==r?r:Number.MIN_SAFE_INTEGER,d=null!==(s=null===(a=c.indicatorData)||void 0===a?void 0:a.macd)&&void 0!==s?s:Number.MIN_SAFE_INTEGER;return l=d>0?b(i.styles,"bars[0].upColor",n.bars[0].upColor):d<0?b(i.styles,"bars[0].downColor",n.bars[0].downColor):b(i.styles,"bars[0].noChangeColor",n.bars[0].noChangeColor),{style:h<d?t.PolygonType.Stroke:t.PolygonType.Fill,color:l,borderColor:l}}}],calc:function(t,e){var i,n,o=e.calcParams,r=0,a=0,s=0,l=0,u=Math.max(o[0],o[1]);return t.map((function(t,e){var c={},h=t.close;return r+=h,e>=o[0]-1&&(i=e>o[0]-1?(2*h+(o[0]-1)*i)/(o[0]+1):r/o[0]),e>=o[1]-1&&(n=e>o[1]-1?(2*h+(o[1]-1)*n)/(o[1]+1):r/o[1]),e>=u-1&&(a=i-n,c.dif=a,s+=a,e>=u+o[2]-2&&(l=e>u+o[2]-2?(2*a+l*(o[2]-1))/(o[2]+1):s/o[2],c.macd=2*(a-l),c.dea=l)),c}))}},mt={name:"RSI",shortName:"RSI",calcParams:[6,12,24],figures:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){var i=e+1;return{key:"rsi".concat(i),title:"RSI".concat(i,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[],r=[];return t.map((function(e,a){var s,l={},u=(null!==(s=t[a-1])&&void 0!==s?s:e).close,c=e.close-u;return i.forEach((function(e,i){var s,u,h;if(c>0?o[i]=(null!==(s=o[i])&&void 0!==s?s:0)+c:r[i]=(null!==(u=r[i])&&void 0!==u?u:0)+Math.abs(c),a>=e-1){0!==r[i]?l[n[i].key]=100-100/(1+o[i]/r[i]):l[n[i].key]=0;var d=t[a-(e-1)],p=null!==(h=t[a-e])&&void 0!==h?h:d,g=d.close-p.close;g>0?o[i]-=g:r[i]-=Math.abs(g)}})),l}))}},yt={name:"SMA",shortName:"SMA",series:t.IndicatorSeries.Price,calcParams:[12,2],precision:2,figures:[{key:"sma",title:"SMA: ",type:"line"}],shouldOhlc:!0,calc:function(t,e){var i=e.calcParams,n=0,o=0;return t.map((function(t,e){var r={},a=t.close;return n+=a,e>=i[0]-1&&(o=e>i[0]-1?(a*i[1]+o*(i[0]-i[1]+1))/(i[0]+1):n/i[0],r.sma=o),r}))}},_t={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],figures:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[];return t.forEach((function(e,o){var r,a,s,l,u={},c=e.close;if(o>=i[0]-1){var h=tt(t.slice(o-(i[0]-1),o+1),"high","low"),d=h[0],p=h[1],g=d-p,v=(c-p)/(0===g?1:g)*100;u.k=((i[1]-1)*(null!==(a=null===(r=n[o-1])||void 0===r?void 0:r.k)&&void 0!==a?a:50)+v)/i[1],u.d=((i[2]-1)*(null!==(l=null===(s=n[o-1])||void 0===s?void 0:s.d)&&void 0!==l?l:50)+u.k)/i[2],u.j=3*u.k-2*u.d}n.push(u)})),n}},xt={name:"SAR",shortName:"SAR",series:t.IndicatorSeries.Price,calcParams:[2,2,20],precision:2,shouldOhlc:!0,figures:[{key:"sar",title:"SAR: ",type:"circle",styles:function(t,e,i){var n,o,r=t.current,a=null!==(o=null===(n=r.indicatorData)||void 0===n?void 0:n.sar)&&void 0!==o?o:Number.MIN_SAFE_INTEGER,s=r.kLineData;return{color:a<((null==s?void 0:s.high)+(null==s?void 0:s.low))/2?b(e.styles,"circles[0].upColor",i.circles[0].upColor):b(e.styles,"circles[0].downColor",i.circles[0].downColor)}}}],calc:function(t,e){var i=e.calcParams,n=i[0]/100,o=i[1]/100,r=i[2]/100,a=n,s=-100,l=!1,u=0;return t.map((function(e,i){var c=u,h=e.high,d=e.low;if(l){(-100===s||s<h)&&(s=h,a=Math.min(a+o,r)),u=c+a*(s-c);var p=Math.min(t[Math.max(1,i)-1].low,d);u>e.low?(u=s,a=n,s=-100,l=!l):u>p&&(u=p)}else{(-100===s||s>d)&&(s=d,a=Math.min(a+o,r)),u=c+a*(s-c);var g=Math.max(t[Math.max(1,i)-1].high,h);u<e.high?(u=s,a=0,s=-100,l=!l):u<g&&(u=g)}return{sar:u}}))}},St={name:"VOL",shortName:"VOL",series:t.IndicatorSeries.Volume,calcParams:[5,10,20],shouldFormatBigNumber:!0,precision:0,minValue:0,figures:[{key:"ma1",title:"MA5: ",type:"line"},{key:"ma2",title:"MA10: ",type:"line"},{key:"ma3",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,e,i){var n=t.current.kLineData;return{color:n.close>n.open?b(e.styles,"bars[0].upColor",i.bars[0].upColor):n.close<n.open?b(e.styles,"bars[0].downColor",i.bars[0].downColor):b(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}],regenerateFigures:function(t){var e=t.map((function(t,e){return{key:"ma".concat(e+1),title:"MA".concat(t,": "),type:"line"}}));return e.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,styles:function(t,e,i){var n=t.current.kLineData;return{color:n.close>n.open?b(e.styles,"bars[0].upColor",i.bars[0].upColor):n.close<n.open?b(e.styles,"bars[0].downColor",i.bars[0].downColor):b(e.styles,"bars[0].noChangeColor",i.bars[0].noChangeColor)}}}),e},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a,s=null!==(a=e.volume)&&void 0!==a?a:0,l={volume:s};return i.forEach((function(e,i){var a,u;o[i]=(null!==(a=o[i])&&void 0!==a?a:0)+s,r>=e-1&&(l[n[i].key]=o[i]/e,o[i]-=null!==(u=t[r-(e-1)].volume)&&void 0!==u?u:0)})),l}))}},Ct={name:"WR",shortName:"WR",calcParams:[6,10,14],figures:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"wr".concat(e+1),title:"WR".concat(e+1,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures;return t.map((function(e,o){var r={},a=e.close;return i.forEach((function(e,i){var s=e-1;if(o>=s){var l=tt(t.slice(o-s,o+1),"high","low"),u=l[0],c=u-l[1];r[n[i].key]=0===c?0:(a-u)/c*100}})),r}))}},bt={},wt=[at,st,{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],figures:[{key:"bias1",title:"BIAS6: ",type:"line"},{key:"bias2",title:"BIAS12: ",type:"line"},{key:"bias3",title:"BIAS24: ",type:"line"}],regenerateFigures:function(t){return t.map((function(t,e){return{key:"bias".concat(e+1),title:"BIAS".concat(t,": "),type:"line"}}))},calc:function(t,e){var i=e.calcParams,n=e.figures,o=[];return t.map((function(e,r){var a={},s=e.close;return i.forEach((function(e,l){var u;if(o[l]=(null!==(u=o[l])&&void 0!==u?u:0)+s,r>=e-1){var c=o[l]/i[l];a[n[l].key]=(s-c)/c*100,o[l]-=t[r-(e-1)].close}})),a}))}},lt,{name:"BRAR",shortName:"BRAR",calcParams:[26],figures:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0;return t.map((function(e,s){var l,u,c={},h=e.high,d=e.low,p=e.open,g=(null!==(l=t[s-1])&&void 0!==l?l:e).close;if(r+=h-p,a+=p-d,n+=h-g,o+=g-d,s>=i[0]-1){c.ar=0!==a?r/a*100:0,c.br=0!==o?n/o*100:0;var v=t[s-(i[0]-1)],f=v.high,m=v.low,y=v.open,_=(null!==(u=t[s-i[0]])&&void 0!==u?u:t[s-(i[0]-1)]).close;n-=f-_,o-=_-m,r-=f-y,a-=y-m}return c}))}},ut,ct,ht,dt,pt,{name:"EMV",shortName:"EMV",calcParams:[14,9],figures:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=[];return t.map((function(e,r){var a,s={};if(r>0){var l=t[r-1],u=e.high,c=e.low,h=null!==(a=e.volume)&&void 0!==a?a:0,d=(u+c)/2-(l.high+l.low)/2;if(0===h||u-c==0)s.emv=0;else{var p=h/1e8/(u-c);s.emv=d/p}n+=s.emv,o.push(s.emv),r>=i[0]&&(s.maEmv=n/i[0],n-=o[r-i[0]])}return s}))}},gt,{name:"MTM",shortName:"MTM",calcParams:[12,6],figures:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=[];return t.forEach((function(e,r){var a,s={};if(r>=i[0]){var l=e.close,u=t[r-i[0]].close;s.mtm=l-u,n+=s.mtm,r>=i[0]+i[1]-1&&(s.maMtm=n/i[1],n-=null!==(a=o[r-(i[1]-1)].mtm)&&void 0!==a?a:0)}o.push(s)})),o}},vt,ft,{name:"OBV",shortName:"OBV",calcParams:[30],figures:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[];return t.forEach((function(e,a){var s,l,u,c,h=null!==(s=t[a-1])&&void 0!==s?s:e;e.close<h.close?o-=null!==(l=e.volume)&&void 0!==l?l:0:e.close>h.close&&(o+=null!==(u=e.volume)&&void 0!==u?u:0);var d={obv:o};n+=o,a>=i[0]-1&&(d.maObv=n/i[0],n-=null!==(c=r[a-(i[0]-1)].obv)&&void 0!==c?c:0),r.push(d)})),r}},{name:"PVT",shortName:"PVT",figures:[{key:"pvt",title:"PVT: ",type:"line"}],calc:function(t){var e=0;return t.map((function(i,n){var o,r,a={},s=i.close,l=null!==(o=i.volume)&&void 0!==o?o:1,u=(null!==(r=t[n-1])&&void 0!==r?r:i).close,c=0,h=u*l;return 0!==h&&(c=(s-u)/h),e+=c,a.pvt=e,a}))}},{name:"PSY",shortName:"PSY",calcParams:[12,6],figures:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=[],a=[];return t.forEach((function(e,s){var l,u,c={},h=(null!==(l=t[s-1])&&void 0!==l?l:e).close,d=e.close-h>0?1:0;r.push(d),n+=d,s>=i[0]-1&&(c.psy=n/i[0]*100,o+=c.psy,s>=i[0]+i[1]-2&&(c.maPsy=o/i[1],o-=null!==(u=a[s-(i[1]-1)].psy)&&void 0!==u?u:0),n-=r[s-(i[0]-1)]),a.push(c)})),a}},{name:"ROC",shortName:"ROC",calcParams:[12,6],figures:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=[],o=0;return t.forEach((function(e,r){var a,s,l={};if(r>=i[0]-1){var u=e.close,c=(null!==(a=t[r-i[0]])&&void 0!==a?a:t[r-(i[0]-1)]).close;l.roc=0!==c?(u-c)/c*100:0,o+=l.roc,r>=i[0]-1+i[1]-1&&(l.maRoc=o/i[1],o-=null!==(s=n[r-(i[1]-1)].roc)&&void 0!==s?s:0)}n.push(l)})),n}},mt,yt,_t,xt,{name:"TRIX",shortName:"TRIX",calcParams:[12,9],figures:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calc:function(t,e){var i,n,o,r=e.calcParams,a=0,s=0,l=0,u=0,c=[];return t.forEach((function(t,e){var h,d={},p=t.close;if(a+=p,e>=r[0]-1&&(i=e>r[0]-1?(2*p+(r[0]-1)*i)/(r[0]+1):a/r[0],s+=i,e>=2*r[0]-2&&(n=e>2*r[0]-2?(2*i+(r[0]-1)*n)/(r[0]+1):s/r[0],l+=n,e>=3*r[0]-3))){var g=void 0,v=0;e>3*r[0]-3?v=((g=(2*n+(r[0]-1)*o)/(r[0]+1))-o)/o*100:g=l/r[0],o=g,d.trix=v,u+=v,e>=3*r[0]+r[1]-4&&(d.maTrix=u/r[1],u-=null!==(h=c[e-(r[1]-1)].trix)&&void 0!==h?h:0)}c.push(d)})),c}},St,{name:"VR",shortName:"VR",calcParams:[26,6],figures:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calc:function(t,e){var i=e.calcParams,n=0,o=0,r=0,a=0,s=[];return t.forEach((function(e,l){var u,c,h,d,p,g={},v=e.close,f=(null!==(u=t[l-1])&&void 0!==u?u:e).close,m=null!==(c=e.volume)&&void 0!==c?c:0;if(v>f?n+=m:v<f?o+=m:r+=m,l>=i[0]-1){var y=r/2;g.vr=o+y===0?0:(n+y)/(o+y)*100,a+=g.vr,l>=i[0]+i[1]-2&&(g.maVr=a/i[1],a-=null!==(h=s[l-(i[1]-1)].vr)&&void 0!==h?h:0);var _=t[l-(i[0]-1)],x=null!==(d=t[l-i[0]])&&void 0!==d?d:_,S=_.close,C=null!==(p=_.volume)&&void 0!==p?p:0;S>x.close?n-=C:S<x.close?o-=C:r-=C}s.push(g)})),s}},Ct];function Tt(t){var e;return null!==(e=bt[t])&&void 0!==e?e:null}wt.forEach((function(t){bt[t.name]=H.extend(t)}));var Et=function(){function e(t){this._instances=new Map,this._chartStore=t}return e.prototype._overrideInstance=function(t,e){var i=e.shortName,n=e.series,o=e.calcParams,r=e.precision,a=e.figures,s=e.minValue,l=e.maxValue,u=e.shouldOhlc,c=e.shouldFormatBigNumber,h=e.visible,g=e.zLevel,_=e.styles,x=e.extendData,S=e.regenerateFigures,C=e.createTooltipDataSource,b=e.draw,w=e.calc,T=!1;y(i)&&t.setShortName(i)&&(T=!0),f(n)&&t.setSeries(n)&&(T=!0);var E=!1;d(o)&&t.setCalcParams(o)&&(T=!0,E=!0),d(a)&&t.setFigures(a)&&(T=!0,E=!0),t.setMinValue(null!=s?s:null)&&(T=!0),t.setMinValue(null!=l?l:null)&&(T=!0),v(r)&&t.setPrecision(r)&&(T=!0),m(u)&&t.setShouldOhlc(u)&&(T=!0),m(c)&&t.setShouldFormatBigNumber(c)&&(T=!0),m(h)&&t.setVisible(h)&&(T=!0);var I=!1;return v(g)&&t.setZLevel(g)&&(T=!0,I=!0),f(_)&&t.setStyles(_)&&(T=!0),t.setExtendData(x)&&(T=!0,E=!0),t.setRegenerateFigures(null!=S?S:null)&&(T=!0),t.setCreateTooltipDataSource(null!=C?C:null)&&(T=!0),t.setDraw(null!=b?b:null)&&(T=!0),p(w)&&(t.calc=w,E=!0),[T,E,I]},e.prototype._sort=function(t){var e;y(t)?null===(e=this._instances.get(t))||void 0===e||e.sort((function(t,e){return t.zLevel-e.zLevel})):this._instances.forEach((function(t){t.sort((function(t,e){return t.zLevel-e.zLevel}))}))},e.prototype.addInstance=function(t,e,i){return B(this,void 0,void 0,(function(){var n,o,r,a;return O(this,(function(s){switch(s.label){case 0:return n=t.name,f(o=this._instances.get(e))?f(o.find((function(t){return t.name===n})))?[4,Promise.reject(new Error("Duplicate indicators."))]:[3,2]:[3,2];case 1:case 3:return[2,s.sent()];case 2:return f(o)||(o=[]),r=Tt(n),a=new r,this._overrideInstance(a,t),i||(o=[]),o.push(a),this._instances.set(e,o),this._sort(e),[4,a.calcIndicator(this._chartStore.getDataList())]}}))}))},e.prototype.getInstances=function(t){var e;return null!==(e=this._instances.get(t))&&void 0!==e?e:[]},e.prototype.removeInstance=function(t,e){var i,n=!1,o=this._instances.get(t);if(f(o)){if(y(e)){var r=o.findIndex((function(t){return t.name===e}));r>-1&&(o.splice(r,1),n=!0)}else this._instances.set(t,[]),n=!0;0===(null===(i=this._instances.get(t))||void 0===i?void 0:i.length)&&this._instances.delete(t)}return n},e.prototype.hasInstances=function(t){return this._instances.has(t)},e.prototype.calcInstance=function(t,e){return B(this,void 0,void 0,(function(){var i,n,o,r=this;return O(this,(function(a){switch(a.label){case 0:return i=[],y(t)?y(e)?f(n=this._instances.get(e))&&f(o=n.find((function(e){return e.name===t})))&&i.push(o.calcIndicator(this._chartStore.getDataList())):this._instances.forEach((function(e){var n=e.find((function(e){return e.name===t}));f(n)&&i.push(n.calcIndicator(r._chartStore.getDataList()))})):this._instances.forEach((function(t){t.forEach((function(t){i.push(t.calcIndicator(r._chartStore.getDataList()))}))})),[4,Promise.all(i)];case 1:return[2,a.sent().includes(!0)]}}))}))},e.prototype.getInstanceByPaneId=function(t,e){var i,n,o=function(t){var e=new Map;return t.forEach((function(t){e.set(t.name,t)})),e};if(y(t)){var r=null!==(i=this._instances.get(t))&&void 0!==i?i:[];return y(e)?null!==(n=null==r?void 0:r.find((function(t){return t.name===e})))&&void 0!==n?n:null:o(r)}var a=new Map;return this._instances.forEach((function(t,e){a.set(e,o(t))})),a},e.prototype.setSeriesPrecision=function(e){this._instances.forEach((function(i){i.forEach((function(i){i.series===t.IndicatorSeries.Price&&i.setPrecision(e.price,!0),i.series===t.IndicatorSeries.Volume&&i.setPrecision(e.volume,!0)}))}))},e.prototype.override=function(t,e){return B(this,void 0,void 0,(function(){var i,n,o,r,a,s,l,u=this;return O(this,(function(c){switch(c.label){case 0:return i=t.name,n=new Map,null!==e?f(o=this._instances.get(e))&&n.set(e,o):n=this._instances,r=!1,a=[],s=!1,n.forEach((function(e){var n=e.find((function(t){return t.name===i}));if(f(n)){var o=u._overrideInstance(n,t);o[2]&&(s=!0),o[1]?a.push(n.calcIndicator(u._chartStore.getDataList())):o[0]&&(r=!0)}})),s&&this._sort(),[4,Promise.all(a)];case 1:return l=c.sent(),[2,[r,l.includes(!0)]]}}))}))},e}(),It=function(){function t(t){this._crosshair={},this._activeIcon=null,this._chartStore=t}return t.prototype.setCrosshair=function(t,e){var i,n,o=this._chartStore.getDataList(),r=null!=t?t:{},a=o[n=v(r.x)?(i=this._chartStore.getTimeScaleStore().coordinateToDataIndex(r.x))<0?0:i>o.length-1?o.length-1:i:i=o.length-1],s=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(i),l=this._crosshair.x,u=this._crosshair.y,c=this._crosshair.paneId;this._crosshair=R(R({},r),{realX:s,kLineData:a,realDataIndex:i,dataIndex:n}),l===r.x&&u===r.y&&c===r.paneId||(null!==a&&this._chartStore.getChart().crosshairChange(this._crosshair),null!=e&&e||this._chartStore.getChart().updatePane(1))},t.prototype.recalculateCrosshair=function(t){this.setCrosshair(this._crosshair,t)},t.prototype.getCrosshair=function(){return this._crosshair},t.prototype.setActiveIcon=function(t){this._activeIcon=null!=t?t:null},t.prototype.getActiveIcon=function(){return this._activeIcon},t.prototype.clear=function(){this.setCrosshair({},!0),this.setActiveIcon()},t}(),Pt={name:"fibonacciLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n=t.overlay,o=t.precision,r=t.thousandsSeparator,a=n.points;if(e.length>0){var s=[],l=[],u=i.width;if(e.length>1&&v(a[0].value)&&v(a[1].value)){var c=e[0].y-e[1].y,h=a[0].value-a[1].value;[1,.786,.618,.5,.382,.236,0].forEach((function(t){var i,n=e[1].y+c*t,d=I(((null!==(i=a[1].value)&&void 0!==i?i:0)+h*t).toFixed(o.price),r);s.push({coordinates:[{x:0,y:n},{x:u,y:n}]}),l.push({x:0,y:n,text:"".concat(d," (").concat((100*t).toFixed(1),"%)"),baseline:"bottom"})}))}return[{type:"line",attrs:s},{type:"text",isCheckEvent:!1,attrs:l}]}return[]}},Dt={name:"horizontalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n={x:0,y:e[0].y};return f(e[1])&&e[0].x<e[1].x&&(n.x=i.width),[{type:"line",attrs:{coordinates:[e[0],n]}}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].value=n.value)}},Mt=function(){function t(){this._children=[],this._callbacks=new Map}return t.prototype.registerEvent=function(t,e){return this._callbacks.set(t,e),this},t.prototype.onEvent=function(t,e,i){var n=this._callbacks.get(t);return!(!f(n)||!this.checkEventOn(e))&&n(e,i)},t.prototype.checkEventOn=function(t){var e,i;try{for(var n=V(this._children),o=n.next();!o.done;o=n.next()){if(o.value.checkEventOn(t))return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.dispatchEvent=function(t,e,i){var n=this._children.length-1;if(n>-1)for(var o=n;o>-1;o--)if(this._children[o].dispatchEvent(t,e,i))return!0;return this.onEvent(t,e,i)},t.prototype.addChild=function(t){return this._children.push(t),this},t.prototype.clear=function(){this._children=[]},t}(),kt=function(t){function e(e){var i=t.call(this)||this;return i.attrs=e.attrs,i.styles=e.styles,i}return F(e,t),e.prototype.checkEventOn=function(t){return this.checkEventOnImp(t,this.attrs,this.styles)},e.prototype.draw=function(t){this.drawImp(t,this.attrs,this.styles)},e.extend=function(t){var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.checkEventOnImp=function(e,i,n){return t.checkEventOn(e,i,n)},i.prototype.drawImp=function(e,i,n){t.draw(e,i,n)},i}(e);return i},e}(Mt);function At(t,e){return Math.sqrt(Math.pow(t.x+e.x,2)+Math.pow(t.y+e.y,2))}function Ft(t){var e=At(t[0],t[1]),i=e+At(t[1],t[2]),n=[t[2].x-t[0].x,t[2].y-t[0].y];return[{x:t[1].x-.5*n[0]*e/i,y:t[1].y-.5*n[1]*e/i},{x:t[1].x+.5*n[0]*e/i,y:t[1].y+.5*n[1]*e/i}]}function Lt(t,e){var i=e.coordinates;if(i.length>1)for(var n=1;n<i.length;n++){var o=i[n-1],r=i[n];if(o.x===r.x){if(Math.abs(o.y-t.y)+Math.abs(r.y-t.y)-Math.abs(o.y-r.y)<4&&Math.abs(t.x-o.x)<2)return!0}else{var a=Ot(o,r),s=Rt(a,t),l=Math.abs(s-t.y);if(Math.abs(o.x-t.x)+Math.abs(r.x-t.x)-Math.abs(o.x-r.x)<4&&l*l/(a[0]*a[0]+1)<4)return!0}}return!1}function Rt(t,e){return null!=t?e.x*t[0]+t[1]:e.y}function Bt(t,e,i){return Rt(Ot(t,e),i)}function Ot(t,e){var i=t.x-e.x;if(0!==i){var n=(t.y-e.y)/i;return[n,t.y-n*t.x]}return null}function Vt(e,i,n){var o=i.coordinates,r=o.length;if(r>1){var a=n.style,s=void 0===a?t.LineType.Solid:a,l=n.smooth,u=n.size,c=void 0===u?1:u,h=n.color,d=void 0===h?"currentColor":h,p=n.dashedValue,g=void 0===p?[2,2]:p;if(e.lineWidth=c,e.strokeStyle=d,s===t.LineType.Dashed?e.setLineDash(g):e.setLineDash([]),e.beginPath(),e.moveTo(o[0].x,o[0].y),null!=l&&l){for(var v=[],f=1;f<r-1;f++)v=v.concat(Ft([o[f-1],o[f],o[f+1]]));e.quadraticCurveTo(v[0].x,v[0].y,o[1].x,o[1].y);for(var m=2;m<r-1;m++)e.bezierCurveTo(v[2*(m-2)+1].x,v[2*(m-2)+1].y,v[2*(m-1)].x,v[2*(m-1)].y,o[m].x,o[m].y);e.quadraticCurveTo(v[2*(m-2)+1].x,v[2*(m-2)+1].y,o[m].x,o[m].y)}else for(m=1;m<o.length;m++)e.lineTo(o[m].x,o[m].y);e.stroke(),e.closePath()}}var Nt={name:"line",checkEventOn:Lt,draw:function(t,e,i){Vt(t,e,i)}};function zt(t,e,i){var n=null!=i?i:0,o=[];if(t.length>1)if(t[0].x===t[1].x){var r=e.height;if(o.push({coordinates:[{x:t[0].x,y:0},{x:t[0].x,y:r}]}),t.length>2){o.push({coordinates:[{x:t[2].x,y:0},{x:t[2].x,y:r}]});for(var a=t[0].x-t[2].x,s=0;s<n;s++){var l=a*(s+1);o.push({coordinates:[{x:t[0].x+l,y:0},{x:t[0].x+l,y:r}]})}}}else{var u=e.width,c=Ot(t[0],t[1]),h=c[0],d=c[1];if(o.push({coordinates:[{x:0,y:0*h+d},{x:u,y:u*h+d}]}),t.length>2){var p=t[2].y-h*t[2].x;o.push({coordinates:[{x:0,y:0*h+p},{x:u,y:u*h+p}]});for(a=d-p,s=0;s<n;s++){var g=d+a*(s+1);o.push({coordinates:[{x:0,y:0*h+g},{x:u,y:u*h+g}]})}}}return o}var Wt={name:"parallelStraightLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:zt(t.coordinates,t.bounding)}]}},Yt={name:"priceChannelLine",totalStep:4,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:zt(t.coordinates,t.bounding,1)}]}},Ht={name:"priceLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding,n=t.precision,o=t.overlay,r=t.thousandsSeparator,a=o.points[0].value,s=void 0===a?0:a;return[{type:"line",attrs:{coordinates:[e[0],{x:i.width,y:e[0].y}]}},{type:"text",ignoreEvent:!0,attrs:{x:e[0].x,y:e[0].y,text:I(s.toFixed(n.price),r),baseline:"bottom"}}]}};function Xt(t,e){if(t.length>1){var i=void 0;return i=t[0].x===t[1].x&&t[0].y!==t[1].y?t[0].y<t[1].y?{x:t[0].x,y:e.height}:{x:t[0].x,y:0}:t[0].x>t[1].x?{x:0,y:Bt(t[0],t[1],{x:0,y:t[0].y})}:{x:e.width,y:Bt(t[0],t[1],{x:e.width,y:t[0].y})},{coordinates:[t[0],i]}}return[]}var jt={name:"rayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){return[{type:"line",attrs:Xt(t.coordinates,t.bounding)}]}},Gt={name:"straightLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return 2===e.length?e[0].x===e[1].x?[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]:[{type:"line",attrs:{coordinates:[{x:0,y:Bt(e[0],e[1],{x:0,y:e[0].y})},{x:i.width,y:Bt(e[0],e[1],{x:i.width,y:e[0].y})}]}}]:[]}},Kt={name:"simpleAnnotation",totalStep:2,styles:{line:{style:t.LineType.Dashed}},createPointFigures:function(t){var e,i,n=t.overlay,o=t.coordinates;f(n.extendData)&&(i=p(n.extendData)?n.extendData(n):null!==(e=n.extendData)&&void 0!==e?e:"");var r=o[0].x,a=o[0].y-6,s=a-50,l=s-5;return[{type:"line",attrs:{coordinates:[{x:r,y:a},{x:r,y:s}]},ignoreEvent:!0},{type:"polygon",attrs:{coordinates:[{x:r,y:s},{x:r-4,y:l},{x:r+4,y:l}]},ignoreEvent:!0},{type:"text",attrs:{x:r,y:l,text:null!=i?i:"",align:"center",baseline:"bottom"},ignoreEvent:!0}]}},Zt={name:"simpleTag",totalStep:2,styles:{line:{style:t.LineType.Dashed}},createPointFigures:function(t){var e=t.bounding,i=t.coordinates;return{type:"line",attrs:{coordinates:[{x:0,y:i[0].y},{x:e.width,y:i[0].y}]},ignoreEvent:!0}},createYAxisFigures:function(t){var e,i,n,o,r,a=t.overlay,s=t.coordinates,l=t.bounding,u=t.yAxis,c=t.precision;return null!==(e=null==u?void 0:u.isFromZero())&&void 0!==e&&e?(n="left",o=0):(n="right",o=l.width),f(a.extendData)&&(r=p(a.extendData)?a.extendData(a):null!==(i=a.extendData)&&void 0!==i?i:""),!f(r)&&v(a.points[0].value)&&(r=T(a.points[0].value,c.price)),{type:"text",attrs:{x:o,y:s[0].y,text:null!=r?r:"",align:n,baseline:"middle"}}}},Ut={};function qt(t){var e;return null!==(e=Ut[t])&&void 0!==e?e:null}[Pt,Dt,{name:"horizontalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=[];return 2===e.length&&i.push({coordinates:e}),[{type:"line",attrs:i}]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].value=i.value,e[1].value=i.value},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].value=n.value)}},{name:"horizontalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:0,y:e[0].y},{x:i.width,y:e[0].y}]}}]}},Wt,Yt,Ht,jt,{name:"segment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]}},Gt,{name:"verticalRayLine",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;if(2===e.length){var n={x:e[0].x,y:0};return e[0].y<e[1].y&&(n.y=i.height),[{type:"line",attrs:{coordinates:[e[0],n]}}]}return[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].timestamp=n.timestamp,i[0].dataIndex=n.dataIndex)}},{name:"verticalSegment",totalStep:3,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates;return 2===e.length?[{type:"line",attrs:{coordinates:e}}]:[]},performEventPressedMove:function(t){var e=t.points,i=t.performPoint;e[0].timestamp=i.timestamp,e[0].dataIndex=i.dataIndex,e[1].timestamp=i.timestamp,e[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(t){var e=t.currentStep,i=t.points,n=t.performPoint;2===e&&(i[0].timestamp=n.timestamp,i[0].dataIndex=n.dataIndex)}},{name:"verticalStraightLine",totalStep:2,needDefaultPointFigure:!0,needDefaultXAxisFigure:!0,needDefaultYAxisFigure:!0,createPointFigures:function(t){var e=t.coordinates,i=t.bounding;return[{type:"line",attrs:{coordinates:[{x:e[0].x,y:0},{x:e[0].x,y:i.height}]}}]}},Kt,Zt].forEach((function(t){Ut[t.name]=K.extend(t)}));var $t="candle_pane",Jt="indicator_pane_",Qt="x_axis_pane",te=function(){function t(t){this._instances=new Map,this._progressInstanceInfo=null,this._pressedInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._hoverInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._clickInstanceInfo={paneId:"",instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},this._chartStore=t}return t.prototype._overrideInstance=function(t,e){var i=e.id,n=e.groupId,o=e.points,r=e.styles,a=e.lock,s=e.visible,l=e.zLevel,u=e.mode,c=e.modeSensitivity,h=e.extendData,p=e.onDrawStart,g=e.onDrawing,_=e.onDrawEnd,x=e.onClick,S=e.onDoubleClick,C=e.onRightClick,b=e.onPressedMoveStart,w=e.onPressedMoving,T=e.onPressedMoveEnd,E=e.onMouseEnter,I=e.onMouseLeave,P=e.onRemoved,D=e.onSelected,M=e.onDeselected,k=!1,A=!1;return y(i)&&t.setId(i),y(n)&&t.setGroupId(n),d(o)&&t.setPoints(o)&&(k=!0),f(r)&&t.setStyles(r)&&(k=!0),m(a)&&t.setLock(a),m(s)&&t.setVisible(s)&&(k=!0),v(l)&&t.setZLevel(l)&&(k=!0,A=!0),f(u)&&t.setMode(u),v(c)&&t.setModeSensitivity(c),t.setExtendData(h)&&(k=!0),t.setOnDrawStartCallback(null!=p?p:null),t.setOnDrawingCallback(null!=g?g:null),t.setOnDrawEndCallback(null!=_?_:null),t.setOnClickCallback(null!=x?x:null),t.setOnDoubleClickCallback(null!=S?S:null),t.setOnRightClickCallback(null!=C?C:null),t.setOnPressedMoveStartCallback(null!=b?b:null),t.setOnPressedMovingCallback(null!=w?w:null),t.setOnPressedMoveEndCallback(null!=T?T:null),t.setOnMouseEnterCallback(null!=E?E:null),t.setOnMouseLeaveCallback(null!=I?I:null),t.setOnRemovedCallback(null!=P?P:null),t.setOnSelectedCallback(null!=D?D:null),t.setOnDeselectedCallback(null!=M?M:null),[k,A]},t.prototype.getInstanceById=function(t){var e,i;try{for(var n=V(this._instances),o=n.next();!o.done;o=n.next()){var r=o.value[1].find((function(e){return e.id===t}));if(f(r))return r}}catch(t){e={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(e)throw e.error}}return null!==this._progressInstanceInfo&&this._progressInstanceInfo.instance.id===t?this._progressInstanceInfo.instance:null},t.prototype._sort=function(t){var e;y(t)?null===(e=this._instances.get(t))||void 0===e||e.sort((function(t,e){return t.zLevel-e.zLevel})):this._instances.forEach((function(t){t.sort((function(t,e){return t.zLevel-e.zLevel}))}))},t.prototype.addInstances=function(t,e,i){var n=this,o=t.map((function(t){var o,r,a,s,l=null!==(o=t.id)&&void 0!==o?o:q("overlay_");if(null===n.getInstanceById(l)){var u=qt(t.name);if(null!==u){var c=new u;c.setPaneId(e);var h=null!==(r=t.groupId)&&void 0!==r?r:l;return t.id=l,t.groupId=h,n._overrideInstance(c,t),c.isDrawing()?n._progressInstanceInfo={paneId:e,instance:c,appointPaneFlag:i}:(n._instances.has(e)||n._instances.set(e,[]),null===(a=n._instances.get(e))||void 0===a||a.push(c)),c.isStart()&&(null===(s=c.onDrawStart)||void 0===s||s.call(c,{overlay:c})),l}}return null}));return o.some((function(t){return null!==t}))&&(this._sort(),this._chartStore.getChart().updatePane(1,e)),o},t.prototype.getProgressInstanceInfo=function(){return this._progressInstanceInfo},t.prototype.progressInstanceComplete=function(){var t;if(null!==this._progressInstanceInfo){var e=this._progressInstanceInfo,i=e.instance,n=e.paneId;i.isDrawing()||(this._instances.has(n)||this._instances.set(n,[]),null===(t=this._instances.get(n))||void 0===t||t.push(i),this._sort(n),this._progressInstanceInfo=null)}},t.prototype.updateProgressInstanceInfo=function(t,e){null!==this._progressInstanceInfo&&(m(e)&&e&&(this._progressInstanceInfo.appointPaneFlag=e),this._progressInstanceInfo.paneId=t,this._progressInstanceInfo.instance.setPaneId(t))},t.prototype.getInstances=function(t){var e;if(!y(t)){var i=[];return this._instances.forEach((function(t){i=i.concat(t)})),i}return null!==(e=this._instances.get(t))&&void 0!==e?e:[]},t.prototype.override=function(t){var e=this,i=t.id,n=t.groupId,o=t.name,r=!1,a=!1,s=function(i){var n=e._overrideInstance(i,t);n[0]&&(r=!0),n[1]&&(a=!0)};if(y(i)){var l=this.getInstanceById(i);null!==l&&s(l)}else{var u=y(o),c=y(n);if(this._instances.forEach((function(t){t.forEach((function(t){(u&&t.name===o||c&&t.groupId===n||!u&&!c)&&s(t)}))})),null!==this._progressInstanceInfo){var h=this._progressInstanceInfo.instance;(u&&h.name===o||c&&h.groupId===n||!u&&!c)&&s(h)}}a&&this._sort(),r&&this._chartStore.getChart().updatePane(1)},t.prototype.removeInstance=function(t){var e,i,n,o=function(t,e){if(y(t.id)){if(e.id!==t.id)return!1}else if(y(t.groupId)){if(e.groupId!==t.groupId)return!1}else if(y(t.name)&&e.name!==t.name)return!1;return!0},r=[],a=f(t);if(null!==this._progressInstanceInfo){var s=this._progressInstanceInfo.instance;(!a||a&&o(t,s))&&(r.push(this._progressInstanceInfo.paneId),null===(n=s.onRemoved)||void 0===n||n.call(s,{overlay:s}),this._progressInstanceInfo=null)}if(a){var l=new Map,u=function(e){var i=e[1].filter((function(i){var n;return!o(t,i)||(r.includes(e[0])||r.push(e[0]),null===(n=i.onRemoved)||void 0===n||n.call(i,{overlay:i}),!1)}));i.length>0&&l.set(e[0],i)};try{for(var c=V(this._instances),h=c.next();!h.done;h=c.next()){u(h.value)}}catch(t){e={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(e)throw e.error}}this._instances=l}else this._instances.forEach((function(t,e){r.push(e),t.forEach((function(t){var e;null===(e=t.onRemoved)||void 0===e||e.call(t,{overlay:t})}))})),this._instances.clear();if(r.length>0){var d=this._chartStore.getChart();r.forEach((function(t){d.updatePane(1,t)})),d.updatePane(1,Qt)}},t.prototype.setPressedInstanceInfo=function(t){this._pressedInstanceInfo=t},t.prototype.getPressedInstanceInfo=function(){return this._pressedInstanceInfo},t.prototype.setHoverInstanceInfo=function(t,e){var i,n,o=this._hoverInstanceInfo,r=o.instance,a=o.figureType,s=o.figureKey,l=o.figureIndex;if(((null==r?void 0:r.id)!==(null===(i=t.instance)||void 0===i?void 0:i.id)||a!==t.figureType||l!==t.figureIndex)&&(this._hoverInstanceInfo=t,(null==r?void 0:r.id)!==(null===(n=t.instance)||void 0===n?void 0:n.id))){var u=!1,c=!1;null!==r&&(c=!0,p(r.onMouseLeave)&&(r.onMouseLeave(R({overlay:r,figureKey:s,figureIndex:l},e)),u=!0)),null!==t.instance&&(c=!0,t.instance.setZLevel(G),p(t.instance.onMouseEnter)&&(t.instance.onMouseEnter(R({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),u=!0)),c&&this._sort(),u||this._chartStore.getChart().updatePane(1)}},t.prototype.getHoverInstanceInfo=function(){return this._hoverInstanceInfo},t.prototype.setClickInstanceInfo=function(t,e){var i,n,o,r,a,s,l,u,c,h=this._clickInstanceInfo,d=h.paneId,p=h.instance,g=h.figureType,v=h.figureKey,f=h.figureIndex;if(null!==(n=null===(i=t.instance)||void 0===i?void 0:i.isDrawing())&&void 0!==n&&n||null===(r=null===(o=t.instance)||void 0===o?void 0:o.onClick)||void 0===r||r.call(o,R({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e)),((null==p?void 0:p.id)!==(null===(a=t.instance)||void 0===a?void 0:a.id)||g!==t.figureType||f!==t.figureIndex)&&(this._clickInstanceInfo=t,(null==p?void 0:p.id)!==(null===(s=t.instance)||void 0===s?void 0:s.id))){null===(l=null==p?void 0:p.onDeselected)||void 0===l||l.call(p,R({overlay:p,figureKey:v,figureIndex:f},e)),null===(c=null===(u=t.instance)||void 0===u?void 0:u.onSelected)||void 0===c||c.call(u,R({overlay:t.instance,figureKey:t.figureKey,figureIndex:t.figureIndex},e));var m=this._chartStore.getChart();m.updatePane(1,t.paneId),d!==t.paneId&&m.updatePane(1,d),m.updatePane(1,Qt)}},t.prototype.getClickInstanceInfo=function(){return this._clickInstanceInfo},t.prototype.isEmpty=function(){return 0===this._instances.size&&null===this._progressInstanceInfo},t.prototype.isDrawing=function(){var t,e;return null!==this._progressInstanceInfo&&null!==(e=null===(t=this._progressInstanceInfo)||void 0===t?void 0:t.instance.isDrawing())&&void 0!==e&&e},t}(),ee=function(){function t(){this._actions=new Map}return t.prototype.execute=function(t,e){var i;null===(i=this._actions.get(t))||void 0===i||i.execute(e)},t.prototype.subscribe=function(t,e){var i;this._actions.has(t)||this._actions.set(t,new k),null===(i=this._actions.get(t))||void 0===i||i.subscribe(e)},t.prototype.unsubscribe=function(t,e){var i=this._actions.get(t);f(i)&&(i.unsubscribe(e),i.isEmpty()&&this._actions.delete(t))},t.prototype.has=function(t){var e=this._actions.get(t);return f(e)&&!e.isEmpty()},t}(),ie={light:{grid:{horizontal:{color:"#EDEDED"},vertical:{color:"#EDEDED"}},candle:{priceMark:{high:{color:"#76808F"},low:{color:"#76808F"}},tooltip:{rect:{color:"#FEFEFE",borderColor:"#F2F3F5"},text:{color:"#76808F"}}},indicator:{tooltip:{text:{color:"#76808F"}}},xAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},yAxis:{axisLine:{color:"#DDDDDD"},tickText:{color:"#76808F"},tickLine:{color:"#DDDDDD"}},separator:{color:"#DDDDDD"},crosshair:{horizontal:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}},vertical:{line:{color:"#76808F"},text:{borderColor:"#686D76",backgroundColor:"#686D76"}}}},dark:{grid:{horizontal:{color:"#292929"},vertical:{color:"#292929"}},candle:{priceMark:{high:{color:"#929AA5"},low:{color:"#929AA5"}},tooltip:{rect:{color:"rgba(10, 10, 10, .6)",borderColor:"rgba(10, 10, 10, .6)"},text:{color:"#929AA5"}}},indicator:{tooltip:{text:{color:"#929AA5"}}},xAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},yAxis:{axisLine:{color:"#333333"},tickText:{color:"#929AA5"},tickLine:{color:"#333333"}},separator:{color:"#333333"},crosshair:{horizontal:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}},vertical:{line:{color:"#929AA5"},text:{borderColor:"#373a40",backgroundColor:"#373a40"}}}}};function ne(t){var e;return null!==(e=ie[t])&&void 0!==e?e:null}var oe=function(){function e(e,i){this._styles={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:t.LineType.Dashed,dashedValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:t.LineType.Dashed,dashedValue:[2,2]}},candle:{type:t.CandleType.CandleSolid,bar:{upColor:"#2DC08E",downColor:"#F92855",noChangeColor:"#888888",upBorderColor:"#2DC08E",downBorderColor:"#F92855",noChangeBorderColor:"#888888",upWickColor:"#2DC08E",downWickColor:"#F92855",noChangeWickColor:"#888888"},area:{lineSize:2,lineColor:"#1677FF",value:"close",backgroundColor:[{offset:0,color:"rgba(22, 119, 255, 0.01)"},{offset:1,color:"rgba(22, 119, 255, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textOffset:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#2DC08E",downColor:"#F92855",noChangeColor:"#888888",line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,4],size:1},text:{show:!0,style:t.PolygonType.Fill,size:12,paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderColor:"transparent",borderStyle:t.LineType.Solid,borderSize:0,borderDashedValue:[2,2],color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:t.TooltipShowRule.Always,showType:t.TooltipShowType.Standard,custom:null,defaultValue:"n/a",rect:{position:a.Fixed,paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:8,offsetLeft:10,offsetTop:8,offsetRight:10,offsetBottom:8,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",color:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},indicator:{ohlc:{upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"},bars:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"}],lines:[{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#FF9600"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#935EBD"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#1677FF"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#E11D74"},{style:t.LineType.Solid,smooth:!1,size:1,dashedValue:[2,2],color:"#01C5C4"}],circles:[{style:t.PolygonType.Fill,borderStyle:t.LineType.Solid,borderSize:1,borderDashedValue:[2,2],upColor:"rgba(45, 192, 142, .7)",downColor:"rgba(249, 40, 85, .7)",noChangeColor:"#888888"}],lastValueMark:{show:!1,text:{show:!1,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderColor:"transparent",borderSize:1,borderDashedValue:[2,2],paddingLeft:4,paddingTop:4,paddingRight:4,paddingBottom:4,borderRadius:2}},tooltip:{showRule:t.TooltipShowRule.Always,showType:t.TooltipShowType.Standard,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:10,marginTop:8,marginRight:6,marginBottom:0},icons:[]}},xAxis:{show:!0,size:"auto",axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,size:"auto",type:t.YAxisType.Normal,position:t.YAxisPosition.Right,inside:!1,reverse:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",marginStart:4,marginEnd:4},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderColor:"#686D76",borderRadius:2,paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:t.LineType.Dashed,dashedValue:[4,2],size:1,color:"#76808F"},text:{show:!0,style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#686D76",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#686D76"}}},overlay:{point:{color:"#1677FF",borderColor:"rgba(22, 119, 255, 0.35)",borderSize:1,radius:5,activeColor:"#1677FF",activeBorderColor:"rgba(22, 119, 255, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:t.LineType.Solid,smooth:!1,color:"#1677FF",size:1,dashedValue:[2,2]},rect:{style:t.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderRadius:0,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},polygon:{style:t.PolygonType.Fill,color:"#1677FF",borderColor:"#1677FF",borderSize:1,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},circle:{style:t.PolygonType.Fill,color:"rgba(22, 119, 255, 0.25)",borderColor:"#1677FF",borderSize:1,borderStyle:t.LineType.Solid,borderDashedValue:[2,2]},arc:{style:t.LineType.Solid,color:"#1677FF",size:1,dashedValue:[2,2]},text:{style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"},rectText:{style:t.PolygonType.Fill,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",borderStyle:t.LineType.Solid,borderDashedValue:[2,2],borderSize:1,borderRadius:2,borderColor:"#1677FF",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4,backgroundColor:"#1677FF"}}},this._customApi={formatDate:w,formatBigNumber:E},this._locale="en-US",this._precision={price:2,volume:0},this._thousandsSeparator=",",this._dataList=[],this._timeScaleStore=new rt(this),this._indicatorStore=new Et(this),this._overlayStore=new te(this),this._tooltipStore=new It(this),this._actionStore=new ee,this._visibleDataList=[],this._chart=e,this.setOptions(i)}return e.prototype.adjustVisibleDataList=function(){this._visibleDataList=[];for(var t=this._timeScaleStore.getVisibleRange(),e=t.from,i=t.to,n=e;n<i;n++){var o=this._dataList[n],r=this._timeScaleStore.dataIndexToCoordinate(n);this._visibleDataList.push({dataIndex:n,x:r,data:o})}},e.prototype.setOptions=function(t){if(f(t)){var e=t.locale,i=t.timezone,n=t.styles,o=t.customApi;y(e)&&(this._locale=e),y(i)&&this._timeScaleStore.setTimezone(i),f(n)&&(y(n)?c(this._styles,ne(n)):c(this._styles,n)),f(o)&&c(this._customApi,o),y(t.thousandsSeparator)&&(this._thousandsSeparator=t.thousandsSeparator)}return this},e.prototype.getStyles=function(){return this._styles},e.prototype.getLocale=function(){return this._locale},e.prototype.getCustomApi=function(){return this._customApi},e.prototype.getThousandsSeparator=function(){return this._thousandsSeparator},e.prototype.getPrecision=function(){return this._precision},e.prototype.setPrecision=function(t){return this._precision=t,this._indicatorStore.setSeriesPrecision(t),this},e.prototype.getDataList=function(){return this._dataList},e.prototype.getVisibleDataList=function(){return this._visibleDataList},e.prototype.addData=function(t,e,i){if(d(t)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(null==i||i);var n=0===this._dataList.length;this._dataList=t.concat(this._dataList),n&&this._timeScaleStore.resetOffsetRightDistance(),this._timeScaleStore.adjustVisibleRange()}else{if(e>=this._dataList.length){this._dataList.push(t);var o=this._timeScaleStore.getOffsetRightBarCount();o<0&&this._timeScaleStore.setOffsetRightBarCount(--o),this._timeScaleStore.adjustVisibleRange()}else this._dataList[e]=t,this.adjustVisibleDataList()}this._tooltipStore.recalculateCrosshair(!0)},e.prototype.clear=function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear(),this._tooltipStore.clear()},e.prototype.getTimeScaleStore=function(){return this._timeScaleStore},e.prototype.getIndicatorStore=function(){return this._indicatorStore},e.prototype.getOverlayStore=function(){return this._overlayStore},e.prototype.getTooltipStore=function(){return this._tooltipStore},e.prototype.getActionStore=function(){return this._actionStore},e.prototype.getChart=function(){return this._chart},e}(),re="main",ae="xAxis",se="yAxis",le="separator";function ue(t){var e={width:0,height:0,left:0,right:0,top:0,bottom:0};return f(t)&&c(e,t),e}var ce=function(t){function e(e,i){var n=t.call(this)||this;return n._bounding=ue(),n._pane=i,n.init(e),n}return F(e,t),e.prototype.init=function(t){this._rootContainer=t,this._container=this.createContainer(),t.appendChild(this._container)},e.prototype.setBounding=function(t){return c(this._bounding,t),this},e.prototype.getContainer=function(){return this._container},e.prototype.getBounding=function(){return this._bounding},e.prototype.getPane=function(){return this._pane},e.prototype.update=function(t){this.updateImp(this._container,this._bounding,null!=t?t:3)},e.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},e}(Mt);function he(t){return null==window.requestAnimationFrame?window.setTimeout(t,20):window.requestAnimationFrame(t)}function de(t){null==window.cancelAnimationFrame&&window.clearTimeout(t),window.cancelAnimationFrame(t)}var pe=-1,ge=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._mainRequestAnimationId=pe,e._overlayRequestAnimationId=pe,e}return F(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this._mainCanvas=$("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._mainCtx=this._mainCanvas.getContext("2d"),this._overlayCanvas=$("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._overlayCtx=this._overlayCanvas.getContext("2d");var i=this.getContainer();i.appendChild(this._mainCanvas),i.appendChild(this._overlayCanvas)},e.prototype.createContainer=function(){return $("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box",zIndex:"1"})},e.prototype._optimalUpdateMain=function(t,e){var i=this;this._mainRequestAnimationId!==pe&&(de(this._mainRequestAnimationId),this._mainRequestAnimationId=pe),this._mainRequestAnimationId=he((function(){if(t!==i._mainCanvas.offsetWidth||e!==i._mainCanvas.offsetHeight){i._mainCtx.clearRect(0,0,i._mainCanvas.offsetWidth,i._mainCanvas.offsetHeight);var n=P(i._mainCanvas),o=Math.floor(t*n),r=Math.floor(e*n);i._mainCanvas.style.width="".concat(t,"px"),i._mainCanvas.style.height="".concat(e,"px"),i._mainCanvas.width=o,i._mainCanvas.height=r,i._mainCtx.scale(n,n)}else i._mainCtx.clearRect(0,0,i._mainCanvas.offsetWidth,i._mainCanvas.offsetHeight);i.updateMain(i._mainCtx)}))},e.prototype._optimalUpdateOverlay=function(t,e){var i=this;this._overlayRequestAnimationId!==pe&&(de(this._overlayRequestAnimationId),this._overlayRequestAnimationId=pe),this._overlayRequestAnimationId=he((function(){if(t!==i._overlayCanvas.offsetWidth||e!==i._overlayCanvas.offsetHeight){i._overlayCtx.clearRect(0,0,i._overlayCanvas.offsetWidth,i._overlayCanvas.offsetHeight);var n=P(i._overlayCanvas),o=Math.floor(t*n),r=Math.floor(e*n);i._overlayCanvas.style.width="".concat(t,"px"),i._overlayCanvas.style.height="".concat(e,"px"),i._overlayCanvas.width=o,i._overlayCanvas.height=r,i._overlayCtx.scale(n,n)}else i._overlayCtx.clearRect(0,0,i._overlayCanvas.offsetWidth,i._overlayCanvas.offsetHeight);i.updateOverlay(i._overlayCtx)}))},e.prototype.updateImp=function(t,e,i){var n=e.width,o=e.height,r=e.left;t.style.left="".concat(r,"px");var a=i;switch(n===t.offsetWidth&&o===t.offsetHeight||(t.style.width="".concat(n,"px"),t.style.height="".concat(o,"px"),a=3),a){case 0:this._optimalUpdateMain(n,o);break;case 1:this._optimalUpdateOverlay(n,o);break;case 3:case 4:this._optimalUpdateMain(n,o),this._optimalUpdateOverlay(n,o)}},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,o=$("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=o.getContext("2d"),a=P(o);return o.width=i*a,o.height=n*a,r.scale(a,a),r.drawImage(this._mainCanvas,0,0,i,n),t&&r.drawImage(this._overlayCanvas,0,0,i,n),o},e}(ce);function ve(t,e){var i=t.x-e.x,n=t.y-e.y,o=e.r;return!(i*i+n*n>o*o)}function fe(e,i,n){var o=i.x,r=i.y,a=i.r,s=n.style,l=void 0===s?t.PolygonType.Fill:s,u=n.color,c=void 0===u?"currentColor":u,h=n.borderSize,d=void 0===h?1:h,p=n.borderColor,g=void 0===p?"currentColor":p,v=n.borderStyle,f=void 0===v?t.LineType.Solid:v,m=n.borderDashedValue,y=void 0===m?[2,2]:m;l!==t.PolygonType.Fill&&n.style!==t.PolygonType.StrokeFill||(e.fillStyle=c,e.beginPath(),e.arc(o,r,a,0,2*Math.PI),e.closePath(),e.fill()),l!==t.PolygonType.Stroke&&n.style!==t.PolygonType.StrokeFill||(e.strokeStyle=g,e.lineWidth=d,f===t.LineType.Dashed?e.setLineDash(y):e.setLineDash([]),e.beginPath(),e.arc(o,r,a,0,2*Math.PI),e.closePath(),e.stroke())}var me={name:"circle",checkEventOn:ve,draw:function(t,e,i){fe(t,e,i)}};function ye(t,e){for(var i=!1,n=e.coordinates,o=0,r=n.length-1;o<n.length;r=o++)n[o].y>t.y!=n[r].y>t.y&&t.x<(n[r].x-n[o].x)*(t.y-n[o].y)/(n[r].y-n[o].y)+n[o].x&&(i=!i);return i}function _e(e,i,n){var o=i.coordinates,r=n.style,a=void 0===r?t.PolygonType.Fill:r,s=n.color,l=void 0===s?"currentColor":s,u=n.borderSize,c=void 0===u?1:u,h=n.borderColor,d=void 0===h?"currentColor":h,p=n.borderStyle,g=void 0===p?t.LineType.Solid:p,v=n.borderDashedValue,f=void 0===v?[2,2]:v;if(a===t.PolygonType.Fill||n.style===t.PolygonType.StrokeFill){e.fillStyle=l,e.beginPath(),e.moveTo(o[0].x,o[0].y);for(var m=1;m<o.length;m++)e.lineTo(o[m].x,o[m].y);e.closePath(),e.fill()}if(a===t.PolygonType.Stroke||n.style===t.PolygonType.StrokeFill){e.strokeStyle=d,e.lineWidth=c,g===t.LineType.Dashed?e.setLineDash(f):e.setLineDash([]),e.beginPath(),e.moveTo(o[0].x,o[0].y);for(m=1;m<o.length;m++)e.lineTo(o[m].x,o[m].y);e.closePath(),e.stroke()}}var xe={name:"polygon",checkEventOn:ye,draw:function(t,e,i){_e(t,e,i)}};function Se(t){return"transparent"===t}function Ce(t,e){var i=e.x,n=e.width;n<4&&(i-=2,n=4);var o=e.y,r=e.height;return r<4&&(o-=2,r=4),t.x>=i&&t.x<=i+n&&t.y>=o&&t.y<=o+r}function be(e,i,n){var o=i.x,r=i.y,a=i.width,s=i.height,l=n.style,u=void 0===l?t.PolygonType.Fill:l,c=n.color,h=void 0===c?"transparent":c,d=n.borderSize,p=void 0===d?1:d,g=n.borderColor,v=void 0===g?"transparent":g,f=n.borderStyle,m=void 0===f?t.LineType.Solid:f,_=n.borderRadius,x=void 0===_?0:_,S=n.borderDashedValue,C=void 0===S?[2,2]:S;if(u===t.PolygonType.Fill||n.style===t.PolygonType.StrokeFill){var b=!0;y(h)&&(b=!Se(h)),b&&(e.fillStyle=h,e.beginPath(),e.moveTo(o+x,r),e.arcTo(o+a,r,o+a,r+s,x),e.arcTo(o+a,r+s,o,r+s,x),e.arcTo(o,r+s,o,r,x),e.arcTo(o,r,o+a,r,x),e.closePath(),e.fill())}(u===t.PolygonType.Stroke||n.style===t.PolygonType.StrokeFill)&&!Se(v)&&p>=0&&(e.strokeStyle=v,e.lineWidth=p,m===t.LineType.Dashed?e.setLineDash(C):e.setLineDash([]),e.beginPath(),e.moveTo(o+x,r),e.arcTo(o+a,r,o+a,r+s,x),e.arcTo(o+a,r+s,o,r+s,x),e.arcTo(o,r+s,o,r,x),e.arcTo(o,r,o+a,r,x),e.closePath(),e.stroke())}var we={name:"rect",checkEventOn:Ce,draw:function(t,e,i){be(t,e,i)}};function Te(t,e){var i,n,o=e.size,r=void 0===o?12:o,a=e.paddingLeft,s=void 0===a?0:a,l=e.paddingTop,u=void 0===l?0:l,c=e.paddingRight,h=void 0===c?0:c,d=e.paddingBottom,p=void 0===d?0:d,g=e.weight,v=void 0===g?"normal":g,f=e.family,m=t.x,y=t.y,_=t.text,x=t.align,S=void 0===x?"left":x,C=t.baseline,b=void 0===C?"top":C,w=t.width,T=t.height,E=null!=w?w:s+M(_,r,v,f)+h,I=null!=T?T:u+r+p;switch(S){case"left":case"start":i=m;break;case"right":case"end":i=m-E;break;default:i=m-E/2}switch(b){case"top":case"hanging":n=y;break;case"bottom":case"ideographic":case"alphabetic":n=y-I;break;default:n=y-I/2}return{x:i,y:n,width:E,height:I}}function Ee(t,e,i){var n=Te(e,i),o=n.x,r=n.y,a=n.width,s=n.height;return t.x>=o&&t.x<=o+a&&t.y>=r&&t.y<=r+s}function Ie(t,e,i){var n=e.text,o=i.color,r=void 0===o?"currentColor":o,a=i.size,s=void 0===a?12:a,l=i.family,u=i.weight,c=i.paddingLeft,h=void 0===c?0:c,d=i.paddingTop,p=void 0===d?0:d,g=i.paddingRight,v=void 0===g?0:g,f=Te(e,i);be(t,f,R(R({},i),{color:i.backgroundColor})),t.textAlign="left",t.textBaseline="top",t.font=D(s,u,l),t.fillStyle=r,t.fillText(n,f.x+h,f.y+p,f.width-h-v)}var Pe={name:"text",checkEventOn:function(t,e,i){return Ee(t,e,i)},draw:function(t,e,i){Ie(t,e,i)}},De=Ie;function Me(t,e){if(Math.abs((c=e,h=(u=t).x-c.x,d=u.y-c.y,Math.sqrt(h*h+d*d)-e.r))<2){var i=e.r,n=e.startAngle,o=e.endAngle,r=i*Math.cos(n)+e.x,a=i*Math.sin(n)+e.y,s=i*Math.cos(o)+e.x,l=i*Math.sin(o)+e.y;return t.x<=Math.max(r,s)+2&&t.x>=Math.min(r,s)-2&&t.y<=Math.max(a,l)+2&&t.y>=Math.min(a,l)-2}var u,c,h,d;return!1}function ke(e,i,n){var o=i.x,r=i.y,a=i.r,s=i.startAngle,l=i.endAngle,u=n.style,c=void 0===u?t.LineType.Solid:u,h=n.size,d=void 0===h?1:h,p=n.color,g=void 0===p?"currentColor":p,v=n.dashedValue,f=void 0===v?[2,2]:v;e.lineWidth=d,e.strokeStyle=g,c===t.LineType.Dashed?e.setLineDash(f):e.setLineDash([]),e.beginPath(),e.arc(o,r,a,s,l),e.stroke(),e.closePath()}var Ae={name:"arc",checkEventOn:Me,draw:function(t,e,i){ke(t,e,i)}},Fe={};[me,Nt,xe,we,Pe,Pe,Ae].forEach((function(t){Fe[t.name]=kt.extend(t)}));var Le=function(t){function e(e){var i=t.call(this)||this;return i._widget=e,i}return F(e,t),e.prototype.getWidget=function(){return this._widget},e.prototype.createFigure=function(t,e,i,n){var o=function(t){var e;return null!==(e=Fe[t])&&void 0!==e?e:null}(t);if(null!==o){var r=new o({name:t,attrs:e,styles:i});if(f(n)){for(var a in n)n.hasOwnProperty(a)&&r.registerEvent(a,n[a]);this.addChild(r)}return r}return null},e.prototype.draw=function(t){this.clear(),this.drawImp(t)},e}(Mt),Re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget(),n=this.getWidget().getPane(),o=n.getChart(),r=i.getBounding(),a=o.getStyles().grid;if(a.show){t.save(),t.globalCompositeOperation="destination-over";var s=a.horizontal;if(s.show)n.getAxisComponent().getTicks().forEach((function(i){var n;null===(n=e.createFigure("line",{coordinates:[{x:0,y:i.coord},{x:r.width,y:i.coord}]},s))||void 0===n||n.draw(t)}));var l=a.vertical;if(l.show)o.getXAxisPane().getAxisComponent().getTicks().forEach((function(i){var n;null===(n=e.createFigure("line",{coordinates:[{x:i.coord,y:0},{x:i.coord,y:r.height}]},l))||void 0===n||n.draw(t)}));t.restore()}},e}(Le);function Be(t,e){if(!p(t)||f(e)&&!p(e))throw new TypeError("Expected a function");var i=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=p(e)?e.apply(this,n):n[0],a=i.cache;if(a.has(r))return a.get(r);var s=t.apply(this,n);return i.cache=a.set(r,s)||a,s};return i.cache=new(Be.Cache||Map),i}Be.Cache=Map;var Oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.eachChildren=function(t){var e=this.getWidget().getPane().getChart().getChartStore(),i=e.getVisibleDataList(),n=e.getTimeScaleStore().getBarSpace();i.forEach((function(e,i){t(e,n,i)}))},e}(Le),Ve=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._boundCandleBarClickEvent=function(e){return function(){return i.getWidget().getPane().getChart().getChartStore().getActionStore().execute(t.ActionType.OnCandleBarClick,e),!1}},i._calcOhlcSize=Be((function(t){return Math.min(Math.max(Math.round(.1*t),1),3)})),i}return F(i,e),i.prototype.drawImp=function(t){var e=this,i=this.getWidget().getPane(),n=i.getId()===$t,o=i.getChart().getChartStore(),r=this.getCandleBarOptions(o);if(null!==r){var a=i.getAxisComponent();this.eachChildren((function(i,o){e._drawCandleBar(t,a,i,o,r,n)}))}},i.prototype.getCandleBarOptions=function(t){var e=t.getStyles().candle;return{type:e.type,styles:e.bar}},i.prototype._drawCandleBar=function(e,i,n,o,r,a){var s,l,u,c=this,h=n.data,d=n.x,p=h.open,g=h.high,v=h.low,f=h.close,m=o.halfGapBar,y=o.gapBar,_=r.type,x=r.styles;f>p?(s=x.upColor,l=x.upBorderColor,u=x.upWickColor):f<p?(s=x.downColor,l=x.downBorderColor,u=x.downWickColor):(s=x.noChangeColor,l=x.noChangeBorderColor,u=x.noChangeWickColor);var S=i.convertToPixel(p),C=i.convertToPixel(f),b=[S,C,i.convertToPixel(g),i.convertToPixel(v)];b.sort((function(t,e){return t-e}));var w=Math.max(1,b[2]-b[1]),T=[];if(_!==t.CandleType.Ohlc)T.push({name:"rect",attrs:{x:d-.5,y:b[0],width:1,height:b[1]-b[0]},styles:{color:u}}),_===t.CandleType.CandleStroke||_===t.CandleType.CandleUpStroke&&p<f||_===t.CandleType.CandleDownStroke&&p>f?T.push({name:"rect",attrs:{x:d-m+.5,y:b[1],width:y-1,height:w},styles:{style:t.PolygonType.Stroke,borderColor:l}}):T.push({name:"rect",attrs:{x:d-m+.5,y:b[1],width:y-1,height:w},styles:{style:t.PolygonType.StrokeFill,color:s,borderColor:l}}),T.push({name:"rect",attrs:{x:d-.5,y:b[2],width:1,height:b[3]-b[2]},styles:{color:u}});else{var E=this._calcOhlcSize(o.gapBar);T=[{name:"rect",attrs:{x:d-E/2,y:b[0],width:E,height:b[3]-b[0]},styles:{color:s}},{name:"rect",attrs:{x:d-m,y:S+E>b[3]?b[3]-E:S,width:m-E/2,height:E},styles:{color:s}},{name:"rect",attrs:{x:d+E/2,y:C+E>b[3]?b[3]-E:C,width:m-E/2,height:E},styles:{color:s}}]}T.forEach((function(t){var i,o,r=t.attrs,s=t.styles;a&&(o={mouseClickEvent:c._boundCandleBarClickEvent(n)}),null===(i=c.createFigure("rect",r,s,o))||void 0===i||i.draw(e)}))},i}(Oe),Ne=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.getCandleBarOptions=function(e){var i,n,o=this.getWidget().getPane();if(!o.getAxisComponent().isInCandle()){var r=e.getIndicatorStore().getInstances(o.getId());try{for(var a=V(r),s=a.next();!s.done;s=a.next()){var l=s.value;if(l.shouldOhlc&&l.visible){var u=l.styles,c=e.getStyles().indicator,h=b(u,"ohlc.upColor",c.ohlc.upColor),d=b(u,"ohlc.downColor",c.ohlc.downColor),p=b(u,"ohlc.noChangeColor",c.ohlc.noChangeColor);return{type:t.CandleType.Ohlc,styles:{upColor:h,downColor:d,noChangeColor:p,upBorderColor:h,downBorderColor:d,noChangeBorderColor:p,upWickColor:h,downWickColor:d,noChangeWickColor:p}}}}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}}return null},i.prototype.drawImp=function(t){var i=this;e.prototype.drawImp.call(this,t);var n=this.getWidget(),o=n.getPane(),r=o.getChart(),a=n.getBounding(),s=r.getXAxisPane().getAxisComponent(),l=o.getAxisComponent(),u=r.getChartStore(),c=u.getDataList(),h=u.getTimeScaleStore(),d=h.getVisibleRange(),p=u.getIndicatorStore().getInstances(o.getId()),g=u.getStyles().indicator;t.save(),p.forEach((function(e){var n;if(e.visible){e.zLevel<0?t.globalCompositeOperation="destination-over":t.globalCompositeOperation="source-over";var o=!1;if(null!==e.draw&&(t.save(),o=null!==(n=e.draw({ctx:t,kLineDataList:c,indicator:e,visibleRange:d,bounding:a,barSpace:h.getBarSpace(),defaultStyles:g,xAxis:s,yAxis:l}))&&void 0!==n&&n,t.restore()),!o){var r=e.result;i.eachChildren((function(n,o){var u,h,d,p=o.halfGapBar,m=o.gapBar,y=n.dataIndex,_=n.x,x=s.convertToPixel(y-1),S=s.convertToPixel(y+1),C=null!==(u=r[y-1])&&void 0!==u?u:{},b=null!==(h=r[y])&&void 0!==h?h:{},w=null!==(d=r[y+1])&&void 0!==d?d:{},T={x:x},E={x:_},I={x:S};e.figures.forEach((function(t){var e=t.key;T[e]=l.convertToPixel(C[e]),E[e]=l.convertToPixel(b[e]),I[e]=l.convertToPixel(w[e])})),W(c,e,y,g,(function(e,n){var r,u,c;if(f(b[e.key])){var h=E[e.key],d=null===(r=e.attrs)||void 0===r?void 0:r.call(e,{coordinate:{prev:T,current:E,next:I},bounding:a,barSpace:o,xAxis:s,yAxis:l});if(!f(d))switch(e.type){case"circle":d={x:_,y:h,r:p};break;case"rect":case"bar":var g=null!==(u=e.baseValue)&&void 0!==u?u:l.getExtremum().min,y=l.convertToPixel(g),x=Math.abs(y-h);g!==b[e.key]&&(x=Math.max(1,x));d={x:_-p,y:h>y?y:h,width:m,height:x};break;case"line":v(E[e.key])&&v(I[e.key])&&(d={coordinates:[{x:E.x,y:E[e.key]},{x:I.x,y:I[e.key]}]})}if(f(d)){var S=e.type;null===(c=i.createFigure("bar"===S?"rect":S,d,n))||void 0===c||c.draw(t)}}}))}))}}})),t.restore()},i}(Ve),ze=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=e.getBounding(),o=e.getPane().getChart().getChartStore(),r=o.getTooltipStore().getCrosshair(),a=o.getStyles().crosshair;if(y(r.paneId)&&a.show){if(r.paneId===i.getId()){var s=r.y;this._drawLine(t,[{x:0,y:s},{x:n.width,y:s}],a.horizontal)}var l=r.realX;this._drawLine(t,[{x:l,y:0},{x:l,y:n.height}],a.vertical)}},e.prototype._drawLine=function(t,e,i){var n;if(i.show){var o=i.line;o.show&&(null===(n=this.createFigure("line",{coordinates:e},o))||void 0===n||n.draw(t))}},e}(Le),We=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._boundIconClickEvent=function(e,n){return function(){return i.getWidget().getPane().getChart().getChartStore().getActionStore().execute(t.ActionType.OnTooltipIconClick,R(R({},e),{iconId:n})),!0}},i._boundIconMouseMoveEvent=function(t,e){return function(){return i.getWidget().getPane().getChart().getChartStore().getTooltipStore().setActiveIcon(R(R({},t),{iconId:e})),!0}},i}return F(i,e),i.prototype.drawImp=function(t){var e=this.getWidget(),i=e.getPane(),n=i.getChart().getChartStore(),o=n.getTooltipStore().getCrosshair();if(f(o.kLineData)){var r=e.getBounding(),a=n.getCustomApi(),s=n.getThousandsSeparator(),l=n.getIndicatorStore().getInstances(i.getId()),u=n.getTooltipStore().getActiveIcon(),c=n.getStyles().indicator;this.drawIndicatorTooltip(t,i.getId(),n.getDataList(),o,u,l,a,s,r,c)}},i.prototype.drawIndicatorTooltip=function(t,e,i,n,o,r,a,s,l,u,c){var h=this,d=u.tooltip,p=0;if(this.isDrawTooltip(n,d)){var g=d.text,v=0,f=null!=c?c:0,m=0;r.forEach((function(r){var c=h.getIndicatorTooltipData(i,n,r,a,s,u),d=c.name,y=c.calcParamsText,_=c.values,x=c.icons,S=d.length>0,C=_.length>0;if(S||C){var b=N(h.classifyTooltipIcons(x),3),w=b[0],T=b[1],E=b[2],I=N(h.drawStandardTooltipIcons(t,l,{paneId:e,indicatorName:r.name,iconId:""},o,w,v,f,m),4),P=I[0],D=I[1],M=I[2],k=I[3];if(v=P,f=D,p+=k,m=M,S){var A=d;y.length>0&&(A="".concat(A).concat(y));var F=N(h.drawStandardTooltipLabels(t,l,[{title:{text:"",color:g.color},value:{text:A,color:g.color}}],v,f,m,g),4),L=F[0],R=F[1],B=F[2],O=F[3];v=L,f=R,p+=O,m=B}var V=N(h.drawStandardTooltipIcons(t,l,{paneId:e,indicatorName:r.name,iconId:""},o,T,v,f,m),4),z=V[0],W=V[1],Y=V[2],H=V[3];if(v=z,f=W,p+=H,m=Y,C){var X=N(h.drawStandardTooltipLabels(t,l,_,v,f,m,g),4),j=X[0],G=X[1],K=X[2],Z=X[3];v=j,f=G,p+=Z,m=K}var U=N(h.drawStandardTooltipIcons(t,l,{paneId:e,indicatorName:r.name,iconId:""},o,E,v,f,m),4),q=U[1],$=U[2],J=U[3];v=0,p+=J,f=q+$,m=0}}))}return p},i.prototype.drawStandardTooltipIcons=function(t,e,i,n,o,r,a,s){var l=this,u=r,c=a,h=0,d=0,p=0;return o.length>0&&(o.forEach((function(e){var i=e.marginLeft,n=e.marginTop,o=e.marginRight,r=e.marginBottom,a=e.paddingLeft,s=e.paddingTop,l=e.paddingRight,u=e.paddingBottom,c=e.size,p=e.fontFamily,g=e.icon;t.font=D(c,"normal",p),h+=i+a+t.measureText(g).width+l+o,d=Math.max(d,n+s+c+u+r)})),u+h>e.width?(u=o[0].marginLeft,c+=s,p=d):p=Math.max(0,d-s),o.forEach((function(e){var o,r=e.marginLeft,a=e.marginTop,s=e.marginRight,h=e.paddingLeft,d=e.paddingTop,p=e.paddingRight,g=e.paddingBottom,v=e.color,f=e.activeColor,m=e.size,y=e.fontFamily,_=e.icon,x=e.backgroundColor,S=e.activeBackgroundColor;u+=r;var C=(null==n?void 0:n.paneId)===i.paneId&&(null==n?void 0:n.indicatorName)===i.indicatorName&&(null==n?void 0:n.iconId)===e.id;null===(o=l.createFigure("text",{text:_,x:u,y:c+a},{paddingLeft:h,paddingTop:d,paddingRight:p,paddingBottom:g,color:C?f:v,size:m,family:y,backgroundColor:C?S:x},{mouseClickEvent:l._boundIconClickEvent(i,e.id),mouseMoveEvent:l._boundIconMouseMoveEvent(i,e.id)}))||void 0===o||o.draw(t),u+=h+t.measureText(_).width+p+s}))),[u,c,Math.max(s,d),p]},i.prototype.drawStandardTooltipLabels=function(t,e,i,n,o,r,a){var s=this,l=n,u=o,c=0,h=0,d=r;if(i.length>0){var p=a.marginLeft,g=a.marginTop,v=a.marginRight,f=a.marginBottom,m=a.size,y=a.family,_=a.weight;t.font=D(m,_,y),i.forEach((function(i){var n,o,r=i.title,a=i.value,x=t.measureText(r.text).width,S=t.measureText(a.text).width,C=m+g+f;l+p+(x+S)+v>e.width?(l=p,u+=C,h+=C):(l+=p,h+=Math.max(0,C-d)),c=Math.max(d,C),d=c,r.text.length>0&&(null===(n=s.createFigure("text",{x:l,y:u+g,text:r.text},{color:r.color,size:m,family:y,weight:_}))||void 0===n||n.draw(t),l+=x),null===(o=s.createFigure("text",{x:l,y:u+g,text:a.text},{color:a.color,size:m,family:y,weight:_}))||void 0===o||o.draw(t),l+=S+v}))}return[l,u,c,h]},i.prototype.isDrawTooltip=function(e,i){var n=i.showRule;return n===t.TooltipShowRule.Always||n===t.TooltipShowRule.FollowCross&&y(e.paneId)},i.prototype.getIndicatorTooltipData=function(t,e,i,n,o,r){var a,s,l=r.tooltip,u=l.showName?i.shortName:"",c="",h=i.calcParams;h.length>0&&l.showParams&&(c="(".concat(h.join(","),")"));var d={name:u,calcParamsText:c,values:[],icons:l.icons},p=e.dataIndex,v=null!==(a=i.result)&&void 0!==a?a:[],m=[];if(i.visible){var _=null!==(s=v[p])&&void 0!==s?s:{};W(t,i,p,r,(function(t,e){if(y(t.title)){var r=e.color,a=_[t.key];f(a)&&(a=T(a,i.precision),i.shouldFormatBigNumber&&(a=n.formatBigNumber(a))),m.push({title:{text:t.title,color:r},value:{text:I(null!=a?a:l.defaultValue,o),color:r}})}})),d.values=m}if(null!==i.createTooltipDataSource){var x=this.getWidget(),S=x.getPane(),C=S.getChart().getChartStore(),b=i.createTooltipDataSource({kLineDataList:t,indicator:i,visibleRange:C.getTimeScaleStore().getVisibleRange(),bounding:x.getBounding(),crosshair:e,defaultStyles:r,xAxis:S.getChart().getXAxisPane().getAxisComponent(),yAxis:S.getAxisComponent()}),w=b.name,E=b.calcParamsText,P=b.values,D=b.icons;if(y(w)&&l.showName&&(d.name=w),y(E)&&l.showParams&&(d.calcParamsText=E),f(D)&&(d.icons=D),f(P)&&i.visible){var M=[],k=r.tooltip.text.color;P.forEach((function(t){var e={text:"",color:k};g(t.title)?e=t.title:e.text=t.title;var i={text:"",color:k};g(t.value)?i=t.value:i.text=t.value,i.text=I(i.text,o),M.push({title:e,value:i})})),d.values=M}}return d},i.prototype.classifyTooltipIcons=function(e){var i=[],n=[],o=[];return e.forEach((function(e){switch(e.position){case t.TooltipIconPosition.Left:i.push(e);break;case t.TooltipIconPosition.Middle:n.push(e);break;case t.TooltipIconPosition.Right:o.push(e)}})),[i,n,o]},i}(Le),Ye=function(e){function i(t){var i=e.call(this,t)||this;return i._initEvent(),i}return F(i,e),i.prototype._initEvent=function(){var t=this,e=this.getWidget().getPane(),i=e.getId(),n=e.getChart().getChartStore().getOverlayStore();this.registerEvent("mouseMoveEvent",(function(e){var o,r=n.getProgressInstanceInfo();if(null!==r){var a=r.instance,s=r.paneId;a.isStart()&&(n.updateProgressInstanceInfo(i),s=i);var l=a.points.length-1,u="".concat(j,"point_").concat(l);return a.isDrawing()&&s===i&&(a.eventMoveForDrawing(t._coordinateToPoint(r.instance,e)),null===(o=a.onDrawing)||void 0===o||o.call(a,R({overlay:a,figureKey:u,figureIndex:l},e))),t._figureMouseMoveEvent(a,1,u,l,0)(e)}return n.setHoverInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},e),!1})).registerEvent("mouseClickEvent",(function(e){var o,r,a=n.getProgressInstanceInfo();if(null!==a){var s=a.instance,l=a.paneId;s.isStart()&&(n.updateProgressInstanceInfo(i,!0),l=i);var u=s.points.length-1,c="".concat(j,"point_").concat(u);return s.isDrawing()&&l===i&&(s.eventMoveForDrawing(t._coordinateToPoint(s,e)),null===(o=s.onDrawing)||void 0===o||o.call(s,R({overlay:s,figureKey:c,figureIndex:u},e)),s.nextStep(),s.isDrawing()||(n.progressInstanceComplete(),null===(r=s.onDrawEnd)||void 0===r||r.call(s,R({overlay:s,figureKey:c,figureIndex:u},e)))),t._figureMouseClickEvent(s,1,c,u,0)(e)}return n.setClickInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1},e),!1})).registerEvent("mouseDoubleClickEvent",(function(e){var o,r=n.getProgressInstanceInfo();if(null!==r){var a=r.instance,s=r.paneId;if(a.isDrawing()&&s===i&&(a.forceComplete(),!a.isDrawing())){n.progressInstanceComplete();var l=a.points.length-1,u="".concat(j,"point_").concat(l);null===(o=a.onDrawEnd)||void 0===o||o.call(a,R({overlay:a,figureKey:u,figureIndex:l},e))}var c=a.points.length-1;return t._figureMouseClickEvent(a,1,"".concat(j,"point_").concat(c),c,0)(e)}return!1})).registerEvent("mouseRightClickEvent",(function(e){var i=n.getProgressInstanceInfo();if(null!==i){var o=i.instance;if(o.isDrawing()){var r=o.points.length-1;return t._figureMouseRightClickEvent(o,1,"".concat(j,"point_").concat(r),r,0)(e)}}return!1})).registerEvent("mouseUpEvent",(function(t){var e,o=n.getPressedInstanceInfo(),r=o.instance,a=o.figureIndex,s=o.figureKey;return null!==r&&(null===(e=r.onPressedMoveEnd)||void 0===e||e.call(r,R({overlay:r,figureKey:s,figureIndex:a},t))),n.setPressedInstanceInfo({paneId:i,instance:null,figureType:0,figureKey:"",figureIndex:-1,attrsIndex:-1}),!1})).registerEvent("pressedMouseMoveEvent",(function(e){var i,o,r=n.getPressedInstanceInfo(),a=r.instance,s=r.figureType,l=r.figureIndex,u=r.figureKey;if(null!==a){if(!(a.lock||null!==(o=null===(i=a.onPressedMoving)||void 0===i?void 0:i.call(a,R({overlay:a,figureIndex:l,figureKey:u},e)))&&void 0!==o&&o)){var c=t._coordinateToPoint(a,e);1===s?a.eventPressedPointMove(c,l):a.eventPressedOtherMove(c,t.getWidget().getPane().getChart().getChartStore().getTimeScaleStore())}return!0}return!1}))},i.prototype._createFigureEvents=function(t,e,i,n,o,r){var a;if(!t.isDrawing()){var s=[];if(f(r)&&(m(r)?r&&(s=["mouseClickEvent","mouseDoubleClickEvent","mouseRightClickEvent","tapEvent","doubleTapEvent","mouseDownEvent","touchStartEvent","mouseMoveEvent","touchMoveEvent"]):s=r),0===s.length)return{mouseMoveEvent:this._figureMouseMoveEvent(t,e,i,n,o),mouseDownEvent:this._figureMouseDownEvent(t,e,i,n,o),mouseClickEvent:this._figureMouseClickEvent(t,e,i,n,o),mouseRightClickEvent:this._figureMouseRightClickEvent(t,e,i,n,o),mouseDoubleClickEvent:this._figureMouseDoubleClickEvent(t,e,i,n,o)};a={},s.includes("mouseMoveEvent")||s.includes("touchMoveEvent")||(a.mouseMoveEvent=this._figureMouseMoveEvent(t,e,i,n,o)),s.includes("mouseDownEvent")||s.includes("touchStartEvent")||(a.mouseDownEvent=this._figureMouseDownEvent(t,e,i,n,o)),s.includes("mouseClickEvent")||s.includes("tapEvent")||(a.mouseClickEvent=this._figureMouseClickEvent(t,e,i,n,o)),s.includes("mouseDoubleClickEvent")||s.includes("doubleTapEvent")||(a.mouseDoubleClickEvent=this._figureMouseDoubleClickEvent(t,e,i,n,o)),s.includes("mouseRightClickEvent")||(a.mouseRightClickEvent=this._figureMouseRightClickEvent(t,e,i,n,o))}return a},i.prototype._figureMouseMoveEvent=function(t,e,i,n,o){var r=this;return function(a){var s=r.getWidget().getPane();return s.getChart().getChartStore().getOverlayStore().setHoverInstanceInfo({paneId:s.getId(),instance:t,figureType:e,figureKey:i,figureIndex:n,attrsIndex:o},a),!0}},i.prototype._figureMouseDownEvent=function(t,e,i,n,o){var r=this;return function(a){var s,l=r.getWidget().getPane(),u=l.getId(),c=l.getChart().getChartStore().getOverlayStore();return t.startPressedMove(r._coordinateToPoint(t,a)),null===(s=t.onPressedMoveStart)||void 0===s||s.call(t,R({overlay:t,figureIndex:n,figureKey:i},a)),c.setPressedInstanceInfo({paneId:u,instance:t,figureType:e,figureKey:i,figureIndex:n,attrsIndex:o}),!0}},i.prototype._figureMouseClickEvent=function(t,e,i,n,o){var r=this;return function(a){var s=r.getWidget().getPane(),l=s.getId();return s.getChart().getChartStore().getOverlayStore().setClickInstanceInfo({paneId:l,instance:t,figureType:e,figureKey:i,figureIndex:n,attrsIndex:o},a),!0}},i.prototype._figureMouseDoubleClickEvent=function(t,e,i,n,o){return function(e){var o;return null===(o=t.onDoubleClick)||void 0===o||o.call(t,R(R({},e),{figureIndex:n,figureKey:i,overlay:t})),!0}},i.prototype._figureMouseRightClickEvent=function(t,e,i,n,o){var r=this;return function(e){var o,a;null!==(a=null===(o=t.onRightClick)||void 0===o?void 0:o.call(t,R({overlay:t,figureIndex:n,figureKey:i},e)))&&void 0!==a&&a||r.getWidget().getPane().getChart().getChartStore().getOverlayStore().removeInstance(t);return!0}},i.prototype._coordinateToPoint=function(e,i){var n,o={},r=this.getWidget().getPane(),a=r.getChart(),s=r.getId(),l=a.getChartStore().getTimeScaleStore();if(this.coordinateToPointTimestampDataIndexFlag()){var u=a.getXAxisPane().getAxisComponent().convertFromPixel(i.x),c=null!==(n=l.dataIndexToTimestamp(u))&&void 0!==n?n:void 0;o.dataIndex=u,o.timestamp=c}if(this.coordinateToPointValueFlag()){var h=r.getAxisComponent(),d=h.convertFromPixel(i.y);if(e.mode!==t.OverlayMode.Normal&&s===$t&&v(o.dataIndex)){var p=l.getDataByDataIndex(o.dataIndex);if(null!==p){var g=e.modeSensitivity;if(d>p.high)if(e.mode===t.OverlayMode.WeakMagnet){var f=h.convertToPixel(p.high);d<h.convertFromPixel(f-g)&&(d=p.high)}else d=p.high;else if(d<p.low)if(e.mode===t.OverlayMode.WeakMagnet){var m=h.convertToPixel(p.low);d>h.convertFromPixel(m-g)&&(d=p.low)}else d=p.low;else{var y=Math.max(p.open,p.close),_=Math.min(p.open,p.close);d=d>y?d-y<p.high-d?y:p.high:d<_?d-p.low<_-d?p.low:_:y-d<d-_?y:_}}}o.value=d}return o},i.prototype.coordinateToPointValueFlag=function(){return!0},i.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},i.prototype.dispatchEvent=function(t,i,n){return this.getWidget().getPane().getChart().getChartStore().getOverlayStore().isDrawing()?this.onEvent(t,i,n):e.prototype.dispatchEvent.call(this,t,i,n)},i.prototype.checkEventOn=function(){return!0},i.prototype.drawImp=function(t){var e=this,i=this.getWidget(),n=i.getPane(),o=n.getId(),r=n.getChart(),a=n.getAxisComponent(),s=r.getXAxisPane().getAxisComponent(),l=i.getBounding(),u=r.getChartStore(),c=u.getCustomApi(),h=u.getThousandsSeparator(),d=u.getTimeScaleStore(),p=d.getDateTimeFormat(),g=d.getBarSpace(),v=u.getPrecision(),f=u.getStyles().overlay,m=u.getOverlayStore(),y=m.getHoverInstanceInfo(),_=m.getClickInstanceInfo();this.getCompleteOverlays(m,o).forEach((function(i){i.visible&&e._drawOverlay(t,i,l,g,v,p,c,h,f,s,a,y,_,d)}));var x=m.getProgressInstanceInfo();if(null!==x){var S=this.getProgressOverlay(x,o);null!==S&&S.visible&&this._drawOverlay(t,S,l,g,v,p,c,h,f,s,a,y,_,d)}},i.prototype._drawOverlay=function(t,e,i,n,o,r,a,s,l,u,c,h,d,p){var g=e.points.map((function(t){var e,i,n=t.dataIndex;v(t.timestamp)&&(n=p.timestampToDataIndex(t.timestamp));var o={x:0,y:0};return v(n)&&(o.x=null!==(e=null==u?void 0:u.convertToPixel(n))&&void 0!==e?e:0),v(t.value)&&(o.y=null!==(i=null==c?void 0:c.convertToPixel(t.value))&&void 0!==i?i:0),o}));if(g.length>0){var f=(new Array).concat(this.getFigures(e,g,i,n,o,s,r,l,u,c));this.drawFigures(t,e,f,l)}this.drawDefaultFigures(t,e,g,i,o,r,a,s,l,u,c,h,d)},i.prototype.drawFigures=function(t,e,i,n){var o=this;i.forEach((function(i,r){var a=i.type,s=i.styles,l=i.attrs,u=i.ignoreEvent;[].concat(l).forEach((function(l,c){var h,d,p,g=o._createFigureEvents(e,2,null!==(h=i.key)&&void 0!==h?h:"",r,c,u),v=R(R(R({},n[a]),null===(d=e.styles)||void 0===d?void 0:d[a]),s);null===(p=o.createFigure(a,l,v,g))||void 0===p||p.draw(t)}))}))},i.prototype.getCompleteOverlays=function(t,e){return t.getInstances(e)},i.prototype.getProgressOverlay=function(t,e){return t.paneId===e?t.instance:null},i.prototype.getFigures=function(t,e,i,n,o,r,a,s,l,u){var c,h;return null!==(h=null===(c=t.createPointFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,thousandsSeparator:r,dateTimeFormat:a,defaultStyles:s,xAxis:l,yAxis:u}))&&void 0!==h?h:[]},i.prototype.drawDefaultFigures=function(t,e,i,n,o,r,a,s,l,u,c,h,d){var p,g,v=this;if(e.needDefaultPointFigure&&((null===(p=h.instance)||void 0===p?void 0:p.id)===e.id&&0!==h.figureType||(null===(g=d.instance)||void 0===g?void 0:g.id)===e.id&&0!==d.figureType)){var f=e.styles,m=R(R({},l.point),null==f?void 0:f.point);i.forEach((function(i,n){var o,r,a,s=i.x,l=i.y,u=m.radius,c=m.color,d=m.borderColor,p=m.borderSize;(null===(o=h.instance)||void 0===o?void 0:o.id)===e.id&&1===h.figureType&&h.figureIndex===n&&(u=m.activeRadius,c=m.activeColor,d=m.activeBorderColor,p=m.activeBorderSize),null===(r=v.createFigure("circle",{x:s,y:l,r:u+p},{color:d},v._createFigureEvents(e,1,"".concat(j,"point_").concat(n),n,0)))||void 0===r||r.draw(t),null===(a=v.createFigure("circle",{x:s,y:l,r:u},{color:c}))||void 0===a||a.draw(t)}))}},i}(Le),He=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._gridView=new Re(n),n._indicatorView=new Ne(n),n._crosshairLineView=new ze(n),n._tooltipView=n.createTooltipView(),n._overlayView=new Ye(n),n.addChild(n._tooltipView),n.addChild(n._overlayView),n.getContainer().style.cursor="crosshair",n.registerEvent("mouseMoveEvent",(function(){return i.getChart().getChartStore().getTooltipStore().setActiveIcon(),!1})),n}return F(e,t),e.prototype.getName=function(){return re},e.prototype.updateMain=function(t){this.updateMainContent(t),this._indicatorView.draw(t),this._gridView.draw(t)},e.prototype.createTooltipView=function(){return new We(this)},e.prototype.updateMainContent=function(t){},e.prototype.updateOverlay=function(t){this._overlayView.draw(t),this._crosshairLineView.draw(t),this._tooltipView.draw(t)},e}(ge),Xe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.drawImp=function(t){var e,i,n=this.getWidget(),o=n.getPane(),r=o.getChart(),a=n.getBounding(),s=o.getAxisComponent(),l=r.getStyles().candle.area,u=[],c=[],h=Number.MAX_SAFE_INTEGER;this.eachChildren((function(t,e,i){var n=t.data,o=t.x,r=e.halfGapBar,d=n[l.value];if(v(d)){var p=s.convertToPixel(d);if(0===i){var g=o-r;c.push({x:g,y:a.height}),c.push({x:g,y:p}),u.push({x:g,y:p})}u.push({x:o,y:p}),c.push({x:o,y:p}),h=Math.min(h,p)}}));var p=c.length;if(p>0){var g=c[p-1],f=g.x;u.push({x:f,y:g.y}),c.push({x:f,y:g.y}),c.push({x:f,y:a.height})}if(u.length>0&&(null===(e=this.createFigure("line",{coordinates:u},{color:l.lineColor,size:l.lineSize}))||void 0===e||e.draw(t)),c.length>0){var m=l.backgroundColor,y=void 0;if(d(m)){var _=t.createLinearGradient(0,a.height,0,h);try{m.forEach((function(t){var e=t.offset,i=t.color;_.addColorStop(e,i)}))}catch(t){}y=_}else y=m;null===(i=this.createFigure("polygon",{coordinates:c},{color:y}))||void 0===i||i.draw(t)}},e}(Oe),je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.drawImp=function(t){var e=this.getWidget().getPane(),i=e.getChart().getChartStore(),n=i.getStyles().candle.priceMark,o=n.high,r=n.low;if(n.show&&(o.show||r.show)){var a=i.getThousandsSeparator(),s=i.getPrecision(),l=e.getAxisComponent(),u=Number.MIN_SAFE_INTEGER,c=0,h=Number.MAX_SAFE_INTEGER,d=0;this.eachChildren((function(t){var e=t.data,i=t.x;u<e.high&&(u=e.high,c=i),h>e.low&&(h=e.low,d=i)}));var p=l.convertToPixel(u),g=l.convertToPixel(h);o.show&&u!==Number.MIN_SAFE_INTEGER&&this._drawMark(t,I(T(u,s.price),a),{x:c,y:p},p<g?[-2,-5]:[2,5],o),r.show&&h!==Number.MAX_SAFE_INTEGER&&this._drawMark(t,I(T(h,s.price),a),{x:d,y:g},p<g?[2,5]:[-2,-5],r)}},e.prototype._drawMark=function(t,e,i,n,o){var r,a,s,l,u,c,h=i.x,d=i.y+n[0];null===(r=this.createFigure("line",{coordinates:[{x:h-2,y:d+n[0]},{x:h,y:d},{x:h+2,y:d+n[0]}]},{color:o.color}))||void 0===r||r.draw(t),h>this.getWidget().getBounding().width/2?(u=(l=h-5)-o.textOffset,c="right"):(c="left",u=(l=h+5)+o.textOffset);var p=d+n[1];null===(a=this.createFigure("line",{coordinates:[{x:h,y:d},{x:h,y:p},{x:l,y:p}]},{color:o.color}))||void 0===a||a.draw(t),null===(s=this.createFigure("text",{x:u,y:p,text:e,align:c,baseline:"middle"},{color:o.color,size:o.textSize,family:o.textFamily,weight:o.textWeight}))||void 0===s||s.draw(t)},e}(Oe),Ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=n.getChart().getChartStore(),a=r.getStyles().candle.priceMark,s=a.last,l=s.line;if(a.show&&s.show&&l.show){var u=n.getAxisComponent(),c=r.getDataList(),h=c[c.length-1];if(null!=h){var d=h.close,p=h.open,g=u.convertToNicePixel(d),v=void 0;v=d>p?s.upColor:d<p?s.downColor:s.noChangeColor,null===(e=this.createFigure("line",{coordinates:[{x:0,y:g},{x:o.width,y:g}]},{style:l.style,color:v,size:l.size,dashedValue:l.dashedValue}))||void 0===e||e.draw(t)}}},e}(Le),Ke={"zh-CN":{time:"",open:"",high:"",low:"",close:"",volume:"",turnover:"",change:""},"en-US":{time:"Time: ",open:"Open: ",high:"High: ",low:"Low: ",close:"Close: ",volume:"Volume: ",turnover:"Turnover: ",change:"Change: "}};var Ze=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.drawImp=function(e){var i,n=this.getWidget(),o=n.getPane(),r=o.getId(),a=o.getChart().getChartStore(),s=a.getTooltipStore().getCrosshair();if(f(s.kLineData)){var l=n.getBounding(),u=null===(i=o.getYAxisWidget())||void 0===i?void 0:i.getBounding(),c=a.getDataList(),h=a.getPrecision(),d=a.getLocale(),p=a.getCustomApi(),g=a.getThousandsSeparator(),v=a.getTooltipStore().getActiveIcon(),m=a.getIndicatorStore().getInstances(o.getId()),y=a.getTimeScaleStore().getDateTimeFormat(),_=a.getStyles(),x=_.candle,S=_.indicator;if(x.tooltip.showType===t.TooltipShowType.Rect&&S.tooltip.showType===t.TooltipShowType.Rect){var C=this.isDrawTooltip(s,x.tooltip),b=this.isDrawTooltip(s,S.tooltip);this._drawRectTooltip(e,c,m,l,u,s,h,y,d,p,g,C,b,_,0)}else if(x.tooltip.showType===t.TooltipShowType.Standard&&S.tooltip.showType===t.TooltipShowType.Standard){var w=this._drawCandleStandardTooltip(e,c,r,l,s,v,h,y,d,p,g,x);this.drawIndicatorTooltip(e,r,c,s,v,m,p,g,l,S,w)}else if(x.tooltip.showType===t.TooltipShowType.Rect&&S.tooltip.showType===t.TooltipShowType.Standard){var T=this.drawIndicatorTooltip(e,r,c,s,v,m,p,g,l,S,0);C=this.isDrawTooltip(s,x.tooltip);this._drawRectTooltip(e,c,m,l,u,s,h,y,d,p,g,C,!1,_,T)}else{var E=this._drawCandleStandardTooltip(e,c,r,l,s,v,h,y,d,p,g,x);b=this.isDrawTooltip(s,S.tooltip);this._drawRectTooltip(e,c,m,l,u,s,h,y,d,p,g,!1,b,_,E)}}},i.prototype._drawCandleStandardTooltip=function(t,e,i,n,o,r,a,s,l,u,c,h){var d,p,g,v=h.tooltip,f=v.text,m=0;if(this.isDrawTooltip(o,v)){var y=null!==(d=o.dataIndex)&&void 0!==d?d:0,_=this._getCandleTooltipData({prev:null!==(p=e[y-1])&&void 0!==p?p:null,current:o.kLineData,next:null!==(g=e[y+1])&&void 0!==g?g:null},a,s,l,u,c,h),x=0,S=0,C=0,b=N(this.classifyTooltipIcons(v.icons),3),w=b[0],T=b[1],E=b[2],I=N(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,w,x,S,0),4),P=I[0],D=I[1],M=I[2];x=P,S=D,m+=I[3],C=M;var k=N(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,T,x,S,C),4),A=k[0],F=k[1],L=k[2];if(x=A,S=F,m+=k[3],C=L,_.length>0){var R=N(this.drawStandardTooltipLabels(t,n,_,x,S,C,f),4),B=R[0],O=R[1],V=R[2];x=B,S=O,m+=R[3],C=V}var z=N(this.drawStandardTooltipIcons(t,n,{paneId:i,indicatorName:"",iconId:""},r,E,x,S,C),4),W=z[0],Y=z[1],H=z[2];x=W,S=Y,m+=z[3],C=H}return m},i.prototype._drawRectTooltip=function(e,i,n,o,r,s,l,u,c,h,d,p,g,v,f){var m,y,_,x,S,C=this,b=v.candle,w=v.indicator,T=b.tooltip,E=w.tooltip;if(p||g){var I=null!==(m=s.dataIndex)&&void 0!==m?m:0,P=this._getCandleTooltipData({prev:null!==(y=i[I-1])&&void 0!==y?y:null,current:s.kLineData,next:null!==(_=i[I+1])&&void 0!==_?_:null},l,u,c,h,d,b),M=T.text,k=M.marginLeft,A=M.marginRight,F=M.marginTop,L=M.marginBottom,R=M.size,B=M.weight,O=M.family,V=T.rect,N=V.position,z=V.paddingLeft,W=V.paddingRight,Y=V.paddingTop,H=V.paddingBottom,X=V.offsetLeft,j=V.offsetRight,G=V.offsetTop,K=V.offsetBottom,Z=V.borderSize,U=V.borderRadius,q=V.borderColor,$=V.color,J=0,Q=0,tt=0;p&&(e.font=D(R,B,O),P.forEach((function(t){var i=t.title,n=t.value,o="".concat(i.text).concat(n.text),r=e.measureText(o).width+k+A;J=Math.max(J,r)})),tt+=(L+F+R)*P.length);var et=E.text,it=et.marginLeft,nt=et.marginRight,ot=et.marginTop,rt=et.marginBottom,at=et.size,st=et.weight,lt=et.family,ut=[];if(g&&(e.font=D(at,st,lt),n.forEach((function(t){var n,o=null!==(n=C.getIndicatorTooltipData(i,s,t,h,d,w).values)&&void 0!==n?n:[];ut.push(o),o.forEach((function(t){var i=t.title,n=t.value,o="".concat(i.text).concat(n.text),r=e.measureText(o).width+it+nt;J=Math.max(J,r),tt+=ot+rt+at}))}))),0!==(Q+=J)&&0!==tt){Q+=2*Z+z+W,tt+=2*Z+Y+H;var ct=o.width/2,ht=N===a.Pointer&&s.paneId===$t,dt=(null!==(x=s.realX)&&void 0!==x?x:0)>ct,pt=0;if(ht){var gt=s.realX;pt=dt?gt-j-Q:gt+X}else dt?(pt=X,v.yAxis.inside&&v.yAxis.position===t.YAxisPosition.Left&&(pt+=r.width)):(pt=o.width-j-Q,v.yAxis.inside&&v.yAxis.position===t.YAxisPosition.Right&&(pt-=r.width));var vt=f+G;if(ht)(vt=s.y-tt/2)+tt>o.height-K&&(vt=o.height-K-tt),vt<f+G&&(vt=f+G);null===(S=this.createFigure("rect",{x:pt,y:vt,width:Q,height:tt},{style:t.PolygonType.StrokeFill,color:$,borderColor:q,borderSize:Z,borderRadius:U}))||void 0===S||S.draw(e);var ft=pt+Z+z+k,mt=vt+Z+Y;if(p&&P.forEach((function(t){var i,n;mt+=F;var o=t.title;null===(i=C.createFigure("text",{x:ft,y:mt,text:o.text},{color:o.color,size:R,family:O,weight:B}))||void 0===i||i.draw(e);var r=t.value;null===(n=C.createFigure("text",{x:pt+Q-Z-A-W,y:mt,text:r.text,align:"right"},{color:r.color,size:R,family:O,weight:B}))||void 0===n||n.draw(e),mt+=R+L})),g){var yt=pt+Z+z+it;ut.forEach((function(t){t.forEach((function(t){var i,n;mt+=ot;var o=t.title,r=t.value;null===(i=C.createFigure("text",{x:yt,y:mt,text:o.text},{color:o.color,size:at,family:lt,weight:st}))||void 0===i||i.draw(e),null===(n=C.createFigure("text",{x:pt+Q-Z-nt-W,y:mt,text:r.text,align:"right"},{color:r.color,size:at,family:lt,weight:st}))||void 0===n||n.draw(e),mt+=at+rt}))}))}}}},i.prototype._getCandleTooltipData=function(e,i,n,o,r,a,s){var l,u,c,h,d,v,f=s.tooltip,m=f.text.color,y=e.current,_=null!==(u=null===(l=e.prev)||void 0===l?void 0:l.close)&&void 0!==u?u:y.close,x=y.close-_,S=i.price,C=i.volume,b={"{time}":r.formatDate(n,y.timestamp,"YYYY-MM-DD HH:mm",t.FormatDateType.Tooltip),"{open}":I(T(y.open,S),a),"{high}":I(T(y.high,S),a),"{low}":I(T(y.low,S),a),"{close}":I(T(y.close,S),a),"{volume}":I(r.formatBigNumber(T(null!==(c=y.volume)&&void 0!==c?c:f.defaultValue,C)),a),"{turnover}":I(T(null!==(h=y.turnover)&&void 0!==h?h:f.defaultValue,S),a),"{change}":0===_?f.defaultValue:"".concat(T(x/_*100),"%")};return(null!==(v=p(f.custom)?null===(d=f.custom)||void 0===d?void 0:d.call(f,e,s):f.custom)&&void 0!==v?v:[{title:"time",value:"{time}"},{title:"open",value:"{open}"},{title:"high",value:"{high}"},{title:"low",value:"{low}"},{title:"close",value:"{close}"},{title:"volume",value:"{volume}"}]).map((function(t){var e,i=t.title,n=t.value,r={text:"",color:""};g(i)?r=R({},i):(r.text=i,r.color=m),r.text=function(t,e){var i,n;return null!==(n=null===(i=Ke[e])||void 0===i?void 0:i[t])&&void 0!==n?n:t}(r.text,o);var a={text:f.defaultValue,color:""};g(n)?a=R({},n):(a.text=n,a.color=m);var l=a.text.match(/{(\S*)}/);if(null!==l&&l.length>1){var u="{".concat(l[1],"}");a.text=a.text.replace(u,null!==(e=b[u])&&void 0!==e?e:f.defaultValue),"{change}"===u&&(a.color=0===x?s.priceMark.last.noChangeColor:x>0?s.priceMark.last.upColor:s.priceMark.last.downColor)}return{title:r,value:a}}))},i}(We),Ue=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n._candleBarView=new Ve(n),n._candleAreaView=new Xe(n),n._candleHighLowPriceView=new je(n),n._candleLastPriceLineView=new Ge(n),n.addChild(n._candleBarView),n}return F(i,e),i.prototype.updateMainContent=function(e){this.getPane().getChart().getStyles().candle.type!==t.CandleType.Area?(this._candleBarView.draw(e),this._candleHighLowPriceView.draw(e)):this._candleAreaView.draw(e),this._candleLastPriceLineView.draw(e)},i.prototype.createTooltipView=function(){return new Ze(this)},i}(He),qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.drawImp=function(t){var e,i=this,n=this.getWidget(),o=n.getPane(),r=n.getBounding(),a=o.getAxisComponent(),s=this.getAxisStyles(o.getChart().getStyles());if(s.show){s.axisLine.show&&(null===(e=this.createFigure("line",this.createAxisLine(r,s),s.axisLine))||void 0===e||e.draw(t));var l=a.getTicks();if(s.tickLine.show)this.createTickLines(l,r,s).forEach((function(e){var n;null===(n=i.createFigure("line",e,s.tickLine))||void 0===n||n.draw(t)}));if(s.tickText.show)this.createTickTexts(l,r,s).forEach((function(e){var n;null===(n=i.createFigure("text",e,s.tickText))||void 0===n||n.draw(t)}))}},e}(Le),$e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getAxisStyles=function(t){return t.yAxis},e.prototype.createAxisLine=function(t,e){var i,n=this.getWidget().getPane().getAxisComponent(),o=e.axisLine.size;return{coordinates:[{x:i=n.isFromZero()?o/2:t.width-o,y:0},{x:i,y:t.height}]}},e.prototype.createTickLines=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),o=i.axisLine,r=i.tickLine,a=0,s=0;return n.isFromZero()?(a=0,o.show&&(a+=o.size),s=a+r.length):(a=e.width,o.show&&(a-=o.size),s=a-r.length),t.map((function(t){return{coordinates:[{x:a,y:t.coord},{x:s,y:t.coord}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=this.getWidget().getPane().getAxisComponent(),o=i.axisLine,r=i.tickLine,a=i.tickText,s=0;n.isFromZero()?(s=a.marginStart,o.show&&(s+=o.size),r.show&&(s+=r.length)):(s=e.width-a.marginEnd,o.show&&(s-=o.size),r.show&&(s-=r.length));var l=this.getWidget().getPane().getAxisComponent().isFromZero()?"left":"right";return t.map((function(t){return{x:s,y:t.coord,text:t.text,align:l,baseline:"middle"}}))},e}(qe),Je=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.drawImp=function(e){var i,n=this.getWidget(),o=n.getPane(),r=n.getBounding(),a=o.getChart().getChartStore(),s=a.getStyles().candle.priceMark,l=s.last,u=l.text;if(s.show&&l.show&&u.show){var c=a.getPrecision(),h=o.getAxisComponent(),d=a.getDataList(),p=a.getVisibleDataList(),g=d[d.length-1];if(f(g)){var v=g.close,m=g.open,y=h.convertToNicePixel(v),_=void 0;_=v>m?l.upColor:v<m?l.downColor:l.noChangeColor;var x=void 0;if(h.getType()===t.YAxisType.Percentage){var S=p[0].data.close;x="".concat(((v-S)/S*100).toFixed(2),"%")}else x=T(v,c.price);x=I(x,a.getThousandsSeparator());var C=void 0,b=void 0;h.isFromZero()?(C=0,b="left"):(C=r.width,b="right"),null===(i=this.createFigure("text",{x:C,y:y,text:x,align:b,baseline:"middle"},R(R({},u),{backgroundColor:_})))||void 0===i||i.draw(e)}}},i}(Le),Qe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.drawImp=function(t){var e=this,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=n.getChart().getChartStore(),a=r.getCustomApi(),s=r.getStyles().indicator,l=s.lastValueMark,u=l.text;if(l.show){var c=n.getAxisComponent(),h=r.getDataList(),d=h.length-1,p=r.getIndicatorStore().getInstances(n.getId()),g=r.getThousandsSeparator();p.forEach((function(i){var n=i.result[d];if(f(n)&&i.visible){var r=i.precision;W(h,i,d,s,(function(s,l){var h,d=n[s.key];if(f(d)){var p=c.convertToNicePixel(d),v=T(d,r);i.shouldFormatBigNumber&&(v=a.formatBigNumber(v)),v=I(v,g);var m=void 0,y=void 0;c.isFromZero()?(m=0,y="left"):(m=o.width,y="right"),null===(h=e.createFigure("text",{x:m,y:p,text:v,align:y,baseline:"middle"},R(R({},u),{backgroundColor:l.color})))||void 0===h||h.draw(t)}}))}}))}},e}(Le),ti=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!1},e.prototype.drawDefaultFigures=function(t,e,i,n,o,r,a,s,l,u,c,h,d){this.drawFigures(t,e,this.getDefaultFigures(e,i,n,o,r,a,s,u,c,d),l)},e.prototype.getDefaultFigures=function(t,e,i,n,o,r,a,s,l,u){var c,h,d=[];if(t.needDefaultYAxisFigure&&t.id===(null===(c=u.instance)||void 0===c?void 0:c.id)&&u.paneId===this.getWidget().getPane().getId()){var p,g,f=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER;null!==(h=null==l?void 0:l.isFromZero())&&void 0!==h&&h?(p="left",g=0):(p="right",g=i.width),e.forEach((function(e,i){var o=t.points[i];if(v(o.value)){f=Math.min(f,e.y),m=Math.max(m,e.y);var r=I(T(o.value,n.price),a);d.push({type:"text",attrs:{x:g,y:e.y,text:r,align:p,baseline:"middle"},ignoreEvent:!0})}})),e.length>1&&d.unshift({type:"rect",attrs:{x:0,y:f,width:i.width,height:m-f},ignoreEvent:!0})}return d},e.prototype.getFigures=function(t,e,i,n,o,r,a,s,l,u){var c,h;return null!==(h=null===(c=t.createYAxisFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,thousandsSeparator:r,dateTimeFormat:a,defaultStyles:s,xAxis:l,yAxis:u}))&&void 0!==h?h:[]},e}(Ye),ei=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.drawImp=function(t){var e,i=this.getWidget(),n=i.getPane(),o=i.getBounding(),r=i.getPane().getChart().getChartStore(),a=r.getTooltipStore().getCrosshair(),s=r.getStyles().crosshair;if(y(a.paneId)&&this.compare(a,n.getId())&&s.show){var l=this.getDirectionStyles(s),u=l.text;if(l.show&&u.show){var c=n.getAxisComponent(),h=this.getText(a,r,c);t.font=D(u.size,u.weight,u.family),null===(e=this.createFigure("text",this.getTextAttrs(h,t.measureText(h).width,a,o,c,u),u))||void 0===e||e.draw(t)}}},i.prototype.compare=function(t,e){return t.paneId===e},i.prototype.getDirectionStyles=function(t){return t.horizontal},i.prototype.getText=function(e,i,n){var o,r,a,s=n,l=n.convertFromPixel(e.y);if(s.getType()===t.YAxisType.Percentage){var u=null!==(r=null===(o=i.getVisibleDataList()[0])||void 0===o?void 0:o.data)&&void 0!==r?r:{};a="".concat(((l-u.close)/u.close*100).toFixed(2),"%")}else{var c=i.getIndicatorStore().getInstances(e.paneId),h=0,d=!1;s.isInCandle()?h=i.getPrecision().price:c.forEach((function(t){h=Math.max(t.precision,h),d||(d=t.shouldFormatBigNumber)})),a=T(l,h),d&&(a=i.getCustomApi().formatBigNumber(a))}return I(a,i.getThousandsSeparator())},i.prototype.getTextAttrs=function(t,e,i,n,o,r){var a,s;return o.isFromZero()?(a=0,s="left"):(a=n.width,s="right"),{x:a,y:i.y,text:t,align:s,baseline:"middle"}},i}(Le),ii=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._yAxisView=new $e(n),n._candleLastPriceLabelView=new Je(n),n._indicatorLastValueView=new Qe(n),n._overlayYAxisView=new ti(n),n._crosshairHorizontalLabelView=new ei(n),n.getContainer().style.cursor="ns-resize",n.addChild(n._overlayYAxisView),n}return F(e,t),e.prototype.getName=function(){return se},e.prototype.updateMain=function(t){this._yAxisView.draw(t),this.getPane().getAxisComponent().isInCandle()&&this._candleLastPriceLabelView.draw(t),this._indicatorLastValueView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayYAxisView.draw(t),this._crosshairHorizontalLabelView.draw(t)},e}(ge),ni=function(){function t(t){this._extremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._prevExtremum={min:0,max:0,range:0,realMin:0,realMax:0,realRange:0},this._ticks=[],this._autoCalcTickFlag=!0,this._parent=t}return t.prototype.getParent=function(){return this._parent},t.prototype.buildTicks=function(t){return this._autoCalcTickFlag&&(this._extremum=this.calcExtremum()),!(this._prevExtremum.min===this._extremum.min&&this._prevExtremum.max===this._extremum.max&&!t)&&(this._prevExtremum=this._extremum,this._ticks=this.optimalTicks(this._calcTicks()),!0)},t.prototype.getTicks=function(){return this._ticks},t.prototype.getScrollZoomEnabled=function(){var t;return null===(t=this.getParent().getOptions().axisOptions.scrollZoomEnabled)||void 0===t||t},t.prototype.setExtremum=function(t){this._autoCalcTickFlag=!1,this._extremum=t},t.prototype.getExtremum=function(){return this._extremum},t.prototype.setAutoCalcTickFlag=function(t){this._autoCalcTickFlag=t},t.prototype.getAutoCalcTickFlag=function(){return this._autoCalcTickFlag},t.prototype._calcTicks=function(){var t=this._extremum,e=t.realMin,i=t.realMax,n=t.realRange,o=[];if(n>=0){var r=N(this._calcTickInterval(n),2),a=r[0],s=r[1],l=Q(Math.ceil(e/a)*a,s),u=Q(Math.floor(i/a)*a,s),c=0,h=l;if(0!==a)for(;h<=u;){var d=h.toFixed(s);o[c]={text:d,coord:0,value:d},++c,h+=a}}return o},t.prototype._calcTickInterval=function(t){var e,i,n,o,r=(e=t/8,i=Math.floor(et(e)),n=it(i),e=((o=e/n)<1.5?1:o<2.5?2:o<3.5?3:o<4.5?4:o<5.5?5:o<6.5?6:8)*n,i>=-20?+e.toFixed(i<0?-i:0):e),a=function(t){var e=t.toString(),i=e.indexOf("e");if(i>0){var n=+e.slice(i+1);return n<0?-n:0}var o=e.indexOf(".");return o<0?0:e.length-1-o}(r);return[r,a]},t}(),oi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.calcExtremum=function(){var e,i,n,o,r,a=this.getParent(),s=a.getChart(),l=s.getChartStore(),u=Number.MAX_SAFE_INTEGER,c=Number.MIN_SAFE_INTEGER,h=[],d=!1,p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,m=Number.MAX_SAFE_INTEGER;l.getIndicatorStore().getInstances(a.getId()).forEach((function(t){var e,i,n;d||(d=null!==(e=t.shouldOhlc)&&void 0!==e&&e),m=Math.min(m,t.precision),null!==t.minValue&&(p=Math.min(p,t.minValue)),null!==t.maxValue&&(g=Math.max(g,t.maxValue)),h.push({figures:null!==(i=t.figures)&&void 0!==i?i:[],result:null!==(n=t.result)&&void 0!==n?n:[]})}));var y=4,_=this.isInCandle();if(_){var x=l.getPrecision().price;y=m!==Number.MAX_SAFE_INTEGER?Math.min(m,x):x}else m!==Number.MAX_SAFE_INTEGER&&(y=m);var S=l.getVisibleDataList(),C=s.getStyles().candle,b=C.type===t.CandleType.Area,w=C.area.value,T=_&&!b||!_&&d;S.forEach((function(t){var e=t.dataIndex,i=t.data;if(T&&(u=Math.min(u,i.low),c=Math.max(c,i.high)),_&&b){var n=i[w];u=Math.min(u,n),c=Math.max(c,n)}h.forEach((function(t){var i,n=t.figures,o=null!==(i=t.result[e])&&void 0!==i?i:{};n.forEach((function(t){var e=o[t.key];f(e)&&(u=Math.min(u,e),c=Math.max(c,e))}))}))})),u!==Number.MAX_SAFE_INTEGER&&c!==Number.MIN_SAFE_INTEGER?(u=Math.min(p,u),c=Math.max(g,c)):(u=0,c=10);var E,I=this.getType();switch(I){case t.YAxisType.Percentage:var P=null===(e=S[0])||void 0===e?void 0:e.data;v(null==P?void 0:P.close)&&(u=(u-P.close)/P.close*100,c=(c-P.close)/P.close*100),E=Math.pow(10,-2);break;case t.YAxisType.Log:u=et(u),c=et(c),E=.05*it(-y);break;default:E=it(-y)}if(u===c||Math.abs(u-c)<E){var D=p===u,M=g===c;u=D?u:M?u-8*E:u-4*E,c=M?c:D?c+8*E:c+4*E}var k=null!==(n=null===(i=this.getParent().getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,A=a.getOptions().gap,F=null!==(o=null==A?void 0:A.top)&&void 0!==o?o:.2;F>=1&&(F/=k);var L=null!==(r=null==A?void 0:A.bottom)&&void 0!==r?r:.1;L>=1&&(L/=k);var R,B,O,V=Math.abs(c-u);return u-=V*L,c+=V*F,V=Math.abs(c-u),I===t.YAxisType.Log?(R=it(u),B=it(c),O=Math.abs(B-R)):(R=u,B=c,O=V),{min:u,max:c,range:V,realMin:R,realMax:B,realRange:O}},i.prototype._innerConvertToPixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,o=this.getExtremum(),r=(t-o.min)/o.range;return this.isReverse()?Math.round(r*n):Math.round((1-r)*n)},i.prototype.isInCandle=function(){return this.getParent().getId()===$t},i.prototype.getType=function(){return this.isInCandle()?this.getParent().getChart().getStyles().yAxis.type:t.YAxisType.Normal},i.prototype.getPosition=function(){return this.getParent().getChart().getStyles().yAxis.position},i.prototype.isReverse=function(){return!!this.isInCandle()&&this.getParent().getChart().getStyles().yAxis.reverse},i.prototype.isFromZero=function(){var e=this.getParent().getChart().getStyles().yAxis,i=e.inside;return e.position===t.YAxisPosition.Left&&i||e.position===t.YAxisPosition.Right&&!i},i.prototype.optimalTicks=function(e){var i,n,o=this,r=this.getParent(),a=null!==(n=null===(i=r.getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,s=r.getChart().getChartStore(),l=s.getCustomApi(),u=[],c=this.getType(),h=s.getIndicatorStore().getInstances(r.getId()),d=s.getThousandsSeparator(),p=0,g=!1;this.isInCandle()?p=s.getPrecision().price:h.forEach((function(t){p=Math.max(p,t.precision),g||(g=t.shouldFormatBigNumber)}));var f,m=s.getStyles().xAxis.tickText.size;return e.forEach((function(e){var i,n=e.value,r=o._innerConvertToPixel(+n);switch(c){case t.YAxisType.Percentage:i="".concat(T(n,2),"%");break;case t.YAxisType.Log:r=o._innerConvertToPixel(et(+n)),i=T(n,p);break;default:i=T(n,p),g&&(i=l.formatBigNumber(n))}i=I(i,d);var s=v(f);r>m&&r<a-m&&(s&&Math.abs(f-r)>2*m||!s)&&(u.push({text:i,coord:r,value:n}),f=r)})),u},i.prototype.getAutoSize=function(){var e=this.getParent(),i=e.getChart(),n=i.getStyles(),o=n.yAxis,r=o.size;if("auto"!==r)return r;var a=i.getChartStore(),s=a.getCustomApi(),l=0;if(o.show&&(o.axisLine.show&&(l+=o.axisLine.size),o.tickLine.show&&(l+=o.tickLine.length),o.tickText.show)){var u=0;this.getTicks().forEach((function(t){u=Math.max(u,M(t.text,o.tickText.size,o.tickText.weight,o.tickText.family))})),l+=o.tickText.marginStart+o.tickText.marginEnd+u}var c=n.crosshair,h=0;if(c.show&&c.horizontal.show&&c.horizontal.text.show){var d=a.getIndicatorStore().getInstances(e.getId()),p=0,g=!1;d.forEach((function(t){p=Math.max(t.precision,p),g||(g=t.shouldFormatBigNumber)}));var v=2;if(this.getType()!==t.YAxisType.Percentage)if(this.isInCandle()){var f=a.getPrecision().price,m=n.indicator.lastValueMark;v=m.show&&m.text.show?Math.max(p,f):f}else v=p;var y=T(this.getExtremum().max,v);g&&(y=s.formatBigNumber(y)),h+=c.horizontal.text.paddingLeft+c.horizontal.text.paddingRight+2*c.horizontal.text.borderSize+M(y,c.horizontal.text.size,c.horizontal.text.weight,c.horizontal.text.family)}return Math.max(l,h)},i.prototype.convertFromPixel=function(e){var i,n,o,r=null!==(n=null===(i=this.getParent().getYAxisWidget())||void 0===i?void 0:i.getBounding().height)&&void 0!==n?n:0,a=this.getExtremum(),s=a.min,l=a.range,u=(this.isReverse()?e/r:1-e/r)*l+s;switch(this.getType()){case t.YAxisType.Percentage:var c=null===(o=this.getParent().getChart().getChartStore().getVisibleDataList()[0])||void 0===o?void 0:o.data;return v(null==c?void 0:c.close)?c.close*u/100+c.close:0;case t.YAxisType.Log:return it(u);default:return u}},i.prototype.convertToRealValue=function(e){var i=e;return this.getType()===t.YAxisType.Log&&(i=it(e)),i},i.prototype.convertToPixel=function(e){var i,n=e;switch(this.getType()){case t.YAxisType.Percentage:var o=null===(i=this.getParent().getChart().getChartStore().getVisibleDataList()[0])||void 0===i?void 0:i.data;v(null==o?void 0:o.close)&&(n=(e-o.close)/o.close*100);break;case t.YAxisType.Log:n=et(e);break;default:n=e}return this._innerConvertToPixel(n)},i.prototype.convertToNicePixel=function(t){var e,i,n=null!==(i=null===(e=this.getParent().getYAxisWidget())||void 0===e?void 0:e.getBounding().height)&&void 0!==i?i:0,o=this.convertToPixel(t);return Math.round(Math.max(.05*n,Math.min(o,.98*n)))},i}(ni),ri=function(){function t(t,e,i,n){this._bounding=ue(),this._chart=i,this._id=n,this._init(t,e)}return t.prototype._init=function(t,e){this._rootContainer=t,this._container=$("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"}),null!==e?t.insertBefore(this._container,e):t.appendChild(this._container)},t.prototype.getContainer=function(){return this._container},t.prototype.getId=function(){return this._id},t.prototype.getChart=function(){return this._chart},t.prototype.getBounding=function(){return this._bounding},t.prototype.update=function(t){this._bounding.height!==this._container.offsetHeight&&(this._container.style.height="".concat(this._bounding.height,"px")),this.updateImp(null!=t?t:3,this._container,this._bounding)},t.prototype.destroy=function(){this._rootContainer.removeChild(this._container)},t}(),ai=function(t){function e(e,i,n,o){var r=t.call(this,e,i,n,o)||this;r._yAxisWidget=null,r._axis=r.createAxisComponent(),r._options={minHeight:30,dragEnabled:!0,gap:{top:.2,bottom:.1},axisOptions:{scrollZoomEnabled:!0}};var a=r.getContainer();return r._mainWidget=r.createMainWidget(a),r._yAxisWidget=r.createYAxisWidget(a),r}return F(e,t),e.prototype.setOptions=function(t){var e,i,n,o,r;return c(this._options,t),this.getId()===Qt?(o=this.getMainWidget().getContainer(),r="ew-resize"):(o=null===(e=this.getYAxisWidget())||void 0===e?void 0:e.getContainer(),r="ns-resize"),null===(n=null===(i=t.axisOptions)||void 0===i?void 0:i.scrollZoomEnabled)||void 0===n||n?o.style.cursor=r:o.style.cursor="default",this},e.prototype.getOptions=function(){return this._options},e.prototype.getAxisComponent=function(){return this._axis},e.prototype.setBounding=function(t,e,i){var n,o;c(this.getBounding(),t);var r={};return f(t.height)&&(r.height=t.height),f(t.top)&&(r.top=t.top),this._mainWidget.setBounding(r),null===(n=this._yAxisWidget)||void 0===n||n.setBounding(r),f(e)&&this._mainWidget.setBounding(e),f(i)&&(null===(o=this._yAxisWidget)||void 0===o||o.setBounding(i)),this},e.prototype.getMainWidget=function(){return this._mainWidget},e.prototype.getYAxisWidget=function(){return this._yAxisWidget},e.prototype.updateImp=function(t){var e;this._mainWidget.update(t),null===(e=this._yAxisWidget)||void 0===e||e.update(t)},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,o=$("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),r=o.getContext("2d"),a=P(o);o.width=i*a,o.height=n*a,r.scale(a,a);var s=this._mainWidget.getBounding();if(r.drawImage(this._mainWidget.getImage(t),s.left,0,s.width,s.height),null!==this._yAxisWidget){var l=this._yAxisWidget.getBounding();r.drawImage(this._yAxisWidget.getImage(t),l.left,0,l.width,l.height)}return o},e.prototype.createYAxisWidget=function(t){return null},e}(ri),si=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.createAxisComponent=function(){return new oi(this)},e.prototype.createMainWidget=function(t){return new He(t,this)},e.prototype.createYAxisWidget=function(t){return new ii(t,this)},e}(ai),li=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.createMainWidget=function(t){return new Ue(t,this)},e}(si),ui=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getAxisStyles=function(t){return t.xAxis},e.prototype.createAxisLine=function(t,e){var i=e.axisLine.size/2;return{coordinates:[{x:0,y:i},{x:t.width,y:i}]}},e.prototype.createTickLines=function(t,e,i){var n=i.tickLine,o=i.axisLine.size;return t.map((function(t){return{coordinates:[{x:t.coord,y:0},{x:t.coord,y:o+n.length}]}}))},e.prototype.createTickTexts=function(t,e,i){var n=i.tickText,o=i.axisLine.size,r=i.tickLine.length;return t.map((function(t){return{x:t.coord,y:o+r+n.marginStart,text:t.text,align:"center",baseline:"top"}}))},e}(qe),ci=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.coordinateToPointTimestampDataIndexFlag=function(){return!0},i.prototype.coordinateToPointValueFlag=function(){return!1},i.prototype.getCompleteOverlays=function(t){return t.getInstances()},i.prototype.getProgressOverlay=function(t){return t.instance},i.prototype.getDefaultFigures=function(e,i,n,o,r,a,s,l,u,c){var h,d=[];if(e.needDefaultXAxisFigure&&e.id===(null===(h=c.instance)||void 0===h?void 0:h.id)){var p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;i.forEach((function(i,n){p=Math.min(p,i.x),g=Math.max(g,i.x);var o=e.points[n];if(v(o.timestamp)){var s=a.formatDate(r,o.timestamp,"YYYY-MM-DD HH:mm",t.FormatDateType.Crosshair);d.push({type:"text",attrs:{x:i.x,y:0,text:s,align:"center"},ignoreEvent:!0})}})),i.length>1&&d.unshift({type:"rect",attrs:{x:p,y:0,width:g-p,height:n.height},ignoreEvent:!0})}return d},i.prototype.getFigures=function(t,e,i,n,o,r,a,s,l,u){var c,h;return null!==(h=null===(c=t.createXAxisFigures)||void 0===c?void 0:c.call(t,{overlay:t,coordinates:e,bounding:i,barSpace:n,precision:o,thousandsSeparator:r,dateTimeFormat:a,defaultStyles:s,xAxis:l,yAxis:u}))&&void 0!==h?h:[]},i}(ti),hi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.compare=function(t){return f(t.kLineData)&&t.dataIndex===t.realDataIndex},i.prototype.getDirectionStyles=function(t){return t.vertical},i.prototype.getText=function(e,i){var n,o=null===(n=e.kLineData)||void 0===n?void 0:n.timestamp;return i.getCustomApi().formatDate(i.getTimeScaleStore().getDateTimeFormat(),o,"YYYY-MM-DD HH:mm",t.FormatDateType.Crosshair)},i.prototype.getTextAttrs=function(t,e,i,n,o,r){var a,s=i.realX,l="center";return s-e/2-r.paddingLeft<0?(a=0,l="left"):s+e/2+r.paddingRight>n.width?(a=n.width,l="right"):a=s,{x:a,y:0,text:t,align:l,baseline:"top"}},i}(ei),di=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._xAxisView=new ui(n),n._overlayXAxisView=new ci(n),n._crosshairVerticalLabelView=new hi(n),n.getContainer().style.cursor="ew-resize",n.addChild(n._overlayXAxisView),n}return F(e,t),e.prototype.getName=function(){return ae},e.prototype.updateMain=function(t){this._xAxisView.draw(t)},e.prototype.updateOverlay=function(t){this._overlayXAxisView.draw(t),this._crosshairVerticalLabelView.draw(t)},e}(ge),pi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return F(i,e),i.prototype.calcExtremum=function(){var t=this.getParent().getChart().getChartStore().getTimeScaleStore().getVisibleRange(),e=t.from,i=t.to,n=i-1,o=i-e;return{min:e,max:n,range:o,realMin:e,realMax:n,realRange:o}},i.prototype.optimalTicks=function(e){var i,n,o=this.getParent().getChart(),r=o.getChartStore(),a=r.getCustomApi().formatDate,s=[],l=e.length,u=r.getDataList();if(l>0){var c=r.getTimeScaleStore().getDateTimeFormat(),h=o.getStyles().xAxis.tickText,d=M("00-00 00:00",h.size,h.weight,h.family),p=parseInt(e[0].value,10),g=this.convertToPixel(p),v=1;if(l>1){var m=parseInt(e[1].value,10),y=this.convertToPixel(m),_=Math.abs(y-g);_<d&&(v=Math.ceil(d/_))}for(var x=0;x<l;x+=v){var S=parseInt(e[x].value,10),C=u[S].timestamp,b=a(c,C,"HH:mm",t.FormatDateType.XAxis);if(0!==x){var w=u[parseInt(e[x-v].value,10)].timestamp;b=null!==(i=this._optimalTickLabel(a,c,C,w))&&void 0!==i?i:b}var T=this.convertToPixel(S);s.push({text:b,coord:T,value:C})}if(1===s.length)s[0].text=a(c,s[0].value,"YYYY-MM-DD HH:mm",t.FormatDateType.XAxis);else{var E=s[0].value,I=s[1].value;if(f(s[2])){var P=s[2].text;/^[0-9]{2}-[0-9]{2}$/.test(P)?s[0].text=a(c,E,"MM-DD",t.FormatDateType.XAxis):/^[0-9]{4}-[0-9]{2}$/.test(P)?s[0].text=a(c,E,"YYYY-MM",t.FormatDateType.XAxis):/^[0-9]{4}$/.test(P)&&(s[0].text=a(c,E,"YYYY",t.FormatDateType.XAxis))}else s[0].text=null!==(n=this._optimalTickLabel(a,c,E,I))&&void 0!==n?n:s[0].text}}return s},i.prototype._optimalTickLabel=function(e,i,n,o){var r=e(i,n,"YYYY",t.FormatDateType.XAxis),a=e(i,n,"YYYY-MM",t.FormatDateType.XAxis),s=e(i,n,"MM-DD",t.FormatDateType.XAxis);return r!==e(i,o,"YYYY",t.FormatDateType.XAxis)?r:a!==e(i,o,"YYYY-MM",t.FormatDateType.XAxis)?a:s!==e(i,o,"MM-DD",t.FormatDateType.XAxis)?s:null},i.prototype.getAutoSize=function(){var t=this.getParent().getChart().getStyles(),e=t.xAxis,i=e.size;if("auto"!==i)return i;var n=t.crosshair,o=0;e.show&&(e.axisLine.show&&(o+=e.axisLine.size),e.tickLine.show&&(o+=e.tickLine.length),e.tickText.show&&(o+=e.tickText.marginStart+e.tickText.marginEnd+e.tickText.size));var r=0;return n.show&&n.vertical.show&&n.vertical.text.show&&(r+=n.vertical.text.paddingTop+n.vertical.text.paddingBottom+2*n.vertical.text.borderSize+n.vertical.text.size),Math.max(o,r)},i.prototype.convertTimestampFromPixel=function(t){var e=this.getParent().getChart().getChartStore().getTimeScaleStore(),i=e.coordinateToDataIndex(t);return e.dataIndexToTimestamp(i)},i.prototype.convertTimestampToPixel=function(t){var e=this.getParent().getChart().getChartStore().getTimeScaleStore(),i=e.timestampToDataIndex(t);return e.dataIndexToCoordinate(i)},i.prototype.convertFromPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().coordinateToDataIndex(t)},i.prototype.convertToPixel=function(t){return this.getParent().getChart().getChartStore().getTimeScaleStore().dataIndexToCoordinate(t)},i}(ni),gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.createAxisComponent=function(){return new pi(this)},e.prototype.createMainWidget=function(t){return new di(t,this)},e}(ai),vi=function(e){function i(t,i){var n,o,r,a=e.call(this,t,i)||this;return a._dragFlag=!1,a._dragStartY=0,a._topPaneHeight=0,a._bottomPaneHeight=0,a._pressedMouseMoveEvent=(n=a._pressedTouchMouseMoveEvent,o=20,r=0,function(){var t=Date.now();t-r>(null!=o?o:20)&&(n.apply(this,arguments),r=t)}),a.registerEvent("touchStartEvent",a._mouseDownEvent.bind(a)).registerEvent("touchMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("touchEndEvent",a._mouseUpEvent.bind(a)).registerEvent("mouseDownEvent",a._mouseDownEvent.bind(a)).registerEvent("mouseUpEvent",a._mouseUpEvent.bind(a)).registerEvent("pressedMouseMoveEvent",a._pressedMouseMoveEvent.bind(a)).registerEvent("mouseEnterEvent",a._mouseEnterEvent.bind(a)).registerEvent("mouseLeaveEvent",a._mouseLeaveEvent.bind(a)),a}return F(i,e),i.prototype.getName=function(){return le},i.prototype.checkEventOn=function(){return!0},i.prototype._mouseDownEvent=function(t){this._dragFlag=!0,this._dragStartY=t.pageY;var e=this.getPane();return this._topPaneHeight=e.getTopPane().getBounding().height,this._bottomPaneHeight=e.getBottomPane().getBounding().height,!0},i.prototype._mouseUpEvent=function(){return this._dragFlag=!1,this._mouseLeaveEvent()},i.prototype._pressedTouchMouseMoveEvent=function(e){var i=e.pageY-this._dragStartY,n=this.getPane(),o=n.getTopPane(),r=n.getBottomPane(),a=i<0;if(null!==o&&null!==r&&r.getOptions().dragEnabled){var s=void 0,l=void 0,u=void 0,c=void 0;a?(s=o,l=r,u=this._topPaneHeight,c=this._bottomPaneHeight):(s=r,l=o,u=this._bottomPaneHeight,c=this._topPaneHeight);var h=s.getOptions().minHeight;if(u>h){var d=Math.max(u-Math.abs(i),h),p=u-d;s.setBounding({height:d}),l.setBounding({height:c+p});var g=n.getChart();g.getChartStore().getActionStore().execute(t.ActionType.OnPaneDrag,{paneId:n.getId}),g.adjustPaneViewport(!0,!0,!0,!0,!0)}}return!0},i.prototype._mouseEnterEvent=function(){var t,e=this.getPane(),i=e.getBottomPane();if(null!==(t=null==i?void 0:i.getOptions().dragEnabled)&&void 0!==t&&t){var n=e.getChart().getStyles().separator;return this.getContainer().style.background=n.activeBackgroundColor,!0}return!1},i.prototype._mouseLeaveEvent=function(){return!this._dragFlag&&(this.getContainer().style.background="",!0)},i.prototype.createContainer=function(){return $("div",{width:"100%",height:"".concat(7,"px"),margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box",cursor:"ns-resize"})},i.prototype.updateImp=function(t,e,i){if(4===i||2===i){var n=this.getPane().getChart().getStyles().separator;t.style.top="".concat(-Math.floor((7-n.size)/2),"px"),t.style.height="".concat(7,"px")}},i}(ce),fi=function(t){function e(e,i,n,o,r,a){var s=t.call(this,e,i,n,o)||this;return s.getContainer().style.overflow="",s._topPane=r,s._bottomPane=a,s._separatorWidget=new vi(s.getContainer(),s),s}return F(e,t),e.prototype.setBounding=function(t){return c(this.getBounding(),t),this},e.prototype.getTopPane=function(){return this._topPane},e.prototype.setTopPane=function(t){return this._topPane=t,this},e.prototype.getBottomPane=function(){return this._bottomPane},e.prototype.setBottomPane=function(t){return this._bottomPane=t,this},e.prototype.getWidget=function(){return this._separatorWidget},e.prototype.getImage=function(t){var e=this.getBounding(),i=e.width,n=e.height,o=this.getChart().getStyles().separator,r=$("canvas",{width:"".concat(i,"px"),height:"".concat(n,"px"),boxSizing:"border-box"}),a=r.getContext("2d"),s=P(r);return r.width=i*s,r.height=n*s,a.scale(s,s),a.fillStyle=o.color,a.fillRect(0,0,i,n),r},e.prototype.updateImp=function(t,e,i){if(4===t||2===t){var n=this.getChart().getStyles().separator;e.style.backgroundColor=n.color,e.style.height="".concat(i.height,"px"),e.style.marginLeft="".concat(i.left,"px"),e.style.width="".concat(i.width,"px"),this._separatorWidget.update(t)}},e}(ri);function mi(){var t;return"undefined"!=typeof window&&(null!==(t=window.navigator.userAgent.toLowerCase().indexOf("firefox"))&&void 0!==t?t:-1)>-1}function yi(){return"undefined"!=typeof window&&/iPhone|iPad|iPod/.test(window.navigator.platform)}var _i,xi=function(){function t(t,e,i){var n=this;this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartCoordinate=null,this._touchMoveStartCoordinate=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeMouseWheel=null,this._unsubscribeContextMenu=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!yi(),this._onFirefoxOutsideMouseUp=function(t){n._mouseUpHandler(t)},this._onMobileSafariDoubleClick=function(t){n._firesTouchEvents(t)?(++n._tapCount,null!==n._tapTimeoutId&&n._tapCount>1&&(n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._tapCoordinate).manhattanDistance<30&&!n._cancelTap&&n._processEvent(n._makeCompatEvent(t),n._handler.doubleTapEvent),n._resetTapTimeout())):(++n._clickCount,null!==n._clickTimeoutId&&n._clickCount>1&&(n._mouseTouchMoveWithDownInfo(n._getCoordinate(t),n._clickCoordinate).manhattanDistance<5&&!n._cancelClick&&n._processEvent(n._makeCompatEvent(t),n._handler.mouseDoubleClickEvent),n._resetClickTimeout()))},this._target=t,this._handler=e,this._options=i,this._init()}return t.prototype.destroy=function(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeMouseWheel&&(this._unsubscribeMouseWheel(),this._unsubscribeMouseWheel=null),null!==this._unsubscribeContextMenu&&(this._unsubscribeContextMenu(),this._unsubscribeContextMenu=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()},t.prototype._mouseEnterHandler=function(t){var e,i,n,o=this;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this);var r=this._mouseMoveHandler.bind(this);this._unsubscribeMousemove=function(){o._target.removeEventListener("mousemove",r)},this._target.addEventListener("mousemove",r);var a=this._mouseWheelHandler.bind(this);this._unsubscribeMouseWheel=function(){o._target.removeEventListener("wheel",a)},this._target.addEventListener("wheel",a,{passive:!1});var s=this._contextMenuHandler.bind(this);this._unsubscribeContextMenu=function(){o._target.removeEventListener("contextmenu",s)},this._target.addEventListener("contextmenu",s,{passive:!1}),this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseEnterEvent),this._acceptMouseLeave=!0)},t.prototype._resetClickTimeout=function(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._resetTapTimeout=function(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapCoordinate={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}},t.prototype._mouseMoveHandler=function(t){this._mousePressed||null!==this._touchMoveStartCoordinate||this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseMoveEvent),this._acceptMouseLeave=!0)},t.prototype._mouseWheelHandler=function(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(!f(this._handler.mouseWheelHortEvent))return;if(this._preventDefault(t),0===Math.abs(t.deltaX))return;this._handler.mouseWheelHortEvent(this._makeCompatEvent(t),-t.deltaX)}else{if(!f(this._handler.mouseWheelVertEvent))return;var e=-t.deltaY/100;if(0===e)return;switch(this._preventDefault(t),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120;break;case t.DOM_DELTA_LINE:e*=32}if(0!==e){var i=Math.sign(e)*Math.min(1,Math.abs(e));this._handler.mouseWheelVertEvent(this._makeCompatEvent(t),i)}}},t.prototype._contextMenuHandler=function(t){this._preventDefault(t)},t.prototype._touchMoveHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null!==e&&(this._lastTouchEventTimeStamp=this._eventTimeStamp(t),null===this._startPinchMiddleCoordinate&&!this._preventTouchDragProcess)){this._pinchPrevented=!0;var i=this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._touchMoveStartCoordinate),n=i.xOffset,o=i.yOffset,r=i.manhattanDistance;if(this._touchMoveExceededManhattanDistance||!(r<5)){if(!this._touchMoveExceededManhattanDistance){var a=.5*n,s=o>=a&&!this._options.treatVertDragAsPageScroll(),l=a>o&&!this._options.treatHorzDragAsPageScroll();s||l||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}this._preventTouchDragProcess||this._processEvent(this._makeCompatEvent(t,e),this._handler.touchMoveEvent)}}},t.prototype._mouseMoveWithDownHandler=function(t){0===t.button&&(this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._mouseMoveStartCoordinate).manhattanDistance>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick&&this._processEvent(this._makeCompatEvent(t),this._handler.pressedMouseMoveEvent))},t.prototype._mouseTouchMoveWithDownInfo=function(t,e){var i=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);return{xOffset:i,yOffset:n,manhattanDistance:i+n}},t.prototype._touchEndHandler=function(t){var e=this._touchWithId(t.changedTouches,this._activeTouchId);if(null===e&&0===t.touches.length&&(e=t.changedTouches[0]),null!==e){this._activeTouchId=null,this._lastTouchEventTimeStamp=this._eventTimeStamp(t),this._clearLongTapTimeout(),this._touchMoveStartCoordinate=null,null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var i=this._makeCompatEvent(t,e);if(this._processEvent(i,this._handler.touchEndEvent),++this._tapCount,null!==this._tapTimeoutId&&this._tapCount>1)this._mouseTouchMoveWithDownInfo(this._getCoordinate(e),this._tapCoordinate).manhattanDistance<30&&!this._cancelTap&&this._processEvent(i,this._handler.doubleTapEvent),this._resetTapTimeout();else this._cancelTap||(this._processEvent(i,this._handler.tapEvent),f(this._handler.tapEvent)&&this._preventDefault(t));0===this._tapCount&&this._preventDefault(t),0===t.touches.length&&this._longTapActive&&(this._longTapActive=!1,this._preventDefault(t))}},t.prototype._mouseUpHandler=function(t){if(0===t.button){var e=this._makeCompatEvent(t);if(this._mouseMoveStartCoordinate=null,this._mousePressed=!1,null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),mi())this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp);if(!this._firesTouchEvents(t))if(this._processEvent(e,this._handler.mouseUpEvent),++this._clickCount,null!==this._clickTimeoutId&&this._clickCount>1)this._mouseTouchMoveWithDownInfo(this._getCoordinate(t),this._clickCoordinate).manhattanDistance<5&&!this._cancelClick&&this._processEvent(e,this._handler.mouseDoubleClickEvent),this._resetClickTimeout();else this._cancelClick||this._processEvent(e,this._handler.mouseClickEvent)}},t.prototype._clearLongTapTimeout=function(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)},t.prototype._touchStartHandler=function(t){if(null===this._activeTouchId){var e=t.changedTouches[0];this._activeTouchId=e.identifier,this._lastTouchEventTimeStamp=this._eventTimeStamp(t);var i=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartCoordinate=this._getCoordinate(e),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);var n=this._touchMoveHandler.bind(this),o=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=function(){i.removeEventListener("touchmove",n),i.removeEventListener("touchend",o)},i.addEventListener("touchmove",n,{passive:!1}),i.addEventListener("touchend",o,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),500),this._processEvent(this._makeCompatEvent(t,e),this._handler.touchStartEvent),null===this._tapTimeoutId&&(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapCoordinate=this._getCoordinate(e))}},t.prototype._mouseDownHandler=function(t){if(2===t.button)return this._preventDefault(t),void this._processEvent(this._makeCompatEvent(t),this._handler.mouseRightClickEvent);if(0===t.button){var e=this._target.ownerDocument.documentElement;mi()&&e.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartCoordinate=this._getCoordinate(t),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);var i=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=function(){e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",n)},e.addEventListener("mousemove",i),e.addEventListener("mouseup",n),this._mousePressed=!0,this._firesTouchEvents(t)||(this._processEvent(this._makeCompatEvent(t),this._handler.mouseDownEvent),null===this._clickTimeoutId&&(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickCoordinate=this._getCoordinate(t)))}},t.prototype._init=function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var e=this._target.ownerDocument,i=function(e){null!=t._handler.mouseDownOutsideEvent&&(e.composed&&t._target.contains(e.composedPath()[0])||null!==e.target&&t._target.contains(e.target)||t._handler.mouseDownOutsideEvent({x:0,y:0,pageX:0,pageY:0}))};this._unsubscribeOutsideTouchEvents=function(){e.removeEventListener("touchstart",i)},this._unsubscribeOutsideMouseEvents=function(){e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",i,{passive:!0}),yi()&&(this._unsubscribeMobileSafariEvents=function(){t._target.removeEventListener("dblclick",t._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick)),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._touchStartHandler.bind(this),{passive:!0}),this._target.addEventListener("mousedown",(function(t){if(1===t.button)return t.preventDefault(),!1})),this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",(function(){}),{passive:!1})},t.prototype._initPinch=function(){var t=this;(f(this._handler.pinchStartEvent)||f(this._handler.pinchEvent)||f(this._handler.pinchEndEvent))&&(this._target.addEventListener("touchstart",(function(e){return t._checkPinchState(e.touches)}),{passive:!0}),this._target.addEventListener("touchmove",(function(e){if(2===e.touches.length&&null!==t._startPinchMiddleCoordinate&&f(t._handler.pinchEvent)){var i=t._getTouchDistance(e.touches[0],e.touches[1])/t._startPinchDistance;t._handler.pinchEvent(R(R({},t._startPinchMiddleCoordinate),{pageX:0,pageY:0}),i),t._preventDefault(e)}}),{passive:!1}),this._target.addEventListener("touchend",(function(e){t._checkPinchState(e.touches)})))},t.prototype._checkPinchState=function(t){1===t.length&&(this._pinchPrevented=!1),2!==t.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)},t.prototype._startPinch=function(t){var e,i=null!==(e=this._target.getBoundingClientRect())&&void 0!==e?e:{left:0,top:0};this._startPinchMiddleCoordinate={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this._startPinchDistance=this._getTouchDistance(t[0],t[1]),f(this._handler.pinchStartEvent)&&this._handler.pinchStartEvent({x:0,y:0,pageX:0,pageY:0}),this._clearLongTapTimeout()},t.prototype._stopPinch=function(){null!==this._startPinchMiddleCoordinate&&(this._startPinchMiddleCoordinate=null,f(this._handler.pinchEndEvent)&&this._handler.pinchEndEvent({x:0,y:0,pageX:0,pageY:0}))},t.prototype._mouseLeaveHandler=function(t){var e,i,n;null===(e=this._unsubscribeMousemove)||void 0===e||e.call(this),null===(i=this._unsubscribeMouseWheel)||void 0===i||i.call(this),null===(n=this._unsubscribeContextMenu)||void 0===n||n.call(this),this._firesTouchEvents(t)||this._acceptMouseLeave&&(this._processEvent(this._makeCompatEvent(t),this._handler.mouseLeaveEvent),this._acceptMouseLeave=!yi())},t.prototype._longTapHandler=function(t){var e=this._touchWithId(t.touches,this._activeTouchId);null!==e&&(this._processEvent(this._makeCompatEvent(t,e),this._handler.longTapEvent),this._cancelTap=!0,this._longTapActive=!0)},t.prototype._firesTouchEvents=function(t){var e;return f(null===(e=t.sourceCapabilities)||void 0===e?void 0:e.firesTouchEvents)?t.sourceCapabilities.firesTouchEvents:this._eventTimeStamp(t)<this._lastTouchEventTimeStamp+500},t.prototype._processEvent=function(t,e){null==e||e.call(this._handler,t)},t.prototype._makeCompatEvent=function(t,e){var i,n=this,o=null!=e?e:t,r=null!==(i=this._target.getBoundingClientRect())&&void 0!==i?i:{left:0,top:0};return{x:o.clientX-r.left,y:o.clientY-r.top,pageX:o.pageX,pageY:o.pageY,isTouch:!t.type.startsWith("mouse")&&"contextmenu"!==t.type&&"click"!==t.type,preventDefault:function(){"touchstart"!==t.type&&n._preventDefault(t)}}},t.prototype._getTouchDistance=function(t,e){var i=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(i*i+n*n)},t.prototype._preventDefault=function(t){t.cancelable&&t.preventDefault()},t.prototype._getCoordinate=function(t){return{x:t.pageX,y:t.pageY}},t.prototype._eventTimeStamp=function(t){var e;return null!==(e=t.timeStamp)&&void 0!==e?e:performance.now()},t.prototype._touchWithId=function(t,e){for(var i=0;i<t.length;++i)if(t[i].identifier===e)return t[i];return null},t}(),Si=function(){function t(t,e){var i=this;this._flingStartTime=(new Date).getTime(),this._flingScrollRequestId=null,this._startScrollCoordinate=null,this._touchCoordinate=null,this._touchCancelCrosshair=!1,this._touchZoomed=!1,this._pinchScale=1,this._mouseDownWidget=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,this._mouseMoveTriggerWidgetInfo={pane:null,widget:null},this._boundKeyBoardDownEvent=function(t){if(t.shiftKey)switch(t.code){case"Equal":i._chart.getChartStore().getTimeScaleStore().zoom(.5);break;case"Minus":i._chart.getChartStore().getTimeScaleStore().zoom(-.5);break;case"ArrowLeft":(e=i._chart.getChartStore().getTimeScaleStore()).startScroll(),e.scroll(-3*e.getBarSpace().bar);break;case"ArrowRight":var e;(e=i._chart.getChartStore().getTimeScaleStore()).startScroll(),e.scroll(3*e.getBarSpace().bar)}},this._container=t,this._chart=e,this._event=new xi(t,this,{treatVertDragAsPageScroll:function(){return!1},treatHorzDragAsPageScroll:function(){return!1}}),t.addEventListener("keydown",this._boundKeyBoardDownEvent)}return t.prototype.pinchStartEvent=function(){return this._touchZoomed=!0,this._pinchScale=1,!0},t.prototype.pinchEvent=function(t,e){var i=this._findWidgetByEvent(t),n=i.pane,o=i.widget;if((null==n?void 0:n.getId())!==Qt&&(null==o?void 0:o.getName())===re){var r=this._makeWidgetEvent(t,o),a=5*(e-this._pinchScale);return this._pinchScale=e,this._chart.getChartStore().getTimeScaleStore().zoom(a,{x:r.x,y:r.y}),!0}return!1},t.prototype.mouseWheelHortEvent=function(t,e){var i=this._chart.getChartStore().getTimeScaleStore();return i.startScroll(),i.scroll(e),!0},t.prototype.mouseWheelVertEvent=function(t,e){var i,n=this._findWidgetByEvent(t).widget,o=null!==(i=t.isTouch)&&void 0!==i&&i,r=this._makeWidgetEvent(t,n),a=null,s=null==n?void 0:n.getName();if(o)if(s===re||s===ae)a={x:r.x,y:r.y};else{var l=this._chart.getCandlePane().getBounding();a={x:l.width/2,y:l.height/2}}else s===re&&(a={x:r.x,y:r.y});return null!==a&&(this._chart.getChartStore().getTimeScaleStore().zoom(e,{x:r.x,y:r.y}),!0)},t.prototype.mouseDownEvent=function(t){var e,i,n=this._findWidgetByEvent(t),o=n.pane,r=n.widget;if(this._mouseDownWidget=r,null!==r){var a=this._makeWidgetEvent(t,r);switch(r.getName()){case le:return r.dispatchEvent("mouseDownEvent",a);case re:var s=null!==(e=o.getAxisComponent().getExtremum())&&void 0!==e?e:null;return this._prevYAxisExtremum=null===s?s:R({},s),this._startScrollCoordinate={x:a.x,y:a.y},this._chart.getChartStore().getTimeScaleStore().startScroll(),r.dispatchEvent("mouseDownEvent",a);case ae:return(l=r.dispatchEvent("mouseDownEvent",a))&&this._chart.updatePane(1),this._xAxisStartScaleCoordinate={x:a.x,y:a.y},this._xAxisStartScaleDistance=a.pageX,l;case se:var l;(l=r.dispatchEvent("mouseDownEvent",a))&&this._chart.updatePane(1);s=null!==(i=o.getAxisComponent().getExtremum())&&void 0!==i?i:null;return this._prevYAxisExtremum=null===s?s:R({},s),this._yAxisStartScaleDistance=a.pageY,l}}return!1},t.prototype.mouseMoveEvent=function(t){var e,i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget,s=this._makeWidgetEvent(t,a);if((null===(e=this._mouseMoveTriggerWidgetInfo.pane)||void 0===e?void 0:e.getId())===(null==r?void 0:r.getId())&&(null===(i=this._mouseMoveTriggerWidgetInfo.widget)||void 0===i?void 0:i.getName())===(null==a?void 0:a.getName())||(null==a||a.dispatchEvent("mouseEnterEvent",s),null===(n=this._mouseMoveTriggerWidgetInfo.widget)||void 0===n||n.dispatchEvent("mouseLeaveEvent",s),this._mouseMoveTriggerWidgetInfo={pane:r,widget:a}),null!==a)switch(a.getName()){case re:var l=a.dispatchEvent("mouseMoveEvent",s),u=this._chart.getChartStore(),c={x:s.x,y:s.y,paneId:null==r?void 0:r.getId()};return l&&null!==u.getTooltipStore().getActiveIcon()&&(c=void 0,null!==a&&(a.getContainer().style.cursor="pointer")),this._chart.getChartStore().getTooltipStore().setCrosshair(c),l;case le:case ae:case se:l=a.dispatchEvent("mouseMoveEvent",s);return this._chart.getChartStore().getTooltipStore().setCrosshair(),l}return!1},t.prototype.pressedMouseMoveEvent=function(t){var e,i,n,o,r;if(null!==this._mouseDownWidget&&this._mouseDownWidget.getName()===le)return this._mouseDownWidget.dispatchEvent("pressedMouseMoveEvent",t);var a=this._findWidgetByEvent(t),s=a.pane,l=a.widget;if(null!==l&&(null===(e=this._mouseDownWidget)||void 0===e?void 0:e.getPane().getId())===(null==s?void 0:s.getId())&&(null===(i=this._mouseDownWidget)||void 0===i?void 0:i.getName())===l.getName()){var u=this._makeWidgetEvent(t,l);switch(l.getName()){case re:var c=l.getBounding();if(!(C=l.dispatchEvent("pressedMouseMoveEvent",u))&&null!==this._startScrollCoordinate){var h=s.getAxisComponent();if(null!==this._prevYAxisExtremum&&!h.getAutoCalcTickFlag()&&h.getScrollZoomEnabled()){var d=this._prevYAxisExtremum,p=d.min,g=d.max,v=p+(T=(b=d.range)*(w=(null!==(n=null==h?void 0:h.isReverse())&&void 0!==n&&n?this._startScrollCoordinate.y-u.y:u.y-this._startScrollCoordinate.y)/c.height)),f=g+T,m=h.convertToRealValue(v),y=h.convertToRealValue(f);h.setExtremum({min:v,max:f,range:f-v,realMin:m,realMax:y,realRange:y-m})}var _=u.x-this._startScrollCoordinate.x;this._chart.getChartStore().getTimeScaleStore().scroll(_)}return this._chart.getChartStore().getTooltipStore().setCrosshair({x:u.x,y:u.y,paneId:null==s?void 0:s.getId()}),C;case ae:if(C=l.dispatchEvent("pressedMouseMoveEvent",u))this._chart.updatePane(1);else{var x=s.getAxisComponent();if(null===(o=null==x?void 0:x.getScrollZoomEnabled())||void 0===o||o){var S=10*((w=this._xAxisStartScaleDistance/u.pageX)-this._xAxisScale);this._xAxisScale=w,this._chart.getChartStore().getTimeScaleStore().zoom(S,null!==(r=this._xAxisStartScaleCoordinate)&&void 0!==r?r:void 0)}}return C;case se:var C;if(C=l.dispatchEvent("pressedMouseMoveEvent",u))this._chart.updatePane(1);else{h=s.getAxisComponent();if(null!==this._prevYAxisExtremum&&h.getScrollZoomEnabled()){var b,w,T,E=this._prevYAxisExtremum,I=(p=E.min,g=E.max,(b=E.range)*(w=u.pageY/this._yAxisStartScaleDistance));v=p-(T=(I-b)/2),f=g+T,m=h.convertToRealValue(v),y=h.convertToRealValue(f);h.setExtremum({min:v,max:f,range:I,realMin:m,realMax:y,realRange:y-m}),this._chart.adjustPaneViewport(!1,!0,!0,!0)}}return C}}return!1},t.prototype.mouseUpEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case re:case le:case ae:case se:i=e.dispatchEvent("mouseUpEvent",n)}i&&this._chart.updatePane(1)}return this._mouseDownWidget=null,this._startScrollCoordinate=null,this._prevYAxisExtremum=null,this._xAxisStartScaleCoordinate=null,this._xAxisStartScaleDistance=0,this._xAxisScale=1,this._yAxisStartScaleDistance=0,i},t.prototype.mouseClickEvent=function(t){var e=this._findWidgetByEvent(t).widget;if(null!==e){var i=this._makeWidgetEvent(t,e);return e.dispatchEvent("mouseClickEvent",i)}return!1},t.prototype.mouseRightClickEvent=function(t){var e=this._findWidgetByEvent(t).widget,i=!1;if(null!==e){var n=this._makeWidgetEvent(t,e);switch(e.getName()){case re:case ae:case se:i=e.dispatchEvent("mouseRightClickEvent",n)}i&&this._chart.updatePane(1)}return!1},t.prototype.mouseDoubleClickEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n)switch(n.getName()){case re:var o=this._makeWidgetEvent(t,n);return n.dispatchEvent("mouseDoubleClickEvent",o);case se:var r=i.getAxisComponent();if(!r.getAutoCalcTickFlag())return r.setAutoCalcTickFlag(!0),this._chart.adjustPaneViewport(!1,!0,!0,!0),!0}return!1},t.prototype.mouseLeaveEvent=function(){return this._chart.getChartStore().getTooltipStore().setCrosshair(),!0},t.prototype.touchStartEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n){var o=this._makeWidgetEvent(t,n);switch(n.getName()){case re:var r=this._chart.getChartStore(),a=r.getTooltipStore();if(n.dispatchEvent("mouseDownEvent",o))return this._touchCancelCrosshair=!0,this._touchCoordinate=null,a.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(null!==this._flingScrollRequestId&&(de(this._flingScrollRequestId),this._flingScrollRequestId=null),this._flingStartTime=(new Date).getTime(),this._startScrollCoordinate={x:o.x,y:o.y},r.getTimeScaleStore().startScroll(),this._touchZoomed=!1,null!==this._touchCoordinate){var s=o.x-this._touchCoordinate.x,l=o.y-this._touchCoordinate.y;Math.sqrt(s*s+l*l)<10?(this._touchCoordinate={x:o.x,y:o.y},a.setCrosshair({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()})):(this._touchCoordinate=null,this._touchCancelCrosshair=!0,a.setCrosshair())}return!0;case ae:case se:var u=n.dispatchEvent("mouseDownEvent",o);return u&&this._chart.updatePane(1),u}}return!1},t.prototype.touchMoveEvent=function(t){var e,i,n,o=this._findWidgetByEvent(t),r=o.pane,a=o.widget;if(null!==a){var s=this._makeWidgetEvent(t,a),l=a.getName(),u=this._chart.getChartStore(),c=u.getTooltipStore();switch(l){case re:if(a.dispatchEvent("pressedMouseMoveEvent",s))return null===(e=s.preventDefault)||void 0===e||e.call(s),c.setCrosshair(void 0,!0),this._chart.updatePane(1),!0;if(null!==this._touchCoordinate)null===(i=s.preventDefault)||void 0===i||i.call(s),c.setCrosshair({x:s.x,y:s.y,paneId:null==r?void 0:r.getId()});else if(null!==this._startScrollCoordinate&&Math.abs(this._startScrollCoordinate.x-s.x)>this._startScrollCoordinate.y-s.y){var h=s.x-this._startScrollCoordinate.x;u.getTimeScaleStore().scroll(h)}return!0;case ae:case se:var d=a.dispatchEvent("pressedMouseMoveEvent",s);return d&&(null===(n=s.preventDefault)||void 0===n||n.call(s),this._chart.updatePane(1)),d}}return!1},t.prototype.touchEndEvent=function(t){var e=this,i=this._findWidgetByEvent(t).widget;if(null!==i){var n=this._makeWidgetEvent(t,i);switch(i.getName()){case re:if(i.dispatchEvent("mouseUpEvent",n),null!==this._startScrollCoordinate){var o=(new Date).getTime()-this._flingStartTime,r=(n.x-this._startScrollCoordinate.x)/(o>0?o:1)*20;if(o<200&&Math.abs(r)>0){var a=this._chart.getChartStore().getTimeScaleStore(),s=function(){e._flingScrollRequestId=he((function(){a.startScroll(),a.scroll(r),r*=.975,Math.abs(r)<1?null!==e._flingScrollRequestId&&(de(e._flingScrollRequestId),e._flingScrollRequestId=null):s()}))};s()}}return!0;case ae:case se:i.dispatchEvent("mouseUpEvent",n)&&this._chart.updatePane(1)}}return!1},t.prototype.tapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget,o=!1;if(null!==n){var r=this._makeWidgetEvent(t,n),a=n.dispatchEvent("mouseClickEvent",r);if(n.getName()===re){var s=this._makeWidgetEvent(t,n),l=this._chart.getChartStore().getTooltipStore();a?(this._touchCancelCrosshair=!0,this._touchCoordinate=null,l.setCrosshair(void 0,!0),o=!0):(this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:s.x,y:s.y},l.setCrosshair({x:s.x,y:s.y,paneId:null==i?void 0:i.getId()},!0),o=!0),this._touchCancelCrosshair=!1)}(o||a)&&this._chart.updatePane(1)}return o},t.prototype.doubleTapEvent=function(t){return this.mouseDoubleClickEvent(t)},t.prototype.longTapEvent=function(t){var e=this._findWidgetByEvent(t),i=e.pane,n=e.widget;if(null!==n&&n.getName()===re){var o=this._makeWidgetEvent(t,n);return this._touchCoordinate={x:o.x,y:o.y},this._chart.getChartStore().getTooltipStore().setCrosshair({x:o.x,y:o.y,paneId:null==i?void 0:i.getId()}),!0}return!1},t.prototype._findWidgetByEvent=function(t){var e,i,n,o,r=t.x,a=t.y,s=this._chart.getAllSeparatorPanes(),l=this._chart.getChartStore().getStyles().separator.size;try{for(var u=V(s),c=u.next();!c.done;c=u.next()){var h=N(c.value,2)[1],d=(m=h.getBounding()).top-Math.round((7-l)/2);if(r>=m.left&&r<=m.left+m.width&&a>=d&&a<=d+7)return{pane:h,widget:h.getWidget()}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(e)throw e.error}}var p=this._chart.getAllDrawPanes(),g=null;try{for(var v=V(p),f=v.next();!f.done;f=v.next()){var m,y=f.value;if(r>=(m=y.getBounding()).left&&r<=m.left+m.width&&a>=m.top&&a<=m.top+m.height){g=y;break}}}catch(t){n={error:t}}finally{try{f&&!f.done&&(o=v.return)&&o.call(v)}finally{if(n)throw n.error}}var _=null;if(null!==g){if(null===_){var x=g.getMainWidget(),S=x.getBounding();r>=S.left&&r<=S.left+S.width&&a>=S.top&&a<=S.top+S.height&&(_=x)}if(null===_){var C=g.getYAxisWidget();if(null!==C){var b=C.getBounding();r>=b.left&&r<=b.left+b.width&&a>=b.top&&a<=b.top+b.height&&(_=C)}}}return{pane:g,widget:_}},t.prototype._makeWidgetEvent=function(t,e){var i,n,o,r=null!==(i=null==e?void 0:e.getBounding())&&void 0!==i?i:null;return R(R({},t),{x:t.x-(null!==(n=null==r?void 0:r.left)&&void 0!==n?n:0),y:t.y-(null!==(o=null==r?void 0:r.top)&&void 0!==o?o:0)})},t.prototype.destroy=function(){this._container.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._event.destroy()},t}();t.DomPosition=void 0,(_i=t.DomPosition||(t.DomPosition={})).Root="root",_i.Main="main",_i.YAxis="yAxis";var Ci=function(){function e(t,e){this._drawPanes=[],this._separatorPanes=new Map,this._initContainer(t),this._chartEvent=new Si(this._chartContainer,this),this._chartStore=new oe(this,e),this._initPanes(e),this.adjustPaneViewport(!0,!0,!0)}return e.prototype._initContainer=function(t){this._container=t,this._chartContainer=$("div",{position:"relative",width:"100%",outline:"none",borderStyle:"none",cursor:"crosshair",boxSizing:"border-box",userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)},e.prototype._initPanes=function(t){var e,i=this,n=null!==(e=null==t?void 0:t.layout)&&void 0!==e?e:[{type:"candle"}],o=!1,r=!1,a=function(t){if(!r){var e=i._createPane(gi,Qt,null!=t?t:{});i._xAxisPane=e,r=!0}};n.forEach((function(t){var e,n,r;switch(t.type){case"candle":if(!o){var s=null!==(e=t.options)&&void 0!==e?e:{};c(s,{id:$t});var l=i._createPane(li,$t,s);i._candlePane=l,(u=null!==(n=t.content)&&void 0!==n?n:[]).forEach((function(t){i.createIndicator(t,!0,s)})),o=!0}break;case"indicator":var u,h;if((u=null!==(r=t.content)&&void 0!==r?r:[]).length>0)u.forEach((function(e){f(h)?i.createIndicator(e,!0,{id:h}):h=i.createIndicator(e,!0,t.options)}));break;case"xAxis":a(t.options)}})),a({position:"bottom"})},e.prototype._createPane=function(t,e,i){var n,o,r;switch(null==i?void 0:i.position){case"top":var a=this._drawPanes[0];f(a)&&(o=new t(this._chartContainer,a.getContainer(),this,e),n=0);break;case"bottom":break;default:for(var s=this._drawPanes.length-1;s>-1;s--){var l=this._drawPanes[s],u=this._drawPanes[s-1];"bottom"===(null==l?void 0:l.getOptions().position)&&"bottom"!==(null==u?void 0:u.getOptions().position)&&(o=new t(this._chartContainer,l.getContainer(),this,e),n=s)}}if(f(o)||(o=new t(this._chartContainer,null,this,e)),o.setOptions(null!=i?i:{}),f(n)?(this._drawPanes.splice(n,0,o),r=n):(this._drawPanes.push(o),r=this._drawPanes.length-1),o.getId()!==Qt){var c=this._drawPanes[r+1];if(f(c)&&c.getId()===Qt&&(c=this._drawPanes[r+2]),f(c))f(d=this._separatorPanes.get(c))?d.setTopPane(o):(d=new fi(this._chartContainer,c.getContainer(),this,"",o,c),this._separatorPanes.set(c,d));var h=this._drawPanes[r-1];if(f(h)&&h.getId()===Qt&&(h=this._drawPanes[r-2]),f(h)){var d=new fi(this._chartContainer,o.getContainer(),this,"",h,o);this._separatorPanes.set(o,d)}}return o},e.prototype._measurePaneHeight=function(){var t,e=this,i=this._container.offsetHeight,n=this._chartStore.getStyles().separator.size,o=this._xAxisPane.getAxisComponent().getAutoSize(),r=i-o-this._separatorPanes.size*n;r<0&&(r=0);var a=0;this._drawPanes.forEach((function(t){if(t.getId()!==$t&&t.getId()!==Qt){var e=t.getBounding().height,i=t.getOptions().minHeight;e<i&&(e=i),a+e>r?(a=r,e=Math.max(r-a,0)):a+=e,t.setBounding({height:e})}}));var s=r-a;null===(t=this._candlePane)||void 0===t||t.setBounding({height:s}),this._xAxisPane.setBounding({height:o});var l=0;this._drawPanes.forEach((function(t){var i=e._separatorPanes.get(t);f(i)&&(i.setBounding({height:n,top:l}),l+=n),t.setBounding({top:l}),l+=t.getBounding().height}))},e.prototype._measurePaneWidth=function(){var e=this,i=this._chartStore.getStyles(),n=i.yAxis,o=n.position===t.YAxisPosition.Left,r=!n.inside,a=this._container.offsetWidth,s=0,l=Number.MIN_SAFE_INTEGER,u=0,c=0;this._drawPanes.forEach((function(t){t.getId()!==Qt&&(l=Math.max(l,t.getAxisComponent().getAutoSize()))})),l>a&&(l=a),r?(s=a-l,o?(u=0,c=l):(u=a-l,c=0)):(s=a,c=0,u=o?0:a-l),this._chartStore.getTimeScaleStore().setTotalBarSpace(s);var h,d={width:a},p={width:s,left:c},g={width:l,left:u},v=i.separator.fill;h=r&&!v?p:d,this._drawPanes.forEach((function(t){var i;null===(i=e._separatorPanes.get(t))||void 0===i||i.setBounding(h),t.setBounding(d,p,g)}))},e.prototype._setPaneOptions=function(t,e){var i;if(y(t.id)){var n=this.getDrawPaneById(t.id),o=!1;if(null!==n){var r=e;if(t.id!==$t&&v(t.height)&&t.height>0){var a=Math.max(null!==(i=t.minHeight)&&void 0!==i?i:n.getOptions().minHeight,0),s=Math.max(a,t.height);n.setBounding({height:s}),r=!0,o=!0}n.setOptions(t),r&&this.adjustPaneViewport(o,!0,!0,!0,!0)}}},e.prototype.getDrawPaneById=function(t){if(t===$t)return this._candlePane;if(t===Qt)return this._xAxisPane;var e=this._drawPanes.find((function(e){return e.getId()===t}));return null!=e?e:null},e.prototype.getContainer=function(){return this._container},e.prototype.getChartStore=function(){return this._chartStore},e.prototype.getCandlePane=function(){return this._candlePane},e.prototype.getXAxisPane=function(){return this._xAxisPane},e.prototype.getAllDrawPanes=function(){return this._drawPanes},e.prototype.getAllSeparatorPanes=function(){return this._separatorPanes},e.prototype.adjustPaneViewport=function(t,e,i,n,o){t&&this._measurePaneHeight();var r=e,a=null!=o&&o;(null!=n&&n||a)&&this._drawPanes.forEach((function(t){var e=t.getAxisComponent().buildTicks(a);r||(r=e)})),r&&this._measurePaneWidth(),null!=i&&i&&(this._xAxisPane.getAxisComponent().buildTicks(!0),this.updatePane(4))},e.prototype.updatePane=function(t,e){if(f(e)){var i=this.getDrawPaneById(e);null==i||i.update(t)}else this._separatorPanes.forEach((function(e){e.update(t)})),this._drawPanes.forEach((function(e){e.update(t)}))},e.prototype.crosshairChange=function(e){var i=this,n=this._chartStore.getActionStore();if(n.has(t.ActionType.OnCrosshairChange)){var o={};this._drawPanes.forEach((function(t){var n=t.getId(),r={};i._chartStore.getIndicatorStore().getInstances(n).forEach((function(t){var i,n=t.result;r[t.name]=n[null!==(i=e.dataIndex)&&void 0!==i?i:n.length-1]})),o[n]=r})),y(e.paneId)&&n.execute(t.ActionType.OnCrosshairChange,R(R({},e),{indicatorData:o}))}},e.prototype.getDom=function(e,i){var n,o;if(!y(e))return this._chartContainer;var r=this.getDrawPaneById(e);if(null!==r)switch(null!=i?i:t.DomPosition.Root){case t.DomPosition.Root:return r.getContainer();case t.DomPosition.Main:return r.getMainWidget().getContainer();case t.DomPosition.YAxis:return null!==(o=null===(n=r.getYAxisWidget())||void 0===n?void 0:n.getContainer())&&void 0!==o?o:null}return null},e.prototype.getSize=function(e,i){var n,o;if(!f(e))return{width:this._chartContainer.offsetWidth,height:this._chartContainer.offsetHeight,left:0,top:0,right:0,bottom:0};var r=this.getDrawPaneById(e);if(null!==r)switch(null!=i?i:t.DomPosition.Root){case t.DomPosition.Root:return r.getBounding();case t.DomPosition.Main:return r.getMainWidget().getBounding();case t.DomPosition.YAxis:return null!==(o=null===(n=r.getYAxisWidget())||void 0===n?void 0:n.getBounding())&&void 0!==o?o:null}return null},e.prototype.setStyles=function(t){var e,i,n;this._chartStore.setOptions({styles:t}),f(null===(e=null==(n=y(t)?ne(t):t)?void 0:n.yAxis)||void 0===e?void 0:e.type)&&(null===(i=this._candlePane)||void 0===i||i.getAxisComponent().setAutoCalcTickFlag(!0)),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.getStyles=function(){return this._chartStore.getStyles()},e.prototype.setLocale=function(t){this._chartStore.setOptions({locale:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.getLocale=function(){return this._chartStore.getLocale()},e.prototype.setCustomApi=function(t){this._chartStore.setOptions({customApi:t}),this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.setPriceVolumePrecision=function(t,e){this._chartStore.setPrecision({price:t,volume:e})},e.prototype.getPriceVolumePrecision=function(){return this._chartStore.getPrecision()},e.prototype.setTimezone=function(t){this._chartStore.setOptions({timezone:t}),this._xAxisPane.getAxisComponent().buildTicks(!0),this._xAxisPane.update(3)},e.prototype.getTimezone=function(){return this._chartStore.getTimeScaleStore().getTimezone()},e.prototype.setOffsetRightDistance=function(t){this._chartStore.getTimeScaleStore().setOffsetRightDistance(t,!0)},e.prototype.getOffsetRightDistance=function(){return this._chartStore.getTimeScaleStore().getOffsetRightDistance()},e.prototype.setMaxOffsetLeftDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetLeftDistance(t)},e.prototype.setMaxOffsetRightDistance=function(t){t<0||this._chartStore.getTimeScaleStore().setMaxOffsetRightDistance(t)},e.prototype.setLeftMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))},e.prototype.setRightMinVisibleBarCount=function(t){t<0||this._chartStore.getTimeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))},e.prototype.setBarSpace=function(t){this._chartStore.getTimeScaleStore().setBarSpace(t)},e.prototype.getBarSpace=function(){return this._chartStore.getTimeScaleStore().getBarSpace().bar},e.prototype.getVisibleRange=function(){return this._chartStore.getTimeScaleStore().getVisibleRange()},e.prototype.clearData=function(){this._chartStore.clear()},e.prototype.getDataList=function(){return this._chartStore.getDataList()},e.prototype.applyNewData=function(t,e,i){this._chartStore.clear(),0===t.length?this.adjustPaneViewport(!1,!0,!0,!0):this.applyMoreData(t,e,i)},e.prototype.applyMoreData=function(t,e,i){var n=this;this._chartStore.addData(t,0,e),t.length>0&&this._chartStore.getIndicatorStore().calcInstance().then((function(t){n.adjustPaneViewport(!1,!0,!0,!0),null==i||i()})).catch((function(t){}))},e.prototype.updateData=function(t,e){var i=this,n=this._chartStore.getDataList(),o=n.length,r=t.timestamp,a=b(n[o-1],"timestamp",0);if(r>=a){var s=o;r===a&&(s=o-1),this._chartStore.addData(t,s),this._chartStore.getIndicatorStore().calcInstance().then((function(t){i.adjustPaneViewport(!1,!0,!0,!0),null==e||e()})).catch((function(t){}))}},e.prototype.loadMore=function(t){this._chartStore.getTimeScaleStore().setLoadMoreCallback(t)},e.prototype.createIndicator=function(t,e,i,n){var o,r=this,a=y(t)?{name:t}:t;if(null===Tt(a.name))return null;var s=null==i?void 0:i.id,l=this.getDrawPaneById(null!=s?s:"");if(null!==l)this._chartStore.getIndicatorStore().addInstance(a,null!=s?s:"",null!=e&&e).then((function(t){var e;r._setPaneOptions(null!=i?i:{},null!==(e=l.getAxisComponent().buildTicks(!0))&&void 0!==e&&e)})).catch((function(t){}));else{null!=s||(s=q(Jt));var u=this._createPane(si,s,null!=i?i:{}),c=null!==(o=null==i?void 0:i.height)&&void 0!==o?o:100;u.setBounding({height:c}),this._chartStore.getIndicatorStore().addInstance(a,s,null!=e&&e).finally((function(){r.adjustPaneViewport(!0,!0,!0,!0,!0),null==n||n()}))}return null!=s?s:null},e.prototype.overrideIndicator=function(t,e,i){var n=this;this._chartStore.getIndicatorStore().override(t,null!=e?e:null).then((function(t){var e=N(t,2),o=e[0],r=e[1];(o||r)&&(n.adjustPaneViewport(!1,r,!0,r),null==i||i())})).catch((function(){}))},e.prototype.getIndicatorByPaneId=function(t,e){return this._chartStore.getIndicatorStore().getInstanceByPaneId(t,e)},e.prototype.removeIndicator=function(t,e){var i,n,o,r=this._chartStore.getIndicatorStore();if(r.removeInstance(t,e)){var a=!1;if(t!==$t&&!r.hasInstances(t)){var s=this.getDrawPaneById(t),l=this._drawPanes.findIndex((function(e){return e.getId()===t}));if(null!==s){a=!0;var u=this._separatorPanes.get(s);if(f(u)){var c=null==u?void 0:u.getTopPane();try{for(var h=V(this._separatorPanes),d=h.next();!d.done;d=h.next()){var p=d.value;if(p[1].getTopPane().getId()===s.getId()){p[1].setTopPane(c);break}}}catch(t){i={error:t}}finally{try{d&&!d.done&&(n=h.return)&&n.call(h)}finally{if(i)throw i.error}}u.destroy(),this._separatorPanes.delete(s)}this._drawPanes.splice(l,1),s.destroy();var g=this._drawPanes[0];f(g)&&g.getId()===Qt&&(g=this._drawPanes[1]),null===(o=this._separatorPanes.get(g))||void 0===o||o.destroy(),this._separatorPanes.delete(g)}}this.adjustPaneViewport(a,!0,!0,!0,!0)}},e.prototype.createOverlay=function(t,e){var i=[];if(y(t))i=[{name:t}];else if(d(t))i=t.map((function(t){return y(t)?{name:t}:t}));else{i=[t]}var n=!0;f(e)&&null!==this.getDrawPaneById(e)||(e=$t,n=!1);var o=this._chartStore.getOverlayStore().addInstances(i,e,n);return d(t)?o:o[0]},e.prototype.getOverlayById=function(t){return this._chartStore.getOverlayStore().getInstanceById(t)},e.prototype.overrideOverlay=function(t){this._chartStore.getOverlayStore().override(t)},e.prototype.removeOverlay=function(t){var e;f(t)&&(e=y(t)?{id:t}:t),this._chartStore.getOverlayStore().removeInstance(e)},e.prototype.setPaneOptions=function(t){this._setPaneOptions(t,!1)},e.prototype.setZoomEnabled=function(t){this._chartStore.getTimeScaleStore().setZoomEnabled(t)},e.prototype.isZoomEnabled=function(){return this._chartStore.getTimeScaleStore().getZoomEnabled()},e.prototype.setScrollEnabled=function(t){this._chartStore.getTimeScaleStore().setScrollEnabled(t)},e.prototype.isScrollEnabled=function(){return this._chartStore.getTimeScaleStore().getScrollEnabled()},e.prototype.scrollByDistance=function(t,e){var i=v(e)&&e>0?e:0,n=this._chartStore.getTimeScaleStore();if(i>0){n.startScroll();var o=(new Date).getTime(),r=function(){var e=((new Date).getTime()-o)/i,a=e>=1,s=a?t:t*e;n.scroll(s),a||requestAnimationFrame(r)};r()}else n.startScroll(),n.scroll(t)},e.prototype.scrollToRealTime=function(t){var e=this._chartStore.getTimeScaleStore(),i=e.getBarSpace().bar,n=(e.getOffsetRightBarCount()-e.getInitialOffsetRightDistance()/i)*i;this.scrollByDistance(n,t)},e.prototype.scrollToDataIndex=function(t,e){var i=this._chartStore.getTimeScaleStore(),n=(i.getOffsetRightBarCount()+(this.getDataList().length-1-t))*i.getBarSpace().bar;this.scrollByDistance(n,e)},e.prototype.scrollToTimestamp=function(t,e){var i=J(this.getDataList(),"timestamp",t);this.scrollToDataIndex(i,e)},e.prototype.zoomAtCoordinate=function(t,e,i){var n=v(i)&&i>0?i:0,o=this._chartStore.getTimeScaleStore();if(n>0){var r=o.getBarSpace().bar,a=r*t-r,s=(new Date).getTime(),l=function(){var t=((new Date).getTime()-s)/n,i=t>=1,u=i?a:a*t;o.zoom(u/r,e),i||requestAnimationFrame(l)};l()}else o.zoom(t,e)},e.prototype.zoomAtDataIndex=function(t,e,i){var n=this._chartStore.getTimeScaleStore().dataIndexToCoordinate(e);this.zoomAtCoordinate(t,{x:n,y:0},i)},e.prototype.zoomAtTimestamp=function(t,e,i){var n=J(this.getDataList(),"timestamp",e);this.zoomAtDataIndex(t,n,i)},e.prototype.convertToPixel=function(t,e){var i,n=e.paneId,o=void 0===n?$t:n,r=e.absolute,a=void 0!==r&&r,s=[];if(o!==Qt){var l=this.getDrawPaneById(o);if(null!==l){var u=this._chartStore.getTimeScaleStore(),c=l.getBounding(),h=(new Array).concat(t),p=this._xAxisPane.getAxisComponent(),g=l.getAxisComponent();s=h.map((function(t){var e={},i=t.dataIndex;if(v(t.timestamp)&&(i=u.timestampToDataIndex(t.timestamp)),v(i)&&(e.x=null==p?void 0:p.convertToPixel(i)),v(t.value)){var n=null==g?void 0:g.convertToPixel(t.value);e.y=a?c.top+n:n}return e}))}}return d(t)?s:null!==(i=s[0])&&void 0!==i?i:{}},e.prototype.convertFromPixel=function(t,e){var i,n=e.paneId,o=void 0===n?$t:n,r=e.absolute,a=void 0!==r&&r,s=[];if(o!==Qt){var l=this.getDrawPaneById(o);if(null!==l){var u=this._chartStore.getTimeScaleStore(),c=l.getBounding(),h=(new Array).concat(t),p=this._xAxisPane.getAxisComponent(),g=l.getAxisComponent();s=h.map((function(t){var e,i,n={};if(v(t.x)){var o=null!==(e=null==p?void 0:p.convertFromPixel(t.x))&&void 0!==e?e:-1;n.dataIndex=o,n.timestamp=null!==(i=u.dataIndexToTimestamp(o))&&void 0!==i?i:void 0}if(v(t.y)){var r=a?t.y-c.top:t.y;n.value=g.convertFromPixel(r)}return n}))}}return d(t)?s:null!==(i=s[0])&&void 0!==i?i:{}},e.prototype.executeAction=function(e,i){var n;if(e===t.ActionType.OnCrosshairChange){var o=R({},i);o.paneId=null!==(n=o.paneId)&&void 0!==n?n:$t,this._chartStore.getTooltipStore().setCrosshair(o)}},e.prototype.subscribeAction=function(t,e){this._chartStore.getActionStore().subscribe(t,e)},e.prototype.unsubscribeAction=function(t,e){this._chartStore.getActionStore().unsubscribe(t,e)},e.prototype.getConvertPictureUrl=function(t,e,i){var n=this,o=this._chartContainer.offsetWidth,r=this._chartContainer.offsetHeight,a=$("canvas",{width:"".concat(o,"px"),height:"".concat(r,"px"),boxSizing:"border-box"}),s=a.getContext("2d"),l=P(a);a.width=o*l,a.height=r*l,s.scale(l,l),s.fillStyle=null!=i?i:"#FFFFFF",s.fillRect(0,0,o,r);var u=null!=t&&t;return this._drawPanes.forEach((function(t){var e=n._separatorPanes.get(t);if(f(e)){var i=e.getBounding();s.drawImage(e.getImage(u),i.left,i.top,i.width,i.height)}var r=t.getBounding();s.drawImage(t.getImage(u),0,r.top,o,r.height)})),a.toDataURL("image/".concat(null!=e?e:"jpeg"))},e.prototype.resize=function(){this.adjustPaneViewport(!0,!0,!0,!0,!0)},e.prototype.destroy=function(){this._chartEvent.destroy(),this._drawPanes.forEach((function(t){t.destroy()})),this._drawPanes=[],this._container.removeChild(this._chartContainer)},e}(),bi=new Map,wi=1;var Ti={clone:h,merge:c,isString:y,isNumber:v,isValid:f,isObject:g,isArray:d,isFunction:p,isBoolean:m,formatValue:b,formatPrecision:T,formatBigNumber:E,formatDate:w,formatThousands:I,calcTextWidth:M,getLinearSlopeIntercept:Ot,getLinearYFromSlopeIntercept:Rt,getLinearYFromCoordinates:Bt,checkCoordinateOnArc:Me,checkCoordinateOnCircle:ve,checkCoordinateOnLine:Lt,checkCoordinateOnPolygon:ye,checkCoordinateOnRect:Ce,checkCoordinateOnText:Ee,drawArc:ke,drawCircle:fe,drawLine:Vt,drawPolygon:_e,drawRect:be,drawText:Ie,drawRectText:De};t.dispose=function(t){var e,i,n;if(t instanceof Ci)n=t.id;else{var o=void 0;n=null!==(e=null==(o=y(t)?document.getElementById(t):t)?void 0:o.getAttribute("k-line-chart-id"))&&void 0!==e?e:null}null!==n&&(null===(i=bi.get(n))||void 0===i||i.destroy(),bi.delete(n))},t.getFigureClass=function(t){var e;return null!==(e=Fe[t])&&void 0!==e?e:null},t.getOverlayClass=function(t){var e;return null!==(e=Ut[t])&&void 0!==e?e:null},t.getSupportedFigures=function(){return Object.keys(Fe)},t.getSupportedIndicators=function(){return Object.keys(bt)},t.getSupportedLocales=function(){return Object.keys(Ke)},t.getSupportedOverlays=function(){return Object.keys(Ut)},t.init=function(t,e){var i;if(null===(i=y(t)?document.getElementById(t):t))return null;var n=bi.get(i.id);if(f(n))return n;var o="k_line_chart_".concat(wi++);return(n=new Ci(i,e)).id=o,i.setAttribute("k-line-chart-id",o),bi.set(o,n),n},t.registerFigure=function(t){Fe[t.name]=kt.extend(t)},t.registerIndicator=function(t){bt[t.name]=H.extend(t)},t.registerLocale=function(t,e){Ke[t]=R(R({},Ke[t]),e)},t.registerOverlay=function(t){Ut[t.name]=K.extend(t)},t.registerStyles=function(t,e){ie[t]=e},t.utils=Ti,t.version=function(){return"9.7.0"}}));
